!function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&m.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);m.length;)m.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var l=r[o];0!==n[l]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={0:0},i=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/static/";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([720,2]),r()}({110:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/redash_icon_small.png"},1680:function(e,t,r){var a={"./avatar.svg":460,"./db-logos/Cassandra.png":1681,"./db-logos/arangodb.png":1682,"./db-logos/athena.png":1683,"./db-logos/aws_es.png":1684,"./db-logos/axibasetsd.png":1685,"./db-logos/azure_kusto.png":1686,"./db-logos/bigquery.png":1687,"./db-logos/bigquery_gce.png":1688,"./db-logos/clickhouse.png":1689,"./db-logos/cloudwatch.png":1690,"./db-logos/cloudwatch_insights.png":1691,"./db-logos/cockroach.png":1692,"./db-logos/corporate_memory.png":1693,"./db-logos/couchbase.png":1694,"./db-logos/csv.png":1695,"./db-logos/databend.png":1696,"./db-logos/databricks.png":1697,"./db-logos/db2.png":1698,"./db-logos/dgraph.png":1699,"./db-logos/drill.png":1700,"./db-logos/druid.png":1701,"./db-logos/e6data.png":1702,"./db-logos/elasticsearch.png":1703,"./db-logos/elasticsearch2.png":1704,"./db-logos/elasticsearch2_OpenDistroSQLElasticSearch.png":1705,"./db-logos/elasticsearch2_XPackSQLElasticSearch.png":1706,"./db-logos/exasol.png":1707,"./db-logos/excel.png":1708,"./db-logos/firebolt.png":1709,"./db-logos/google_analytics.png":1710,"./db-logos/google_analytics4.png":1711,"./db-logos/google_search_console.png":1712,"./db-logos/google_spreadsheets.png":1713,"./db-logos/graphite.png":1714,"./db-logos/hive.png":1715,"./db-logos/hive_http.png":1716,"./db-logos/ignite.png":1717,"./db-logos/impala.png":1718,"./db-logos/influxdb.png":1719,"./db-logos/influxdbv2.png":1720,"./db-logos/jirajql.png":1721,"./db-logos/json.png":1722,"./db-logos/kibana.png":1723,"./db-logos/kylin.png":1724,"./db-logos/mapd.png":1725,"./db-logos/memsql.png":1726,"./db-logos/mongodb.png":1727,"./db-logos/mssql.png":1728,"./db-logos/mssql_odbc.png":1729,"./db-logos/mysql.png":1730,"./db-logos/nz.png":1731,"./db-logos/oracle.png":1732,"./db-logos/pg.png":1733,"./db-logos/phoenix.png":1734,"./db-logos/pinot.png":1735,"./db-logos/presto.png":1736,"./db-logos/prometheus.png":1737,"./db-logos/python.png":1738,"./db-logos/qubole.png":1739,"./db-logos/rds_mysql.png":1740,"./db-logos/redshift.png":1741,"./db-logos/redshift_iam.png":1742,"./db-logos/results.png":1743,"./db-logos/rockset.png":1744,"./db-logos/salesforce.png":1745,"./db-logos/scylla.png":1746,"./db-logos/snowflake.png":1747,"./db-logos/sparql_endpoint.png":1748,"./db-logos/sqlite.png":1749,"./db-logos/tinybird.png":1750,"./db-logos/treasuredata.png":1751,"./db-logos/trino.png":1752,"./db-logos/uptycs.png":1753,"./db-logos/url.png":1754,"./db-logos/vertica.png":1755,"./db-logos/yandex_appmetrika.png":1756,"./db-logos/yandex_disk.png":1757,"./db-logos/yandex_metrika.png":1758,"./destinations/asana.png":1759,"./destinations/chatwork.png":1760,"./destinations/datadog.png":1761,"./destinations/discord.png":1762,"./destinations/email.png":1763,"./destinations/hangouts_chat.png":1764,"./destinations/mattermost.png":1765,"./destinations/microsoft_teams_webhook.png":1766,"./destinations/pagerduty.png":1767,"./destinations/slack.png":1768,"./destinations/webex.png":1769,"./destinations/webhook.png":1770,"./favicon-16x16.png":1771,"./favicon-32x32.png":1772,"./favicon-96x96.png":1773,"./fixtures/map-tile.png":1774,"./google_logo.svg":1775,"./illustrations/alert.svg":1776,"./illustrations/dashboard.svg":1777,"./illustrations/no-query-results.svg":1778,"./illustrations/query.svg":1779,"./logo.png":1780,"./logo_white.png":1781,"./redash_icon_small.png":110};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id=1680},1681:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/Cassandra.png"},1682:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/arangodb.png"},1683:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/athena.png"},1684:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/aws_es.png"},1685:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/axibasetsd.png"},1686:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/azure_kusto.png"},1687:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/bigquery.png"},1688:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/bigquery_gce.png"},1689:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/clickhouse.png"},1690:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/cloudwatch.png"},1691:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/cloudwatch_insights.png"},1692:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/cockroach.png"},1693:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/corporate_memory.png"},1694:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/couchbase.png"},1695:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/csv.png"},1696:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/databend.png"},1697:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/databricks.png"},1698:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/db2.png"},1699:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/dgraph.png"},1700:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/drill.png"},1701:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/druid.png"},1702:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/e6data.png"},1703:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/elasticsearch.png"},1704:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/elasticsearch2.png"},1705:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/elasticsearch2_OpenDistroSQLElasticSearch.png"},1706:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/elasticsearch2_XPackSQLElasticSearch.png"},1707:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/exasol.png"},1708:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/excel.png"},1709:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/firebolt.png"},1710:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/google_analytics.png"},1711:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/google_analytics4.png"},1712:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/google_search_console.png"},1713:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/google_spreadsheets.png"},1714:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/graphite.png"},1715:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/hive.png"},1716:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/hive_http.png"},1717:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/ignite.png"},1718:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/impala.png"},1719:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/influxdb.png"},1720:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/influxdbv2.png"},1721:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/jirajql.png"},1722:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/json.png"},1723:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/kibana.png"},1724:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/kylin.png"},1725:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/mapd.png"},1726:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/memsql.png"},1727:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/mongodb.png"},1728:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/mssql.png"},1729:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/mssql_odbc.png"},1730:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/mysql.png"},1731:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/nz.png"},1732:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/oracle.png"},1733:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/pg.png"},1734:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/phoenix.png"},1735:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/pinot.png"},1736:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/presto.png"},1737:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/prometheus.png"},1738:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/python.png"},1739:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/qubole.png"},1740:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/rds_mysql.png"},1741:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/redshift.png"},1742:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/redshift_iam.png"},1743:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/results.png"},1744:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/rockset.png"},1745:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/salesforce.png"},1746:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/scylla.png"},1747:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/snowflake.png"},1748:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/sparql_endpoint.png"},1749:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/sqlite.png"},1750:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/tinybird.png"},1751:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/treasuredata.png"},1752:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/trino.png"},1753:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/uptycs.png"},1754:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/url.png"},1755:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/vertica.png"},1756:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/yandex_appmetrika.png"},1757:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/yandex_disk.png"},1758:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/db-logos/yandex_metrika.png"},1759:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/asana.png"},1760:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/chatwork.png"},1761:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/datadog.png"},1762:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/discord.png"},1763:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/email.png"},1764:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/hangouts_chat.png"},1765:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/mattermost.png"},1766:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/microsoft_teams_webhook.png"},1767:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/pagerduty.png"},1768:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/slack.png"},1769:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/webex.png"},1770:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/destinations/webhook.png"},1771:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/favicon-16x16.png"},1772:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/favicon-32x32.png"},1773:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/favicon-96x96.png"},1774:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/fixtures/map-tile.png"},1775:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/google_logo.svg"},1776:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/illustrations/alert.svg"},1777:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/illustrations/dashboard.svg"},1778:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/illustrations/no-query-results.svg"},1779:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/illustrations/query.svg"},1780:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/logo.png"},1781:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/logo_white.png"},1782:function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=1782},1783:function(e,t,r){"use strict";r.r(t)},1784:function(e,t,r){"use strict";r.r(t)},1787:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(32),s=r.n(i),o=(r(11),r(13),r(14),r(12)),l=r.n(o),c=r(2),u=r.n(c),d=(r(460),r(56)),m=r(52),p=r.n(m),f=(r(7),r(8)),h=r.n(f),b=["children"],g=["children"],y=["icon","alt","children"],v=["icon","alt"];function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function j(e){var t=e.children,r=E(e,g);return n.a.createElement(j.Component,r,t)}function w(e){return n.a.createElement(w.Component,e)}j.Component=function(e){var t=e.children,r=E(e,b);return n.a.createElement("a",r,t)},j.WithIcon=function(e){var t=e.icon,r=e.alt,a=e.children,i=E(e,y);return n.a.createElement(j.Component,i,a," ",t," ",n.a.createElement("span",{className:"sr-only"},r))},j.External=function(e){var t=e.icon,r=void 0===t?n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}):t,a=e.alt,i=void 0===a?"(opens in a new tab)":a,s=E(e,v);return n.a.createElement(j.WithIcon,O({target:"_blank",rel:"noopener noreferrer",icon:r,alt:i},s))},w.Component=function(e){return n.a.createElement(h.a,e)},j.Button=w;var S=j,P=r(141),C=r.n(P),N=r(157),k=r.n(N),_=(r(82),r(189),r(99)),A=r.n(_),x=r(719),q=Object(x.a)();function T(e){var t=e.pathname,r=e.search,a=e.hash,n={};return n.path=t,n.search=Object(c.mapValues)(A.a.parse(r),e=>!!Object(c.isNil)(e)||e),n.hash=Object(c.trimStart)(a,"#"),n.url="".concat(t).concat(r).concat(a),n}var I={listen:e=>Object(c.isFunction)(e)?q.listen((t,r)=>e(I,r)):()=>{},confirmChange:e=>Object(c.isFunction)(e)?q.block(t=>e(T(t),I)):()=>{},update(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(c.isObject)(e)&&(e=Object(c.omitBy)({pathname:e.path,search:e.search,hash:e.hash},c.isUndefined),e=Object(c.extend)({pathname:I.path,search:I.search,hash:I.hash},e),Object(c.isObject)(e.search)&&(e.search=Object(c.omitBy)(Object(c.extend)({},I.search,e.search),c.isNil),e.search=Object(c.mapValues)(e.search,e=>!0===e?null:e),e.search=A.a.stringify(e.search))),t?q.replace(e):q.push(e)},url:void 0,path:void 0,setPath(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];I.update({path:e},t)},search:void 0,setSearch(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];I.update({search:e},t)},hash:void 0,setHash(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];I.update({hash:e},t)}};function D(){Object(c.extend)(I,T(q.location))}q.listen(D),D();var R=I,M=r(435),z=r.n(M),F=r(439),L=r.n(F),U=r(23),V=r.n(U);function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,t){var r=null;V.a.warning({content:"Your session has expired. Please login to continue.",okText:n.a.createElement(n.a.Fragment,null,"Login ",n.a.createElement("i",{className:"fa fa-external-link m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")),centered:!0,mask:!0,maskClosable:!1,keyboard:!1,onOk:a=>{if(!r||r.closed){var n,i,s,o,l,u,d=Q(Q({},(n=640,i=640,s=window.screenX,o=window.screenY,l=window.innerWidth,u=window.innerHeight,{left:Math.floor((l-n)/2+s),top:Math.floor((u-i)/2+o),width:Math.floor(n),height:Math.floor(i)})),{},{menubar:"no",toolbar:"no",location:"yes",resizable:"yes",scrollbars:"yes",status:"yes"});r=window.open(e,"Restore Session",Object(c.map)(d,(e,t)=>"".concat(t,"=").concat(e)).join(","));var m=e=>{"redash_session_restored"===e.data.type&&(r&&r.close(),r=null,window.removeEventListener("message",m),a(),t())};window.addEventListener("message",m,!1)}else r.focus()}})}var G=null;var K=z.a.create({paramsSerializer:e=>A.a.stringify(e),xsrfCookieName:"csrf_token",xsrfHeaderName:"X-CSRF-TOKEN"});K.interceptors.response.use(e=>e.data);L()(K,e=>{var t=Object(c.get)(e,"response.data.message");return e.isAxiosError&&Object(c.includes)(t,"CSRF")?K.get("/ping"):Promise.reject(e)},{statusCodes:[400]}),L()(K,e=>{var t=parseInt(Object(c.get)(e,"response.status")),r=Object(c.get)(e,"response.data.message"),a=Object(c.get)(e,"config.url");return e.isAxiosError&&(401===t||Object(c.includes)(r,"Please login"))&&"api/session"!==a?(G||(G=new Promise(e=>{H(re.getLoginUrl(),()=>{G=null,e()})})),G):Promise.reject(e)},{statusCodes:[401,404],pauseInstanceWhileRefreshing:!1});K.interceptors.request.use(e=>{var t=re.getApiKey();return t&&(e.headers.Authorization="Key ".concat(t)),e});var Y={_isAdmin:void 0,canEdit(e){var t=e.user_id||e.user&&e.user.id;return this.isAdmin||t&&t===this.id},canCreate(){return this.hasPermission("create_query")||this.hasPermission("create_dashboard")||this.hasPermission("list_alerts")},hasPermission(e){return"admin"===e&&void 0!==this._isAdmin?this._isAdmin:Object(c.includes)(this.permissions,e)},get isAdmin(){return this.hasPermission("admin")},set isAdmin(e){this._isAdmin=e}},$={},J=[],X=k()("redash:auth"),Z={loaded:!1},ee={Login:"login"};function te(e){X("Updating session to be:",e),Object(c.extend)(Z,e,{loaded:!0}),Object(c.extend)(Y,Z.user),Object(c.extend)($,Z.client_config),Object(c.extend)(J,Z.messages)}var re={isAuthenticated:()=>Z.loaded&&Z.user.id,getLoginUrl:()=>ee.Login,setLoginUrl(e){ee.Login=e},login(){var e=encodeURI(R.url);X("Calling login with next = %s",e),window.location.href="".concat(ee.Login,"?next=").concat(e)},logout(){X("Logout."),window.location.href="logout"},loadSession:()=>(X("Loading session"),Z.loaded&&Z.user.id?(X("Resolving with local value."),Promise.resolve(Z)):(re.setApiKey(null),K.get("api/session").then(e=>(te(e),Z)))),loadConfig:()=>(X("Loading config"),K.get("/api/config").then(e=>(te({client_config:e.client_config,user:{permissions:[]},messages:[]}),e))),setApiKey(e){X("Set API key to: %s",e),re.apiKey=e},getApiKey:()=>re.apiKey,requireSession:()=>(X("Requested authentication"),re.isAuthenticated()?Promise.resolve(Z):re.loadSession().then(()=>{if(re.isAuthenticated())return X("Loaded session"),window.opener&&window.opener.postMessage({type:"redash_session_restored"},window.location.origin),Z;X("Need to login, redirecting"),re.login()}).catch(()=>{X("Need to login, redirecting"),re.login()}))};var ae=new class{refresh(){return Promise.resolve(this)}canCreateDataSource(){return Y.isAdmin}isCreateDataSourceEnabled(){return Y.isAdmin}canCreateDestination(){return Y.isAdmin}isCreateDestinationEnabled(){return Y.isAdmin}canCreateDashboard(){return Y.hasPermission("create_dashboard")}isCreateDashboardEnabled(){return Y.hasPermission("create_dashboard")}canCreateAlert(){return!0}canCreateUser(){return Y.isAdmin}isCreateUserEnabled(){return Y.isAdmin}isCreateQuerySnippetEnabled(){return!0}getDashboardRefreshIntervals(){var e=$.dashboardRefreshIntervals;return Object(c.isArray)(e)?e:null}getQueryRefreshIntervals(){var e=$.queryRefreshIntervals;return Object(c.isArray)(e)?e:null}canEdit(e){return Object(c.get)(e,"can_edit",!1)}canRun(){return!0}};var ne=new class{constructor(){this.objectCounters={}}refresh(){return K.get("api/organization/status").then(e=>(this.objectCounters=e.object_counters,this))}},ie=(r(406),r(408),r(1)),se=r.n(ie),oe=["name","children","fallback"];function le(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ce(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ue=new Map,de=new Set;function me(e,t){Object(c.isString)(e)&&""!==e&&(ue.set(e,Object(c.isFunction)(t)?t:null),de.forEach(t=>{t.props.name===e&&t.forceUpdate()}))}class pe extends n.a.Component{componentDidMount(){de.add(this)}componentWillUnmount(){de.delete(this)}render(){var e=this.props,t=e.name,r=e.children,a=e.fallback,i=le(e,oe),s=ue.get(t);return s?n.a.createElement(s,i,r):Object(c.isUndefined)(a)?r:a}}ce(pe,"propTypes",{name:se.a.string.isRequired,fallback:se.a.node,children:se.a.node}),ce(pe,"defaultProps",{children:null});var fe=r(15),he=r.n(fe),be=r(3),ge=r.n(be),ye=["className","type"];function ve(){return(ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Oe(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Ee=function(e){var t=e.className,r=e.type,a=Oe(e,ye);return n.a.createElement("button",ve({className:ge()("plain-button","clickable",{"plain-button-link":"link"===r},t),type:"button"},a))},je=r(87),we=r.n(je),Se=["title"];function Pe(){return(Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ce(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ne(e){var t=e.title,r=Ce(e,Se),a=Object(c.isNil)(t)?null:n.a.createElement("span",{role:"status","aria-live":"assertive","aria-relevant":"additions"},t);return n.a.createElement(we.a,Pe({trigger:["hover","focus"],title:a},r))}var ke=r(690),_e=r.n(ke),Ae=r(61),xe=r.n(Ae);function qe(e){var t,r;return(t=()=>Object(c.uniqueId)(e),null===(r=Object(a.useRef)(null)).current&&(r.current=t()),r).current}function Te(e){var t=e.message,r=e.icon,a=e.children,i=e.className,s=qe("bm-message");return n.a.createElement("div",{className:"big-message p-15 text-center "+i,role:"status","aria-live":"assertive","aria-relevant":"additions removals"},n.a.createElement("h3",{className:"m-t-0 m-b-0","aria-labelledby":s},n.a.createElement("i",{className:ge()("fa",r),"aria-hidden":"true"})),n.a.createElement("br",null),n.a.createElement("span",{id:s},t),a)}Te.propTypes={message:se.a.string,icon:se.a.string.isRequired,children:se.a.node,className:se.a.string},Te.defaultProps={message:"",children:null,className:"tiled bg-white"};var Ie=Te;function De(){return(De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Ue=Object(c.mapValues)({HOME:["","Help"],VALUE_SOURCE_OPTIONS:["/user-guide/querying/query-parameters#Value-Source-Options","Guide: Value Source Options"],SHARE_DASHBOARD:["/user-guide/dashboards/sharing-dashboards","Guide: Sharing and Embedding Dashboards"],AUTHENTICATION_OPTIONS:["/user-guide/users/authentication-options","Guide: Authentication Options"],USAGE_DATA_SHARING:["/open-source/admin-guide/usage-data","Help: Anonymous Usage Data Sharing"],DS_ATHENA:["/data-sources/amazon-athena-setup","Guide: Help Setting up Amazon Athena"],DS_BIGQUERY:["/data-sources/bigquery-setup","Guide: Help Setting up BigQuery"],DS_URL:["/data-sources/querying-urls","Guide: Help Setting up URL"],DS_MONGODB:["/data-sources/mongodb-setup","Guide: Help Setting up MongoDB"],DS_GOOGLE_SPREADSHEETS:["/data-sources/querying-a-google-spreadsheet","Guide: Help Setting up Google Spreadsheets"],DS_GOOGLE_ANALYTICS:["/data-sources/google-analytics-setup","Guide: Help Setting up Google Analytics"],DS_AXIBASETSD:["/data-sources/axibase-time-series-database","Guide: Help Setting up Axibase Time Series"],DS_RESULTS:["/user-guide/querying/query-results-data-source","Guide: Help Setting up Query Results"],ALERT_SETUP:["/user-guide/alerts/setting-up-an-alert","Guide: Setting Up a New Alert"],MAIL_CONFIG:["/open-source/setup/#Mail-Configuration","Guide: Mail Configuration"],ALERT_NOTIF_TEMPLATE_GUIDE:["/user-guide/alerts/custom-alert-notifications","Guide: Custom Alerts Notifications"],FAVORITES:["/user-guide/querying/favorites-tagging/#Favorites","Guide: Favorites"],MANAGE_PERMISSIONS:["/user-guide/querying/writing-queries#Managing-Query-Permissions","Guide: Managing Query Permissions"],NUMBER_FORMAT_SPECS:["/user-guide/visualizations/formatting-numbers","Formatting Numbers"],GETTING_STARTED:["/user-guide/getting-started","Guide: Getting Started"],DASHBOARDS:["/user-guide/dashboards","Guide: Dashboards"],QUERIES:["/user-guide/querying","Guide: Queries"],ALERTS:["/user-guide/alerts","Guide: Alerts"]},e=>{var t=Fe(e,2);return["https://redash.io/help"+t[0],t[1]]}),Ve={type:se.a.string,href:se.a.string,title:se.a.node,className:se.a.string,showTooltip:se.a.bool,renderAsLink:se.a.bool,children:se.a.node},Be={type:null,href:null,title:null,className:null,showTooltip:!0,renderAsLink:!1,children:n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"})};function Qe(e){return n.a.createElement(pe,De({},e,{name:"HelpTrigger"}))}me("HelpTrigger",function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t=class extends n.a.Component{constructor(){super(...arguments),ze(this,"iframeRef",n.a.createRef()),ze(this,"iframeLoadingTimeout",null),ze(this,"state",{visible:!1,loading:!1,error:!1,currentUrl:null}),ze(this,"loadIframe",e=>{clearTimeout(this.iframeLoadingTimeout),this.setState({loading:!0,error:!1}),this.iframeRef.current.src=e,this.iframeLoadingTimeout=setTimeout(()=>{this.setState({error:e,loading:!1})},2e4)}),ze(this,"onIframeLoaded",()=>{this.setState({loading:!1}),clearTimeout(this.iframeLoadingTimeout)}),ze(this,"onPostMessageReceived",e=>{if(Object(c.some)(r,t=>Object(c.startsWith)(e.origin,t))){var t=e.data||{},a=t.type,n=t.message;"iframe_url"===a&&this.setState({currentUrl:n})}}),ze(this,"getUrl",()=>{var t=Object(c.get)(e,this.props.type);return t?t[0]:this.props.href}),ze(this,"openDrawer",e=>{e.shiftKey||e.ctrlKey||e.metaKey||(e.preventDefault(),this.setState({visible:!0}),setTimeout(()=>this.loadIframe(this.getUrl()),300))}),ze(this,"closeDrawer",e=>{e&&e.preventDefault(),this.setState({visible:!1}),this.setState({visible:!1,currentUrl:null})})}componentDidMount(){window.addEventListener("message",this.onPostMessageReceived,!1)}componentWillUnmount(){window.removeEventListener("message",this.onPostMessageReceived),clearTimeout(this.iframeLoadingTimeout)}render(){var t=this.getUrl();if(!t)return null;var i=Object(c.get)(e,"".concat(this.props.type,"[1]"),this.props.title),s=ge()("help-trigger",this.props.className),o=this.state.currentUrl,l=Object(c.some)(r,e=>Object(c.startsWith)(o||t,e)),u=this.props.renderAsLink||!l;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ne,{title:this.props.showTooltip?n.a.createElement(n.a.Fragment,null,i,u&&n.a.createElement(n.a.Fragment,null," ",n.a.createElement("i",{className:"fa fa-external-link",style:{marginLeft:5},"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))):null},n.a.createElement(S,{href:o||this.getUrl(),className:s,rel:"noopener noreferrer",target:"_blank",onClick:u?()=>{}:this.openDrawer},this.props.children)),n.a.createElement(_e.a,{placement:"right",closable:!1,onClose:this.closeDrawer,visible:this.state.visible,className:ge()("help-drawer",a),destroyOnClose:!0,width:400},n.a.createElement("div",{className:"drawer-wrapper"},n.a.createElement("div",{className:"drawer-menu"},o&&n.a.createElement(Ne,{title:"Open page in a new window",placement:"left"},n.a.createElement(S,{href:o,target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))),n.a.createElement(Ne,{title:"Close",placement:"bottom"},n.a.createElement(Ee,{onClick:this.closeDrawer},n.a.createElement(xe.a,null)))),!this.state.error&&n.a.createElement("iframe",{ref:this.iframeRef,title:"Usage Help",src:"about:blank",className:ge()({ready:!this.state.loading}),onLoad:this.onIframeLoaded}),this.state.loading&&n.a.createElement(Ie,{icon:"fa-spinner fa-2x fa-pulse",message:"Loading...",className:"help-message"}),this.state.error&&n.a.createElement(Ie,{icon:"fa-exclamation-circle",className:"help-message"},"Something went wrong.",n.a.createElement("br",null),n.a.createElement(S,{href:this.state.error,target:"_blank",rel:"noopener"},"Click here")," ","to open the page in a new window.")),n.a.createElement(pe,{name:"HelpDrawerExtraContent",onLeave:this.closeDrawer,openPageUrl:this.loadIframe})))}},ze(t,"propTypes",Me(Me({},Ve),{},{type:se.a.oneOf(Object.keys(e))})),ze(t,"defaultProps",Be),t}(Ue,["https://redash.io"])),Qe.propTypes=Ve,Qe.defaultProps=Be;var We=r(22),He=r.n(We);r(62);function Ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(r),!0).forEach((function(t){Ye(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ye(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(){return($e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Je=se.a.shape({props:se.a.shape({visible:se.a.bool,onOk:se.a.func,onCancel:se.a.func,afterClose:se.a.func}).isRequired,close:se.a.func.isRequired,dismiss:se.a.func.isRequired});function Xe(e){return{Component:e,showModal:t=>function(e,t){var r={props:{visible:!0,okButtonProps:{},cancelButtonProps:{},onOk:()=>{},onCancel:()=>{},afterClose:()=>{}},close:()=>{},dismiss:()=>{}},a=null,i={onClose:()=>{},onDismiss:()=>{}},o=document.createElement("div");function l(){s.a.render(n.a.createElement(e,$e({},t,{dialog:r})),o)}function u(e,t){return r.props.okButtonProps={disabled:!0},r.props.cancelButtonProps={disabled:!0},t(),l(),Promise.resolve(e).then(()=>{r.props.visible=!1}).finally(()=>{r.props.okButtonProps={},r.props.cancelButtonProps={},l()})}function d(e){return a||(a=u(i.onClose(e),()=>{r.props.okButtonProps.loading=!0}).finally(()=>{a=null})),a}function m(e){return a||(a=u(i.onDismiss(e),()=>{r.props.cancelButtonProps.loading=!0}).finally(()=>{a=null})),a}document.body.appendChild(o),r.props.onOk=d,r.props.onCancel=m,r.props.afterClose=function(){setTimeout(()=>{s.a.unmountComponentAtNode(o),document.body.removeChild(o)},10)},r.close=d,r.dismiss=m;var p={close:d,dismiss:m,update:e=>{t=Ke(Ke({},t),e),l()},onClose:e=>(Object(c.isFunction)(e)&&(i.onClose=e),p),onDismiss:e=>(Object(c.isFunction)(e)&&(i.onDismiss=e),p)};return l(),p}(e,t)}}var Ze=document.createElement("a");Ze.style.display="none",document.body.appendChild(Ze);var et=["origin","protocol","host","hostname","port","pathname","search","hash","href"];var tt={parse:function(e){return Ze.setAttribute("href",e),Object(c.pick)(Ze,et)},stringify:function(e){return Object(c.extend)(Ze,Object(c.pick)(e,et)),Ze.href},normalize:function(e){return Ze.setAttribute("href",e),Ze.href}},rt=(r(92),r(691));function at(e){return n.a.createElement("h4",null,e.message)}function nt(){return(nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function it(e,t){switch(e){case 404:return"It seems like the page you're looking for cannot be found.";case 401:case 403:return"It seems like you don’t have permission to see this page.";default:return t}}function st(e){var t="It seems like we encountered an error. Try refreshing this page or contact your administrator.";if(Object(c.isObject)(e)){if(e.isAxiosError&&Object(c.isObject)(e.response))return it(e.response.status,Object(c.get)(e,"response.data.message",t));if(e.status)return it(e.status,t)}return t}function ot(e){var t=e.error,r=e.message;if(!t)return null;console.error(t);var a={error:t,message:r||st(t)};return n.a.createElement("div",{className:"error-message-container","data-test":"ErrorMessage",role:"alert"},n.a.createElement("div",{className:"error-state bg-white tiled"},n.a.createElement("div",{className:"error-state__icon"},n.a.createElement("i",{className:"zmdi zmdi-alert-circle-o","aria-hidden":"true"})),n.a.createElement("div",{className:"error-state__details"},n.a.createElement(pe,nt({name:"ErrorMessageDetails",fallback:n.a.createElement(at,a)},a)))))}function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){ut(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ut(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}at.propTypes={error:se.a.instanceOf(Error).isRequired,message:se.a.string.isRequired},ot.propTypes={error:se.a.object.isRequired,message:se.a.string};var pt=n.a.createContext(null);function ft(e){var t=Object(c.trimEnd)(tt.normalize(""),"/")+"/";return e=tt.normalize(e),!!Object(c.startsWith)(e,t)&&"/"+Object(c.trimStart)(e.substr(t.length),"/")}function ht(e){var t=e.routes,r=e.onRouteChange,i=dt(Object(a.useState)(null),2),s=i[0],o=i[1],l=Object(a.useRef)(null),u=Object(a.useRef)();return Object(a.useEffect)(()=>{var e=!1,r=new rt.a(t,{resolveRoute(e,t){var r=e.route;if(Object(c.isFunction)(r.render))return ct(ct({},r),{},{routeParams:t})}});function a(t){if(!e){u.current&&u.current.reset();var a=ft(R.path)||"/";if(a===l.current)return;if(l.current=a,"REPLACE"===t)return;r.resolve({pathname:a}).then(t=>{e||l.current!==a||o(ct(ct({},t),{},{key:Math.random().toString(32).substr(2)}))}).catch(t=>{e||l.current!==a||o({render:e=>n.a.createElement(ot,e.routeParams),routeParams:{error:t}})})}}a("PUSH");var i=R.listen((e,t)=>a(t));return()=>{e=!0,l.current=null,i()}},[t]),Object(a.useEffect)(()=>{r(s)},[s,r]),s?n.a.createElement(pt.Provider,{value:s},n.a.createElement(C.a,{ref:u,renderError:e=>n.a.createElement(ot,{error:e})},s.render(s))):null}function bt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout(()=>{!1===ft(e)?window.location=e:(e=tt.parse(e),R.update({path:e.pathname,search:e.search,hash:e.hash},t))},10)}ht.propTypes={routes:se.a.arrayOf(se.a.shape({path:se.a.string.isRequired,render:se.a.func,resolve:se.a.objectOf(se.a.any)})),onRouteChange:se.a.func},ht.defaultProps={routes:[],onRouteChange:()=>{}};var gt=[],yt=Object(c.debounce)(()=>{var e=gt;gt=[],K.post("api/events",e)},1e3);function vt(e,t,r,a){var n={action:e,object_type:t,object_id:r,timestamp:Date.now()/1e3,screen_resolution:"".concat(window.screen.width,"x").concat(window.screen.height)};Object(c.extend)(n,a),gt.push(n),yt()}r(1444);var Ot=6,Et=50,jt=15,wt=800,St=3,Pt=3,Ct=1,Nt=6,kt=1,_t=1e3;var At=class{constructor(e,t){this.title=e.title,this.name=e.name,this.type=e.type,this.global=e.global,this.parentQueryId=t,this.locals=[],this.urlPrefix="p_"}static getExecutionValue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(c.isObject)(e)&&Object(c.isFunction)(e.getExecutionValue)?e.getExecutionValue(t):null}static setValue(e,t){return Object(c.isObject)(e)&&Object(c.isFunction)(e.setValue)?e.setValue(t):null}get isEmpty(){return Object(c.isNull)(this.normalizedValue)}get hasPendingValue(){return void 0!==this.pendingValue&&!Object(c.isEqual)(this.pendingValue,this.normalizedValue)}get normalizedValue(){return this.$$value}isEmptyValue(e){return Object(c.isNull)(this.normalizeValue(e))}normalizeValue(e){return Object(c.isUndefined)(e)?null:e}updateLocals(){Object(c.isArray)(this.locals)&&Object(c.each)(this.locals,e=>{e.setValue(this.value)})}setValue(e){var t=this.normalizeValue(e);return this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){return this.value}setPendingValue(e){this.pendingValue=this.normalizeValue(e)}applyPendingValue(){this.hasPendingValue&&this.setValue(this.pendingValue)}clearPendingValue(){this.pendingValue=void 0}toUrlParams(){var e=this.urlPrefix;return{["".concat(e).concat(this.name)]:this.isEmpty?null:this.value}}fromUrlParams(e){var t=this.urlPrefix,r="".concat(t).concat(this.name);Object(c.has)(e,r)&&this.setValue(e[r])}toQueryTextFragment(){return"{{ ".concat(this.name," }}")}toSaveableObject(){return Object(c.omit)(this,["$$value","urlPrefix","pendingValue","parentQueryId"])}};var xt=class extends At{constructor(e,t){super(e,t),this.setValue(e.value)}normalizeValue(e){var t=Object(c.toString)(e);return Object(c.isEmpty)(t)?null:t}};var qt=class extends At{constructor(e,t){super(e,t),this.setValue(e.value)}normalizeValue(e){if(Object(c.isNull)(e))return null;var t=Object(c.toNumber)(e);return isNaN(t)?null:t}};r(139);var Tt=class extends At{constructor(e,t){super(e,t),this.enumOptions=e.enumOptions,this.multiValuesOptions=e.multiValuesOptions,this.setValue(e.value)}normalizeValue(e){if(Object(c.isEmpty)(this.enumOptions))return null;var t=this.enumOptions.split("\n")||[];return this.multiValuesOptions?(Object(c.isArray)(e)||(e=[e]),e=Object(c.intersection)(e,t)):e&&!Object(c.isArray)(e)&&Object(c.includes)(t,e)||(e=t[0]),Object(c.isArray)(e)&&Object(c.isEmpty)(e)?null:e}getExecutionValue(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).joinListValues&&Object(c.isArray)(this.value)){var e=Object(c.get)(this.multiValuesOptions,"separator",","),t=Object(c.get)(this.multiValuesOptions,"prefix",""),r=Object(c.get)(this.multiValuesOptions,"suffix",""),a=Object(c.map)(this.value,e=>"".concat(t).concat(e).concat(r));return Object(c.join)(a,e)}return this.value}toUrlParams(){var e=this.urlPrefix,t=this.value;return this.multiValuesOptions&&Object(c.isArray)(this.value)&&(t=JSON.stringify(this.value)),{["".concat(e).concat(this.name)]:this.isEmpty?null:t}}fromUrlParams(e){var t=this.urlPrefix,r="".concat(t).concat(this.name);if(Object(c.has)(e,r))if(this.multiValuesOptions)try{var a=JSON.parse(e[r]);this.setValue(Object(c.isArray)(a)?a:e[r])}catch(t){this.setValue(e[r])}else this.setValue(e[r])}},It=(r(642),r(250)),Dt=r.n(It),Rt=k()("redash:services:QueryResult"),Mt=["filter","multi-filter","multiFilter"];function zt(e){return function(e){var t;if(-1!==e.indexOf("::"))t="::";else{if(-1===e.indexOf("__"))return e;t="__"}var r=e.split(t);return""===r[0]&&2===r.length?r[1]:Object(c.includes)(Mt,r[1])?r[0]:e}(e).replace(/(?:^|\s)\S/g,e=>e.toUpperCase())}var Ft=e=>{var t=e.id;return K.get("api/query_results/".concat(t))},Lt=e=>K.post((e=>e.id?"api/query_results/".concat(e.id):"api/query_results")(e),e),Ut="waiting",Vt="processing",Bt="done",Qt="failed",Wt="loading-result",Ht={1:Ut,2:Vt,3:Bt,4:Qt};function Gt(e,t){switch(Object(c.get)(t,"response.status")){case 403:return void e.update(t.response.data);case 400:if("job"in t.response.data)return void e.update(t.response.data);break;case 404:return void e.update({job:{error:"cached query result unavailable, please execute again.",status:4}})}Rt("Unknown error",t),e.update({job:{error:Object(c.get)(t,"response.data.message","Unknown error occurred. Please try again later."),status:4}})}function Kt(e){return new Promise(t=>setTimeout(t,e))}function Yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return K.get("api/jobs/".concat(e)).then(e=>{var r=Ht[e.job.status];return r===Ut||r===Vt?Kt(t).then(()=>Yt(e.job.id)):r===Bt?e.job.result:r===Qt?Promise.reject(e.job.error):void 0})}class $t{constructor(e){var t;this.deferred=((t={onStatusChange:e=>{}}).promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t),this.job={},this.query_result={},this.status="waiting",this.updatedAt=l()(),this.isLoadingResult=!1,e&&this.update(e)}update(e){if(Object(c.extend)(this,e),"query_result"in e){this.status=Bt,this.deferred.onStatusChange(Bt);var t={};Object(c.each)(this.query_result.data.rows,e=>{Object(c.forOwn)(e,(r,a)=>{var n=null;Object(c.isNumber)(r)?n="float":!function(e){return Object(c.isString)(e)&&l()(e).isValid()&&/^\d{4}-\d{2}-\d{2}T/.test(e)}(r)?Object(c.isString)(r)&&r.match(/^\d{4}-\d{2}-\d{2}$/)?(e[a]=l.a.utc(r),n="date"):"object"==typeof r&&null!==r?e[a]=JSON.stringify(r):n="string":(e[a]=l.a.utc(r),n="datetime"),null!==n&&(void 0!==t[a]&&t[a]!==n?t[a]="string":t[a]=n)})}),Object(c.each)(this.query_result.data.columns,e=>{e.name=""+e.name,t[e.name]&&(null!=e.type&&"string"!==e.type||(e.type=t[e.name]))}),this.deferred.resolve(this)}else 3===this.job.status||2===this.job.status?(this.deferred.onStatusChange(Vt),this.status="processing"):4===this.job.status?(this.status=Ht[this.job.status],this.deferred.reject(new or(this.job.error))):(this.deferred.onStatusChange(void 0),this.status=void 0)}getId(){var e=null;return"query_result"in this&&(e=this.query_result.id),e}cancelExecution(){K.delete("api/jobs/".concat(this.job.id))}getStatus(){return this.isLoadingResult?Wt:this.status||Ht[this.job.status]}getError(){if("None"!==this.job.error)return this.job.error}getLog(){return this.query_result.data&&this.query_result.data.log&&0!==this.query_result.data.log.length?this.query_result.data.log:null}getUpdatedAt(){return this.query_result.retrieved_at||1e3*this.job.updated_at||this.updatedAt}getRuntime(){return this.query_result.runtime}getRawData(){return this.query_result.data?this.query_result.data.rows:null}getData(){return this.query_result.data?this.query_result.data.rows:null}isEmpty(){return null===this.getData()||0===this.getData().length}getColumns(){return void 0===this.columns&&this.query_result.data&&(this.columns=this.query_result.data.columns),this.columns}getColumnNames(){return void 0===this.columnNames&&this.query_result.data&&(this.columnNames=this.query_result.data.columns.map(e=>e.name)),this.columnNames}getColumnFriendlyNames(){return this.getColumnNames().map(e=>zt(e))}getTruncated(){return this.query_result.data?this.query_result.data.truncated:null}getFilters(){if(!this.getColumns())return[];var e=[];return this.getColumns().forEach(t=>{var r=t.name,a=r.split("::")[1]||r.split("__")[1];if(Object(c.includes)(Mt,a)){var n={name:r,friendlyName:zt(r),column:t,values:[],multiple:"multiFilter"===a||"multi-filter"===a};e.push(n)}},this),this.getRawData().forEach(t=>{e.forEach(e=>{e.values.push(t[e.name]),1===e.values.length&&(e.multiple?e.current=[t[e.name]]:e.current=t[e.name])})}),e.forEach(e=>{e.values=Object(c.uniqBy)(e.values,e=>l.a.isMoment(e)?e.unix():e),e.values.length>1&&e.multiple&&(e.current=e.values.slice())}),e}toPromise(e){return e&&(this.deferred.onStatusChange=e),this.deferred.promise}static getById(e,t){var r=new $t;return r.isLoadingResult=!0,r.deferred.onStatusChange(Wt),K.get("api/queries/".concat(e,"/results/").concat(t,".json")).then(e=>{r.isLoadingResult=!1,r.update(e)}).catch(e=>{r.isLoadingResult=!1,Gt(r,e)}),r}loadLatestCachedResult(e,t){K.post("api/queries/".concat(e,"/results"),{queryId:e,parameters:t}).then(e=>{this.update(e)}).catch(e=>{Gt(this,e)})}loadResult(e){this.isLoadingResult=!0,this.deferred.onStatusChange(Wt),Ft({id:this.job.query_result_id}).then(e=>{this.update(e),this.isLoadingResult=!1}).catch(t=>{void 0===e&&(e=0),e>3?(Rt("Connection error while trying to load result",t),this.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}}),this.isLoadingResult=!1):setTimeout(()=>{this.loadResult(e+1)},1e3*Math.pow(2,e))})}refreshStatus(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=()=>re.isAuthenticated()?this.loadResult():this.loadLatestCachedResult(e,t);(re.isAuthenticated()?K.get("api/jobs/".concat(this.job.id)):K.get("api/queries/".concat(e,"/jobs/").concat(this.job.id))).then(n=>{if(this.update(n),"processing"===this.getStatus()&&this.job.query_result_id&&"None"!==this.job.query_result_id)a();else if("failed"!==this.getStatus()){setTimeout(()=>{this.refreshStatus(e,t,r+1)},r>10?3e3:500)}}).catch(e=>{Rt("Connection error",e),this.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}})})}getLink(e,t,r){var a="api/queries/".concat(e,"/results/").concat(this.getId(),".").concat(t);return r&&(a="".concat(a,"?api_key=").concat(r)),a}getName(e,t){return"".concat(e.replace(/ /g,"_")+l()(this.getUpdatedAt()).format("_YYYY_MM_DD"),".").concat(t)}static getByQueryId(e,t,r,a){var n=new $t;return K.post("api/queries/".concat(e,"/results"),{id:e,parameters:t,apply_auto_limit:r,max_age:a}).then(r=>{n.update(r),"job"in r&&n.refreshStatus(e,t)}).catch(e=>{Gt(n,e)}),n}static get(e,t,r,a,n,i){var s=new $t,o={data_source_id:e,parameters:r,query:t,apply_auto_limit:a,max_age:n};return void 0!==i&&(o.query_id=i),Lt(o).then(e=>{s.update(e),"job"in e&&s.refreshStatus(t,r)}).catch(e=>{Gt(s,e)}),s}}var Jt=$t,Xt="localOptions:";var Zt={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=Xt+e;return r in window.localStorage?JSON.parse(window.localStorage.getItem(r)):t},set:function(e,t){var r=Xt+e;window.localStorage.setItem(r,JSON.stringify(t))}};function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){rr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ar(){return(ar=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}Dt.a.escape=c.identity;var nr=k()("redash:services:query");class ir{constructor(e){Object(c.extend)(this,e),Object(c.has)(this,"options")||(this.options={}),this.options.apply_auto_limit=!!this.options.apply_auto_limit,Object(c.isArray)(this.options.parameters)||(this.options.parameters=[])}isNew(){return void 0===this.id}hasDailySchedule(){return this.schedule&&null!==this.schedule.match(/\d\d:\d\d/)}scheduleInLocalTime(){var e=this.schedule.split(":");return l.a.utc().hour(e[0]).minute(e[1]).local().format("HH:mm")}hasResult(){return!(!this.latest_query_data&&!this.latest_query_data_id)}paramsRequired(){return this.getParameters().isRequired()}hasParameters(){return this.getParametersDefs().length>0}prepareQueryResultExecution(e,t){var r=this.getParameters(),a=r.getMissing();if(a.length>0){var n="parameter",i="value";return a.length>1&&(n="parameters",i="values"),new Jt({job:{error:"missing ".concat(i," for ").concat(a.join(", ")," ").concat(n,"."),status:4}})}return r.isRequired()&&(this.latest_query_data=null,this.latest_query_data_id=null),this.latest_query_data&&0!==t?this.queryResult||(this.queryResult=new Jt({query_result:this.latest_query_data})):this.latest_query_data_id&&0!==t?this.queryResult||(this.queryResult=Jt.getById(this.id,this.latest_query_data_id)):this.queryResult=e(),this.queryResult}getQueryResult(e){return this.prepareQueryResultExecution(()=>Jt.getByQueryId(this.id,this.getParameters().getExecutionValues(),this.getAutoLimit(),e),e)}getQueryResultByText(e,t){var r=t||this.query;if(!r)return new or("Can't execute empty query.");var a=this.getParameters().getExecutionValues({joinListValues:!0});return this.prepareQueryResultExecution(()=>Jt.get(this.data_source_id,r,a,this.getAutoLimit(),e,this.id),e)}getUrl(e,t){var r="queries/".concat(this.id);e&&(r+="/source");var a={};return this.getParameters().isRequired()&&this.getParametersDefs().forEach(e=>{Object(c.extend)(a,e.toUrlParams())}),Object.keys(a).forEach(e=>null==a[e]&&delete a[e]),""!==(a=Object(c.map)(a,(e,t)=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e))).join("&"))&&(r+="?".concat(a)),t&&(r+="#".concat(t)),r}getQueryResultPromise(){return this.getQueryResult().toPromise()}getParameters(){return this.$parameters||(this.$parameters=new sr(this,R.search)),this.$parameters}getAutoLimit(){return this.options.apply_auto_limit}getParametersDefs(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.getParameters().get(e)}favorite(){return ir.favorite(this)}unfavorite(){return ir.unfavorite(this)}clone(){var e=Object(c.clone)(this);return e.$parameters=null,e.getParameters(),e}}class sr{constructor(e,t){this.query=e,this.updateParameters(),this.initFromQueryString(t)}parseQuery(){var e=()=>Object(c.map)(this.query.options.parameters,e=>e.name),t=[];if(void 0!==this.query.query)try{var r=Dt.a.parse(this.query.query);t=Object(c.uniq)(function e(t){var r=[];return t.forEach(t=>{"name"===t[0]||"&"===t[0]?r.push(t[1].split(".")[0]):"#"===t[0]&&(r=Object(c.union)(r,e(t[4])))}),r}(r))}catch(r){nr("Failed parsing parameters: ",r),t=e()}else t=e();return t}updateParameters(e){if(this.query.query!==this.cachedQueryText){this.cachedQueryText=this.query.query;var t=e?this.parseQuery():Object(c.map)(this.query.options.parameters,e=>e.name);this.query.options.parameters=this.query.options.parameters||[];var r={};this.query.options.parameters.forEach(e=>{r[e.name]=e}),t.forEach(e=>{Object(c.has)(r,e)||this.query.options.parameters.push(qr({title:e,name:e,type:"text",value:null,global:!1}))});var a=this.query.options.parameters;this.query.options.parameters=a.filter(e=>Object(c.includes)(t,e.name)).map(e=>e instanceof At?e:qr(e,this.query.id))}else{var n=this.query.options.parameters;Object(c.find)(n,e=>!(e instanceof At))&&(this.query.options.parameters=Object(c.map)(n,e=>e instanceof At?e:qr(e,this.query.id)))}}initFromQueryString(e){this.get().forEach(t=>{t.fromUrlParams(e)})}get(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.updateParameters(e),this.query.options.parameters}add(e){this.query.options.parameters=this.query.options.parameters.filter(t=>t.name!==e.name);var t=qr(e);return this.query.options.parameters.push(t),t}getMissing(){return Object(c.map)(Object(c.filter)(this.get(),e=>e.isEmpty),e=>e.title)}isRequired(){return!Object(c.isEmpty)(this.get())}getExecutionValues(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.get();return Object(c.zipObject)(Object(c.map)(t,e=>e.name),Object(c.map)(t,t=>t.getExecutionValue(e)))}hasPendingValues(){return Object(c.some)(this.get(),e=>e.hasPendingValue)}applyPendingValues(){Object(c.each)(this.get(),e=>e.applyPendingValue())}toUrlParams(){if(0===this.get().length)return"";var e=ar(...this.get().map(e=>e.toUrlParams()));return Object.keys(e).forEach(t=>null==e[t]&&delete e[t]),Object.keys(e).map(t=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))).join("&")}}class or{constructor(e){this.errorMessage=e,this.updatedAt=l.a.utc()}getUpdatedAt(){return this.updatedAt}getError(){return this.errorMessage}toPromise(){return Promise.reject(this)}getStatus(){return"failed"}getData(){return null}getLog(){return null}}var lr=e=>new ir(e),cr=e=>tr(tr({},e),{},{results:Object(c.map)(e.results,lr)}),ur={query:e=>K.get("api/queries",{params:e}).then(cr),get:e=>K.get("api/queries/".concat(e.id),e).then(lr),save:e=>K.post((e=>e.id?"api/queries/".concat(e.id):"api/queries")(e),e).then(lr),delete:e=>K.delete("api/queries/".concat(e.id)),recent:e=>K.get("api/queries/recent",{params:e}).then(e=>Object(c.map)(e,lr)),archive:e=>K.get("api/queries/archive",{params:e}).then(cr),myQueries:e=>K.get("api/queries/my",{params:e}).then(cr),fork:e=>{var t=e.id;return K.post("api/queries/".concat(t,"/fork"),{id:t}).then(lr)},resultById:e=>K.get("api/queries/".concat(e.id,"/results.json")),asDropdown:e=>K.get("api/queries/".concat(e.id,"/dropdown")),associatedDropdown:e=>{var t=e.queryId,r=e.dropdownQueryId;return K.get("api/queries/".concat(t,"/dropdowns/").concat(r))},favorites:e=>K.get("api/queries/favorites",{params:e}).then(cr),favorite:e=>K.post("api/queries/".concat(e.id,"/favorite")),unfavorite:e=>K.delete("api/queries/".concat(e.id,"/favorite")),newQuery:function(){return new ir({query:"",name:"New Query",schedule:null,user:Y,options:{apply_auto_limit:Zt.get("applyAutoLimit",!0)},tags:[],can_edit:!0})}};Object(c.extend)(ir,ur);var dr=class extends At{constructor(e,t){super(e,t),this.queryId=e.queryId,this.multiValuesOptions=e.multiValuesOptions,this.setValue(e.value)}normalizeValue(e){return Object(c.isUndefined)(e)||Object(c.isNull)(e)||Object(c.isArray)(e)&&Object(c.isEmpty)(e)?null:e=this.multiValuesOptions?Object(c.isArray)(e)?e:[e]:Object(c.isArray)(e)?e[0]:e}getExecutionValue(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).joinListValues&&Object(c.isArray)(this.value)){var e=Object(c.get)(this.multiValuesOptions,"separator",","),t=Object(c.get)(this.multiValuesOptions,"prefix",""),r=Object(c.get)(this.multiValuesOptions,"suffix",""),a=Object(c.map)(this.value,e=>"".concat(t).concat(e).concat(r));return Object(c.join)(a,e)}return this.value}toUrlParams(){var e=this.urlPrefix,t=this.value;return this.multiValuesOptions&&Object(c.isArray)(this.value)&&(t=JSON.stringify(this.value)),{["".concat(e).concat(this.name)]:this.isEmpty?null:t}}fromUrlParams(e){var t=this.urlPrefix,r="".concat(t).concat(this.name);if(Object(c.has)(e,r))if(this.multiValuesOptions)try{var a=JSON.parse(e[r]);this.setValue(Object(c.isArray)(a)?a:e[r])}catch(t){this.setValue(e[r])}else this.setValue(e[r])}loadDropdownValues(){return this.parentQueryId?ir.associatedDropdown({queryId:this.parentQueryId,dropdownQueryId:this.queryId}).catch(()=>Promise.resolve([])):ir.asDropdown({id:this.queryId}).catch(Promise.resolve([]))}},mr={date:"YYYY-MM-DD","datetime-local":"YYYY-MM-DD HH:mm","datetime-with-seconds":"YYYY-MM-DD HH:mm:ss"},pr={now:{name:"Today/Now",value:()=>l()()},yesterday:{name:"Yesterday",value:()=>l()().subtract(1,"day")}},fr=se.a.oneOf(Object(c.values)(pr));function hr(e){return Object(c.startsWith)(e,"d_")&&Object(c.has)(pr,e.substring("d_".length))}function br(e){return Object(c.includes)(pr,e)}function gr(e){return hr(e)?pr[e.substring("d_".length)]:null}var yr=class extends At{constructor(e,t){super(e,t),this.useCurrentDateTime=e.useCurrentDateTime,this.setValue(e.value)}get hasDynamicValue(){return br(this.normalizedValue)}normalizeValue(e){if(hr(e))return gr(e);if(br(e))return e;var t=l()(e);return t.isValid()?t:null}setValue(e){var t=this.normalizeValue(e);return br(t)?this.value="d_"+Object(c.findKey)(pr,t):l.a.isMoment(t)?this.value=t.format(mr[this.type]):this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){return this.hasDynamicValue?this.normalizedValue.value().format(mr[this.type]):Object(c.isNull)(this.value)&&this.useCurrentDateTime?l()().format(mr[this.type]):this.value}};function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Or(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Or(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Er={"date-range":"YYYY-MM-DD","datetime-range":"YYYY-MM-DD HH:mm","datetime-range-with-seconds":"YYYY-MM-DD HH:mm:ss"},jr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>l()();return function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return[e(),r?t():void 0]}},wr={today:{name:"Today",value:()=>[l()().startOf("day"),l()().endOf("day")]},yesterday:{name:"Yesterday",value:()=>[l()().subtract(1,"day").startOf("day"),l()().subtract(1,"day").endOf("day")]},this_week:{name:"This week",value:()=>[l()().startOf("week"),l()().endOf("week")]},this_month:{name:"This month",value:()=>[l()().startOf("month"),l()().endOf("month")]},this_year:{name:"This year",value:()=>[l()().startOf("year"),l()().endOf("year")]},last_week:{name:"Last week",value:()=>[l()().subtract(1,"week").startOf("week"),l()().subtract(1,"week").endOf("week")]},last_month:{name:"Last month",value:()=>[l()().subtract(1,"month").startOf("month"),l()().subtract(1,"month").endOf("month")]},last_year:{name:"Last year",value:()=>[l()().subtract(1,"year").startOf("year"),l()().subtract(1,"year").endOf("year")]},last_hour:{name:"Last hour",value:jr(()=>l()().subtract(1,"hour"))},last_8_hours:{name:"Last 8 hours",value:jr(()=>l()().subtract(8,"hour"))},last_24_hours:{name:"Last 24 hours",value:jr(()=>l()().subtract(24,"hour"))},last_7_days:{name:"Last 7 days",value:jr(()=>l()().subtract(7,"days").startOf("day"),()=>l()().endOf("day"))},last_14_days:{name:"Last 14 days",value:jr(()=>l()().subtract(14,"days").startOf("day"),()=>l()().endOf("day"))},last_30_days:{name:"Last 30 days",value:jr(()=>l()().subtract(30,"days").startOf("day"),()=>l()().endOf("day"))},last_60_days:{name:"Last 60 days",value:jr(()=>l()().subtract(60,"days").startOf("day"),()=>l()().endOf("day"))},last_90_days:{name:"Last 90 days",value:jr(()=>l()().subtract(90,"days").startOf("day"),()=>l()().endOf("day"))},last_12_months:{name:"Last 12 months",value:jr(()=>l()().subtract(12,"months").startOf("day"),()=>l()().endOf("day"))}},Sr=se.a.oneOf(Object(c.values)(wr));function Pr(e){return!!Object(c.startsWith)(e,"d_")&&!!wr[e.substring("d_".length)]}function Cr(e){return Object(c.includes)(wr,e)}function Nr(e){return Pr(e)?wr[e.substring("d_".length)]:null}var kr=class extends At{constructor(e,t){super(e,t),this.setValue(e.value)}get hasDynamicValue(){return Cr(this.normalizedValue)}normalizeValue(e){return Pr(e)?Nr(e):Cr(e)?e:(Object(c.isObject)(e)&&!Object(c.isArray)(e)&&(e=[e.start,e.end]),Object(c.isArray)(e)&&2===e.length&&(e=[l()(e[0]),l()(e[1])])[0].isValid()&&e[1].isValid()?e:null)}setValue(e){var t=this.normalizeValue(e);return Cr(t)?this.value="d_"+Object(c.findKey)(wr,t):Object(c.isArray)(t)?this.value={start:t[0].format(Er[this.type]),end:t[1].format(Er[this.type])}:this.value=t,this.$$value=t,this.updateLocals(),this.clearPendingValue(),this}getExecutionValue(){if(this.hasDynamicValue){var e=vr(this.normalizedValue.value().map(e=>e.format(Er[this.type])),2);return{start:e[0],end:e[1]}}return this.value}toUrlParams(){var e=this.urlPrefix;return Object(c.isObject)(this.value)&&this.value.start&&this.value.end?{["".concat(e).concat(this.name)]:"".concat(this.value.start,"--").concat(this.value.end)}:super.toUrlParams()}fromUrlParams(e){var t=this.urlPrefix,r="".concat(t).concat(this.name),a="".concat(t).concat(this.name,".start"),n="".concat(t).concat(this.name,".end");if(Object(c.has)(e,r)){var i=e[r].split("--");2===i.length?this.setValue(i):this.setValue(e[r])}else Object(c.has)(e,a)&&Object(c.has)(e,n)&&this.setValue([e[a],e[n]])}toQueryTextFragment(){return"{{ ".concat(this.name,".start }} {{ ").concat(this.name,".end }}")}};function _r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(r),!0).forEach((function(t){xr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qr(e,t){switch(e.type){case"number":return new qt(e,t);case"enum":return new Tt(e,t);case"query":return new dr(e,t);case"date":case"datetime-local":case"datetime-with-seconds":return new yr(e,t);case"date-range":case"datetime-range":case"datetime-range-with-seconds":return new kr(e,t);default:return new xt(Ar(Ar({},e),{},{type:"text"}),t)}}function Tr(e){return qr(e,e.parentQueryId)}var Ir="textbox",Dr="visualization",Rr="restricted";var Mr,zr,Fr,Lr={DashboardLevel:"dashboard-level",WidgetLevel:"widget-level",StaticValue:"static-value"};class Ur{constructor(e){Object(c.extend)(this,e);var t=function(e){e.width=1;var t={autoHeight:!1,sizeX:Math.round(Ot/2),sizeY:Pt,minSizeX:Ct,maxSizeX:Nt,minSizeY:kt,maxSizeY:_t},r=e.visualization?d.registeredVisualizations[e.visualization.type]:null;if(Object(c.isObject)(r)){Object.prototype.hasOwnProperty.call(r,"autoHeight")&&(t.autoHeight=r.autoHeight);var a=parseInt(r.minColumns,10);isFinite(a)&&a>=0&&(t.minSizeX=a);var n=parseInt(r.maxColumns,10);isFinite(n)&&n>=0&&(t.maxSizeX=Math.min(n,Ot));var i=parseInt(r.height,10);isFinite(i)&&(t.minSizeY=Math.ceil(i/Et));var s=parseInt(r.minRows,10);isFinite(s)&&(t.minSizeY=s);var o=parseInt(r.maxRows,10);isFinite(o)&&o>=0&&(t.maxSizeY=o);var l=parseInt(r.defaultColumns,10);isFinite(l)&&l>0&&(t.sizeX=l);var u=parseInt(r.defaultRows,10);isFinite(u)&&u>0&&(t.sizeY=u)}return t}(this);this.options=this.options||{},this.options.position=Object(c.extend)({},t,Object(c.pick)(this.options.position,["col","row","sizeX","sizeY","autoHeight"])),this.options.position.sizeY<0&&(this.options.position.autoHeight=!0)}get type(){return this.visualization?Dr:this.restricted?Rr:Ir}getQuery(){return!this.query&&this.visualization&&(this.query=new ir(this.visualization.query)),this.query}getQueryResult(){return this.data}getName(){return this.visualization?"".concat(this.visualization.query.name," (").concat(this.visualization.name,")"):Object(c.truncate)(this.text,20)}load(e,t){if(!this.visualization)return Promise.resolve();if(e||void 0===this.queryResult){this.loading=!0,this.refreshStartedAt=l()(),(void 0===t||e)&&(t=e?0:void 0);var r=this.getQuery().getQueryResult(t);this.queryResult=r,r.toPromise().then(e=>(this.queryResult===r&&(this.loading=!1,this.data=e),e)).catch(e=>(this.queryResult===r&&(this.loading=!1,this.data=e),e))}return this.queryResult.toPromise()}save(e,t){var r=Object(c.pick)(this,"options","text","id","width","dashboard_id","visualization_id");e&&t&&(r[e]=Object(c.merge)({},r[e],t));var a="api/widgets";return this.id&&(a="".concat(a,"/").concat(this.id)),K.post(a,r).then(e=>(Object(c.each)(e,(e,t)=>{this[t]=e}),this))}delete(){var e="api/widgets/".concat(this.id);return K.delete(e)}isStaticParam(e){return this.getParameterMappings()[e.name].type===Ur.MappingType.StaticValue}getParametersDefs(){var e=this.getParameterMappings(),t=this.getQuery()?this.getQuery().getParametersDefs():[],r=R.search,a=[Ur.MappingType.WidgetLevel,Ur.MappingType.StaticValue],n=Object(c.map)(Object(c.filter)(t,t=>a.indexOf(e[t.name].type)>=0),t=>{var a=e[t.name],n=Tr(t);return n.title=a.title||t.title,n.locals=[t],n.urlPrefix="p_w".concat(this.id,"_"),a.type===Ur.MappingType.StaticValue?n.setValue(a.value):n.fromUrlParams(r),n});return Object(c.sortBy)(n,e=>Object(c.includes)(this.options.paramOrder,e.name)?Object(c.indexOf)(this.options.paramOrder,e.name):Object(c.size)(this.options.paramOrder))}getParameterMappings(){Object(c.isObject)(this.options.parameterMappings)||(this.options.parameterMappings={});var e={},t=this.getQuery()?this.getQuery().getParametersDefs(!1):[];Object(c.each)(t,t=>{e[t.name]=!0,Object(c.isObject)(this.options.parameterMappings[t.name])||(this.options.parameterMappings[t.name]={name:t.name,type:t.global?Ur.MappingType.DashboardLevel:Ur.MappingType.WidgetLevel,mapTo:t.name,value:null,title:""})});var r=Object(c.difference)(Object(c.keys)(this.options.parameterMappings),Object(c.keys)(e));return Object(c.each)(r,e=>{delete this.options.parameterMappings[e]}),this.options.parameterMappings}getLocalParameters(){return Object(c.filter)(this.getParametersDefs(),e=>!this.isStaticParam(e))}}Mr=Ur,Fr=Lr,(zr=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(zr="MappingType"))in Mr?Object.defineProperty(Mr,zr,{value:Fr,enumerable:!0,configurable:!0,writable:!0}):Mr[zr]=Fr;var Vr=Ur;function Br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(r),!0).forEach((function(t){Wr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Wr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Hr=e=>{var t=e.id,r=e.slug;return"dashboards/".concat(t,"-").concat(r)};function Gr(e,t,r){var a={};return u.a.each(t,t=>{var n=t&&t.getFilters?t.getFilters():[];u.a.each(n,t=>{var n=u.a.has(r,t.name);if(n||e.dashboard_filters_enabled){n&&(t.current=r[t.name]);var i=Qr({},t);u.a.has(a,t.name)?a[i.name].values=u.a.union(a[i.name].values,i.values):a[i.name]=i}})}),u.a.values(a)}function Kr(e){var t=Math.max(u.a.chain(e).map(e=>e.options.position.sizeY).max().value(),20)+5;return u.a.chain(e).sortBy(e=>e.options.position.row).groupBy(e=>e.options.position.row).reduce((e,r)=>{var a=1;return u.a.each(r,r=>{a=Math.max(a,r.options.position.autoHeight?t:r.options.position.sizeY),r.options.position.row=e,r.options.position.sizeY<1&&(r.options.position.sizeY=t)}),e+a},0).value(),e=u.a.sortBy(e,e=>e.options.position.col),e=u.a.sortBy(e,e=>e.options.position.row)}function Yr(e,t){var r=u.a.extend({sizeX:St},u.a.extend({},t.options).position).sizeX,a=u.a.chain(e).map(e=>{var t=u.a.extend({},e.options),r=u.a.extend({row:0,sizeY:0},t.position);return{left:r.col,top:r.row,right:r.col+r.sizeX,bottom:r.row+r.sizeY,width:r.sizeX,height:r.sizeY}}).reduce((e,t)=>{for(var r=Math.max(t.left,0),a=Math.min(t.right,e.length+1),n=r;n<a;n+=1)e[n]=Math.max(e[n],t.bottom);return e},u.a.map(new Array(Ot),u.a.constant(0))).value();return u.a.chain(u.a.range(0,Ot-r+1)).map(e=>({col:e,row:u.a.chain(a).slice(e,e+r).max().value()})).sortBy("row").first().value()}function $r(e){u.a.extend(this,e),Object.defineProperty(this,"url",{get:function(){return Hr(this)}})}function Jr(e){return Kr(u.a.map(e,e=>new Vr(e)))}function Xr(e){return(e=new $r(e)).widgets&&(e.widgets=Jr(e.widgets)),e.publicAccessEnabled=void 0!==e.public_url,e}function Zr(e){return e=e.results?Qr(Qr({},e),{},{results:u.a.map(e.results,Xr)}):Xr(e)}var ea={get:e=>{var t=e.id,r=e.slug,a={};return t||(a.legacy=null),K.get("api/dashboards/".concat(t||r),{params:a}).then(Zr)},getByToken:e=>{var t=e.token;return K.get("api/dashboards/public/".concat(t)).then(Zr)},save:e=>K.post((e=>e.id?"api/dashboards/".concat(e.id):"api/dashboards")(e),e).then(Zr),delete:e=>{var t=e.id;return K.delete("api/dashboards/".concat(t)).then(Zr)},query:e=>K.get("api/dashboards",{params:e}).then(Zr),recent:e=>K.get("api/dashboards/recent",{params:e}).then(Zr),myDashboards:e=>K.get("api/dashboards/my",{params:e}).then(Zr),favorites:e=>K.get("api/dashboards/favorites",{params:e}).then(Zr),favorite:e=>{var t=e.id;return K.post("api/dashboards/".concat(t,"/favorite"))},unfavorite:e=>{var t=e.id;return K.delete("api/dashboards/".concat(t,"/favorite"))},fork:e=>{var t=e.id;return K.post("api/dashboards/".concat(t,"/fork"),{id:t}).then(Zr)}};function ta(){return(ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ra(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return aa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function na(e){var t=e.dialog,r=ra(Object(a.useState)(""),2),i=r[0],s=r[1],o=ra(Object(a.useState)(!1),2),l=o[0],u=o[1],d=ra(Object(a.useState)(!1),2),m=d[0],p=d[1],f=ae.isCreateDashboardEnabled();function h(){""!==i&&(p(!0),$r.save({name:i}).then(e=>{t.close(),bt("".concat(e.url,"?edit"))}),vt("create","dashboard"))}return n.a.createElement(V.a,ta({},t.props,f?{}:{footer:null},{title:"New Dashboard",okText:"Save",cancelText:"Close",okButtonProps:{disabled:!l||m,loading:m,"data-test":"DashboardSaveButton"},cancelButtonProps:{disabled:m},onOk:h,closable:!m,maskClosable:!m,wrapProps:{"data-test":"CreateDashboardDialog"}}),n.a.createElement(pe,{name:"CreateDashboardDialogExtra",disabled:!f},n.a.createElement(He.a,{defaultValue:i,onChange:function(e){var t=Object(c.trim)(e.target.value);s(t),u(""!==t)},onPressEnter:h,placeholder:"Dashboard Name","aria-label":"Dashboard name",disabled:m,autoFocus:!0})))}u.a.extend($r,ea),$r.prepareDashboardWidgets=Jr,$r.prepareWidgetsForDashboard=Kr,$r.prototype.canEdit=function(){return ae.canEdit(this)},$r.prototype.getParametersDefs=function(){var e={},t=R.search;u.a.each(this.widgets,t=>{if(t.getQuery()){var r=t.getParameterMappings();t.getQuery().getParametersDefs(!1).forEach(t=>{var a=r[t.name];a.type===Vr.MappingType.DashboardLevel&&(e[a.mapTo]||(e[a.mapTo]=Tr(t),e[a.mapTo].name=a.mapTo,e[a.mapTo].title=a.title||t.title,e[a.mapTo].locals=[]),e[a.mapTo].locals.push(t))})}});var r=u.a.values(u.a.each(e,e=>{e.setValue(e.value),e.fromUrlParams(t)}));return u.a.sortBy(r,e=>u.a.includes(this.options.globalParamOrder,e.name)?u.a.indexOf(this.options.globalParamOrder,e.name):u.a.size(this.options.globalParamOrder))},$r.prototype.addWidget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={dashboard_id:this.id,options:Qr(Qr({},t),{},{isHidden:!1,position:{}}),text:"",visualization_id:null,visualization:null};u.a.isString(e)?r.text=e:u.a.isObject(e)&&(r.visualization_id=e.id,r.visualization=e);var a=new Vr(r),n=Yr(this.widgets,a);return a.options.position.col=n.col,a.options.position.row=n.row,a.save().then(()=>(this.widgets=[...this.widgets,a],a))},$r.prototype.favorite=function(){return $r.favorite(this)},$r.prototype.unfavorite=function(){return $r.unfavorite(this)},$r.prototype.getUrl=function(){return Hr(this)},na.propTypes={dialog:Je.isRequired};var ia=Xe(na);function sa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function oa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sa(Object(r),!0).forEach((function(t){la(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function la(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ca{constructor(e){Object(c.extend)(this,{pathPrefix:"/".concat(e.path)},Object(c.omit)(e,["isActive","isAvailable"])),Object(c.isFunction)(e.isActive)&&(this.isActive=e.isActive),Object(c.isFunction)(e.isAvailable)&&(this.isAvailable=e.isAvailable)}isActive(e){return e.startsWith(this.pathPrefix)}isAvailable(){return void 0===this.permission||Y.hasPermission(this.permission)}}var ua=new class{constructor(){la(this,"items",[])}add(e,t){e=Object(c.isString)(e)?e:null,this.remove(e),Object(c.isObject)(t)&&(this.items.push(new ca(oa(oa({},t),{},{id:e}))),this.items=Object(c.sortBy)(this.items,"order"))}remove(e){Object(c.isString)(e)&&(this.items=Object(c.filter)(this.items,t=>t.id!==e))}getAvailableItems(){return Object(c.filter)(this.items,e=>e.isAvailable())}getActiveItem(e){var t=ft(e);return Object(c.find)(this.items,e=>e.isActive(t))}},da=r(110),ma=r(692),pa=r.n(ma),fa=r(693),ha=r.n(fa),ba=r(694),ga=r.n(ba),ya=r(433),va=r.n(ya),Oa=r(695),Ea=r.n(Oa),ja=r(696),wa=r.n(ja),Sa=r(440);function Pa(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,"Version: ",$.version,Sa!==$.version&&" (".concat(Sa.substring(0,8),")")),$.newVersionAvailable&&Y.hasPermission("super_admin")&&n.a.createElement("div",{className:"m-t-10"},n.a.createElement(S,{href:"https://version.redash.io/",className:"update-available",target:"_blank",rel:"noopener"},"Update Available ",n.a.createElement("i",{className:"fa fa-external-link m-l-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))))}var Ca=["children"];function Na(){return(Na=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ka(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _a(e){var t=e.children,r=ka(e,Ca);return n.a.createElement(he.a,Na({selectable:!1,mode:"vertical",theme:"dark"},r),t)}function Aa(){var e=Object(a.useContext)(pt);return Object(a.useMemo)(()=>({dashboards:Object(c.includes)(["Dashboards.List","Dashboards.Favorites","Dashboards.My","Dashboards.ViewOrEdit","Dashboards.LegacyViewOrEdit"],e.id),queries:Object(c.includes)(["Queries.List","Queries.Favorites","Queries.Archived","Queries.My","Queries.View","Queries.New","Queries.Edit"],e.id),dataSources:Object(c.includes)(["DataSources.List"],e.id),alerts:Object(c.includes)(["Alerts.List","Alerts.New","Alerts.View","Alerts.Edit"],e.id)}),[e.id])}function xa(){var e=Object(c.first)(ua.getAvailableItems()),t=Aa(),r=Y.hasPermission("create_query"),a=Y.hasPermission("create_dashboard"),i=Y.hasPermission("list_alerts");return n.a.createElement("nav",{className:"desktop-navbar"},n.a.createElement(_a,{className:"desktop-navbar-logo"},n.a.createElement("div",{role:"menuitem"},n.a.createElement(S,{href:"./"},n.a.createElement("img",{src:da.default,alt:"Redash"})))),n.a.createElement(_a,null,Y.hasPermission("list_dashboards")&&n.a.createElement(he.a.Item,{key:"dashboards",className:t.dashboards?"navbar-active-item":null},n.a.createElement(S,{href:"dashboards"},n.a.createElement(pa.a,{"aria-label":"Dashboard navigation button"}),n.a.createElement("span",{className:"desktop-navbar-label"},"Dashboards"))),Y.hasPermission("view_query")&&n.a.createElement(he.a.Item,{key:"queries",className:t.queries?"navbar-active-item":null},n.a.createElement(S,{href:"queries"},n.a.createElement(ha.a,{"aria-label":"Queries navigation button"}),n.a.createElement("span",{className:"desktop-navbar-label"},"Queries"))),Y.hasPermission("list_alerts")&&n.a.createElement(he.a.Item,{key:"alerts",className:t.alerts?"navbar-active-item":null},n.a.createElement(S,{href:"alerts"},n.a.createElement(ga.a,{"aria-label":"Alerts navigation button"}),n.a.createElement("span",{className:"desktop-navbar-label"},"Alerts")))),n.a.createElement(_a,{className:"desktop-navbar-spacer"},(r||a||i)&&n.a.createElement(he.a.SubMenu,{key:"create",popupClassName:"desktop-navbar-submenu","data-test":"CreateButton",tabIndex:0,title:n.a.createElement(n.a.Fragment,null,n.a.createElement(va.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},"Create"))},r&&n.a.createElement(he.a.Item,{key:"new-query"},n.a.createElement(S,{href:"queries/new","data-test":"CreateQueryMenuItem"},"New Query")),a&&n.a.createElement(he.a.Item,{key:"new-dashboard"},n.a.createElement(Ee,{"data-test":"CreateDashboardMenuItem",onClick:()=>ia.showModal()},"New Dashboard")),i&&n.a.createElement(he.a.Item,{key:"new-alert"},n.a.createElement(S,{"data-test":"CreateAlertMenuItem",href:"alerts/new"},"New Alert")))),n.a.createElement(_a,null,n.a.createElement(he.a.Item,{key:"help"},n.a.createElement(Qe,{showTooltip:!1,type:"HOME",tabIndex:0},n.a.createElement(Ea.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},"Help"))),e&&n.a.createElement(he.a.Item,{key:"settings",className:t.dataSources?"navbar-active-item":null},n.a.createElement(S,{href:e.path,"data-test":"SettingsLink"},n.a.createElement(wa.a,null),n.a.createElement("span",{className:"desktop-navbar-label"},"Settings")))),n.a.createElement(_a,{className:"desktop-navbar-profile-menu"},n.a.createElement(he.a.SubMenu,{key:"profile",popupClassName:"desktop-navbar-submenu",tabIndex:0,title:n.a.createElement("span",{"data-test":"ProfileDropdown",className:"desktop-navbar-profile-menu-title"},n.a.createElement("img",{className:"profile__image_thumb",src:Y.profile_image_url,alt:Y.name}))},n.a.createElement(he.a.Item,{key:"profile"},n.a.createElement(S,{href:"users/me"},"Profile")),Y.hasPermission("super_admin")&&n.a.createElement(he.a.Item,{key:"status"},n.a.createElement(S,{href:"admin/status"},"System Status")),n.a.createElement(he.a.Divider,null),n.a.createElement(he.a.Item,{key:"logout"},n.a.createElement(Ee,{"data-test":"LogOutButton",onClick:()=>re.logout()},"Log out")),n.a.createElement(he.a.Divider,null),n.a.createElement(he.a.Item,{key:"version",role:"presentation",disabled:!0,className:"version-info"},n.a.createElement(Pa,null)))))}var qa=r(697),Ta=r.n(qa),Ia=r(65),Da=r.n(Ia);function Ra(e){var t=e.getPopupContainer,r=Object(c.first)(ua.getAvailableItems());return n.a.createElement("div",{className:"mobile-navbar"},n.a.createElement("div",{className:"mobile-navbar-logo"},n.a.createElement(S,{href:"./"},n.a.createElement("img",{src:da.default,alt:"Redash"}))),n.a.createElement("div",null,n.a.createElement(Da.a,{overlayStyle:{minWidth:200},trigger:["click"],getPopupContainer:t,overlay:n.a.createElement(he.a,{mode:"vertical",theme:"dark",selectable:!1,className:"mobile-navbar-menu"},Y.hasPermission("list_dashboards")&&n.a.createElement(he.a.Item,{key:"dashboards"},n.a.createElement(S,{href:"dashboards"},"Dashboards")),Y.hasPermission("view_query")&&n.a.createElement(he.a.Item,{key:"queries"},n.a.createElement(S,{href:"queries"},"Queries")),Y.hasPermission("list_alerts")&&n.a.createElement(he.a.Item,{key:"alerts"},n.a.createElement(S,{href:"alerts"},"Alerts")),n.a.createElement(he.a.Item,{key:"profile"},n.a.createElement(S,{href:"users/me"},"Edit Profile")),n.a.createElement(he.a.Divider,null),r&&n.a.createElement(he.a.Item,{key:"settings"},n.a.createElement(S,{href:r.path},"Settings")),Y.hasPermission("super_admin")&&n.a.createElement(he.a.Item,{key:"status"},n.a.createElement(S,{href:"admin/status"},"System Status")),Y.hasPermission("super_admin")&&n.a.createElement(he.a.Divider,null),n.a.createElement(he.a.Item,{key:"help"},n.a.createElement(S,{href:"https://redash.io/help",target:"_blank",rel:"noopener"},"Help")),n.a.createElement(he.a.Item,{key:"logout",onClick:()=>re.logout()},"Log out"))},n.a.createElement(h.a,{className:"mobile-navbar-toggle-button",ghost:!0},n.a.createElement(Ta.a,null)))))}function Ma(e){var t=e.children,r=Object(a.useRef)(),i=Object(a.useCallback)(()=>r.current,[]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(pe,{name:"ApplicationWrapper"},n.a.createElement("div",{className:"application-layout-side-menu"},n.a.createElement(pe,{name:"ApplicationDesktopNavbar"},n.a.createElement(xa,null))),n.a.createElement("div",{className:"application-layout-content"},n.a.createElement("nav",{className:"application-layout-top-menu",ref:r},n.a.createElement(pe,{name:"ApplicationMobileNavbar",getPopupContainer:i},n.a.createElement(Ra,{getPopupContainer:i}))),t)))}Ra.propTypes={getPopupContainer:se.a.func},Ra.defaultProps={getPopupContainer:null},Ma.propTypes={children:se.a.node},Ma.defaultProps={children:null};var za=["render","bodyClass"];function Fa(){return(Fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function La(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ua(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Va(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ua(Object(r),!0).forEach((function(t){Ba(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ua(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ba(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ha(e){var t=e.bodyClass,r=e.currentRoute,i=e.render,s=Qa(Object(a.useState)(!!re.isAuthenticated()),2),o=s[0],l=s[1];return Object(a.useEffect)(()=>{var e=!1;return Promise.all([re.requireSession(),ne.refresh(),ae.refresh()]).then(()=>{e||l(!!re.isAuthenticated())}).catch(()=>{e||l(!1)}),()=>{e=!0}},[]),Object(a.useEffect)(()=>{if(t)return document.body.classList.toggle(t,!0),()=>{document.body.classList.toggle(t,!1)}},[t]),o?n.a.createElement(Ma,null,n.a.createElement(n.a.Fragment,{key:r.key},n.a.createElement(C.a,{renderError:e=>n.a.createElement(ot,{error:e})},n.a.createElement(P.ErrorBoundaryContext.Consumer,null,e=>{var t=e.handleError;return i(Va(Va({},r.routeParams),{},{pageTitle:r.title,onError:t}))})))):null}function Ga(e){var t=e.render,r=e.bodyClass;return Va(Va({},La(e,za)),{},{render:e=>{var a={render:t,bodyClass:r,currentRoute:e};return n.a.createElement(pe,Fa({},a,{name:"UserSessionWrapper",fallback:n.a.createElement(Ha,a)}))}})}function Ka(){return(Ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ya(e){var t=e.show,r=e.completed,a=e.text,i=e.url,s=e.urlText,o=e.onClick;if(!t)return null;var l={children:s,onClick:o};return n.a.createElement("li",{className:ge()({done:r})},i?n.a.createElement(S,Ka({href:i},l)):n.a.createElement(Ee,Ka({type:"link"},l))," ",a)}function $a(e){var t=e.helpTriggerType;return n.a.createElement("p",null,"Need more support?"," ",n.a.createElement(Qe,{className:"f-14",type:t,showTooltip:!1},"See our Help"))}function Ja(e){var t=e.icon,r=e.header,i=e.description,s=e.illustration,o=e.helpMessage,l=e.closable,u=e.onClose,d=e.onboardingMode,m=e.showAlertStep,p=e.showDashboardStep,f=e.showDataSourceStep,h=e.showInviteStep,b=e.getStepsItems,g=e.illustrationPath,y={dataSource:f,query:!0,alert:m,dashboard:p,inviteUsers:h},v={dataSource:ne.objectCounters.data_sources>0,query:ne.objectCounters.queries>0,alert:ne.objectCounters.alerts>0,dashboard:ne.objectCounters.dashboards>0,inviteUsers:ne.objectCounters.users>1},O=Object(a.useCallback)(()=>{ia.showModal()},[]);if(!(!d||Object(c.some)(Object(c.keys)(y),e=>y[e]&&!v[e])))return null;var E=[{key:"dataSources",node:Y.isAdmin?n.a.createElement(Ya,{key:"dataSources",show:y.dataSource,completed:v.dataSource,url:"data_sources/new",urlText:"Connect a Data Source"}):n.a.createElement(Ya,{key:"dataSources",show:y.dataSource,completed:v.dataSource,text:"Ask an account admin to connect a data source"})},{key:"queries",node:n.a.createElement(Ya,{key:"queries",show:y.query,completed:v.query,url:"queries/new",urlText:"Create your first Query"})},{key:"alerts",node:n.a.createElement(Ya,{key:"alerts",show:y.alert,completed:v.alert,url:"alerts/new",urlText:"Create your first Alert"})},{key:"dashboards",node:n.a.createElement(Ya,{key:"dashboards",show:y.dashboard,completed:v.dashboard,onClick:O,urlText:"Create your first Dashboard"})},{key:"users",node:n.a.createElement(Ya,{key:"users",show:y.inviteUsers,completed:v.inviteUsers,url:"users/new",urlText:"Invite your team members"})}],j=b?b(E):E,w=g||"static/images/illustrations/"+s+".svg";return n.a.createElement("div",{className:"empty-state-wrapper"},n.a.createElement("div",{className:"empty-state bg-white tiled"},n.a.createElement("div",{className:"empty-state__summary"},r&&n.a.createElement("h4",null,r),n.a.createElement("h2",null,n.a.createElement("i",{className:t,"aria-hidden":"true"})),n.a.createElement("p",null,i),n.a.createElement("img",{src:w,alt:s+" Illustration",width:"75%"})),n.a.createElement("div",{className:"empty-state__steps"},n.a.createElement("h4",null,"Let's get started"),n.a.createElement("ol",null,j.map(e=>e.node)),o)),l&&n.a.createElement(Ee,{className:"close-button","aria-label":"Close",onClick:u},n.a.createElement(xe.a,null)))}Ya.propTypes={show:se.a.bool.isRequired,completed:se.a.bool.isRequired,text:se.a.node,url:se.a.string,urlTarget:se.a.string,urlText:se.a.node,onClick:se.a.func},Ya.defaultProps={url:null,urlTarget:null,urlText:null,text:null,onClick:null},$a.propTypes={helpTriggerType:se.a.string.isRequired},Ja.propTypes={icon:se.a.string,header:se.a.string,description:se.a.string.isRequired,illustration:se.a.string.isRequired,illustrationPath:se.a.string,helpMessage:se.a.node,closable:se.a.bool,onClose:se.a.func,onboardingMode:se.a.bool,showAlertStep:se.a.bool,showDashboardStep:se.a.bool,showDataSourceStep:se.a.bool,showInviteStep:se.a.bool,getStepItems:se.a.func},Ja.defaultProps={icon:null,header:null,helpMessage:null,closable:!1,onClose:()=>{},onboardingMode:!1,showAlertStep:!1,showDashboardStep:!1,showDataSourceStep:!0,showInviteStep:!1};var Xa=Ja,Za=r(105),en=r.n(Za),tn=r(89),rn=r.n(tn),an=r(248),nn=r.n(an);function sn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function on(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(r),!0).forEach((function(t){ln(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ln(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}nn.a.config({placement:"bottomRight",duration:3});var cn={};["success","error","info","warning","warn"].forEach(e=>{cn[e]=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return nn.a[e](on(on({},a),{},{message:t,description:r}))}});var un=on(on({},nn.a),cn),dn=()=>K.get("api/settings/organization"),mn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Settings changes saved.";return K.post("api/settings/organization",e).then(e=>(un.success(t),e)).catch(()=>{un.error("Failed saving changes.")})};function pn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var hn=rn.a.Text;var bn=function(){var e=pn(Object(a.useState)(!1),2),t=e[0],r=e[1];if(!$.showBeaconConsentMessage||t)return null;var i=()=>{$.showBeaconConsentMessage=!1,r(!0)},s=e=>{var t="🙏 Thank you.";e||(t="Settings Saved."),mn({beacon_consent:e},t).finally(i)};return n.a.createElement(pe,{name:"BeaconConsent"},n.a.createElement("div",{className:"m-t-10 tiled"},n.a.createElement(en.a,{title:n.a.createElement(n.a.Fragment,null,"Would you be ok with sharing anonymous usage data with the Redash team?"," ",n.a.createElement(Qe,{type:"USAGE_DATA_SHARING"})),bordered:!1},n.a.createElement(hn,null,"Help Redash improve by automatically sending anonymous usage data:"),n.a.createElement("div",{className:"m-t-5"},n.a.createElement("ul",null,n.a.createElement("li",null," Number of users, queries, dashboards, alerts, widgets and visualizations."),n.a.createElement("li",null," Types of data sources, alert destinations and visualizations."))),n.a.createElement(hn,null,"All data is aggregated and will never include any sensitive or private data."),n.a.createElement("div",{className:"m-t-5"},n.a.createElement(h.a,{type:"primary",className:"m-r-5",onClick:()=>s(!0)},"Yes"),n.a.createElement(h.a,{type:"default",onClick:()=>s(!1)},"No")),n.a.createElement("div",{className:"m-t-15"},n.a.createElement(hn,{type:"secondary"},"You can change this setting anytime from the"," ",n.a.createElement(S,{href:"settings/organization"},"Organization Settings")," page.")))))},gn=r(249),yn=r.n(gn);function vn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function On(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(r),!0).forEach((function(t){En(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function En(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var jn=new class{constructor(){En(this,"_items",[]),En(this,"_sorted",!1)}get items(){return this._sorted||(this._items=Object(c.sortBy)(this._items,[e=>{return t=e.path,r=yn.a.parse(t),Object(c.filter)(r,c.isObject).length;var t,r},e=>-e.path.length,e=>e.path]),this._sorted=!0),this._items}register(e,t){var r=Object(c.isString)(e)?e:null;this.unregister(r),Object(c.isObject)(t)&&(this._items=[...this.items,On(On({},t),{},{id:r})],this._sorted=!1)}unregister(e){Object(c.isString)(e)&&(this._items=Object(c.filter)(this.items,t=>t.id!==e))}},wn=r(98),Sn=r.n(wn);function Pn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Nn(e){var t=e.title,r=e.resource,i=e.itemUrl,s=e.emptyState,o=Pn(Object(a.useState)([]),2),l=o[0],u=o[1],d=Pn(Object(a.useState)(!0),2),m=d[0],p=d[1];return Object(a.useEffect)(()=>{p(!0),r.favorites().then(e=>{var t=e.results;return u(t)}).finally(()=>p(!1))},[r]),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"d-flex align-items-center m-b-20"},n.a.createElement("p",{className:"flex-fill f-500 c-black m-0"},t),m&&n.a.createElement(Sn.a,null)),!Object(c.isEmpty)(l)&&n.a.createElement("div",{role:"list",className:"list-group"},l.map(e=>n.a.createElement(S,{key:i(e),role:"listitem",className:"list-group-item",href:i(e)},n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),e.name,e.is_draft&&n.a.createElement("span",{className:"label label-default m-l-5"},"Unpublished")))),Object(c.isEmpty)(l)&&!m&&s)}function kn(){return n.a.createElement("div",{className:"tile"},n.a.createElement("div",{className:"t-body tb-padding"},n.a.createElement("div",{className:"row home-favorites-list"},n.a.createElement("div",{className:"col-sm-6 m-t-20"},n.a.createElement(Nn,{title:"Favorite Dashboards",resource:$r,itemUrl:e=>e.url,emptyState:n.a.createElement("p",null,n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),"Favorite ",n.a.createElement(S,{href:"dashboards"},"Dashboards")," will appear here")})),n.a.createElement("div",{className:"col-sm-6 m-t-20"},n.a.createElement(Nn,{title:"Favorite Queries",resource:ir,itemUrl:e=>"queries/".concat(e.id),emptyState:n.a.createElement("p",null,n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:"fa fa-star","aria-hidden":"true"})),"Favorite ",n.a.createElement(S,{href:"queries"},"Queries")," will appear here")})))))}function _n(){return n.a.createElement(p.a,{className:"m-b-15",type:"warning",message:n.a.createElement(n.a.Fragment,null,"You have enabled ",n.a.createElement("code",null,"ALLOW_PARAMETERS_IN_EMBEDS"),". This setting is now deprecated and should be turned off. Parameters in embeds are supported by default."," ",n.a.createElement(S,{href:"https://discuss.redash.io/t/support-for-parameters-in-embedded-visualizations/3337",target:"_blank",rel:"noopener noreferrer"},"Read more"),".")})}function An(){return n.a.createElement(p.a,{className:"m-b-15",type:"warning",message:n.a.createElement(n.a.Fragment,null,"We have sent an email with a confirmation link to your email address. Please follow the link to verify your email address."," ",n.a.createElement(Ee,{type:"link",onClick:()=>{K.post("verification_email/").then(e=>{un.success(e.message)})}},"Resend email"),".")})}function xn(){return Object(a.useEffect)(()=>{vt("view","page","personal_homepage")},[]),n.a.createElement("div",{className:"home-page"},n.a.createElement("div",{className:"container"},Object(c.includes)(J,"using-deprecated-embed-feature")&&n.a.createElement(_n,null),Object(c.includes)(J,"email-not-verified")&&n.a.createElement(An,null),n.a.createElement(pe,{name:"Home.EmptyState"},n.a.createElement(Xa,{header:"Welcome to Redash 👋",description:"Connect to any data source, easily visualize and share your data",illustration:"dashboard",helpMessage:n.a.createElement($a,{helpTriggerType:"GETTING_STARTED"}),showDashboardStep:!0,showInviteStep:!0,onboardingMode:!0})),n.a.createElement(pe,{name:"HomeExtra"}),n.a.createElement(kn,null),n.a.createElement(bn,null)))}Nn.propTypes={title:se.a.string.isRequired,resource:se.a.func.isRequired,itemUrl:se.a.func.isRequired,emptyState:se.a.node},Nn.defaultProps={emptyState:null},jn.register("Home",Ga({path:"/",title:"Redash",render:e=>n.a.createElement(xn,e)}));var qn=r(113),Tn=r.n(qn),In=r(69);function Dn(e){var t=e.title,r=e.actions;return n.a.createElement("div",{className:"page-header-wrapper"},n.a.createElement("h3",null,t),r&&n.a.createElement("div",{className:"page-header-actions"},r))}function Rn(e){var t=e.activeTab,r=e.children;return n.a.createElement("div",{className:"admin-page-layout"},n.a.createElement("div",{className:"container"},n.a.createElement(Dn,{title:"Admin"}),n.a.createElement("div",{className:"bg-white tiled"},n.a.createElement(he.a,{selectedKeys:[t],selectable:!1,mode:"horizontal"},n.a.createElement(he.a.Item,{key:"system_status"},n.a.createElement(S,{href:"admin/status"},"System Status")),n.a.createElement(he.a.Item,{key:"jobs"},n.a.createElement(S,{href:"admin/queries/jobs"},"RQ Status")),n.a.createElement(he.a.Item,{key:"outdated_queries"},n.a.createElement(S,{href:"admin/queries/outdated"},"Outdated Queries"))),r)))}Dn.propTypes={title:se.a.string,actions:se.a.node},Dn.defaultProps={title:"",actions:null},Rn.propTypes={activeTab:se.a.string,children:se.a.node},Rn.defaultProps={activeTab:"system_status",children:null};var Mn=r(205),zn=r.n(Mn),Fn=r(197),Ln=r.n(Fn),Un=r(70),Vn=r.n(Un),Bn=r(78),Qn=r.n(Bn);function Wn(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hn extends n.a.Component{toggleItem(e,t,r){var a=t.is_favorite?t.unfavorite.bind(t):t.favorite.bind(t),n=t.is_favorite;a().then(()=>{t.is_favorite=!n,this.forceUpdate(),r()})}render(){var e=this.props,t=e.item,r=e.onChange,a=t.is_favorite?"fa fa-star":"fa fa-star-o",i=t.is_favorite?"Remove from favorites":"Add to favorites";return n.a.createElement(Ee,{title:i,"aria-label":i,className:"favorites-control btn-favorite",onClick:e=>this.toggleItem(e,t,r)},n.a.createElement("i",{className:a,"aria-hidden":"true"}))}}Wn(Hn,"propTypes",{item:se.a.shape({is_favorite:se.a.bool.isRequired}).isRequired,onChange:se.a.func}),Wn(Hn,"defaultProps",{onChange:()=>{}});se.a.shape({syntax:se.a.string,options:se.a.shape({doc:se.a.string,doc_url:se.a.string}),type_name:se.a.string});var Gn=se.a.shape({columns:se.a.arrayOf(se.a.string).isRequired}),Kn=(se.a.arrayOf(Gn),se.a.shape({interval:se.a.number,time:se.a.string,day_of_week:se.a.string,until:se.a.string})),Yn={interval:null,time:null,day_of_week:null,until:null},$n=se.a.shape({id:se.a.number.isRequired,name:se.a.string.isRequired,email:se.a.string.isRequired,profileImageUrl:se.a.string,apiKey:se.a.string,isDisabled:se.a.bool}),Jn=se.a.shape({id:se.a.number.isRequired,name:se.a.string.isRequired,icon:se.a.string.isRequired,type:se.a.string.isRequired}),Xn=se.a.shape({id:se.a.any.isRequired,name:se.a.string.isRequired,description:se.a.string,data_source_id:se.a.any.isRequired,created_at:se.a.string.isRequired,updated_at:se.a.string,user:$n,query:se.a.string,queryHash:se.a.string,is_safe:se.a.bool.isRequired,is_draft:se.a.bool.isRequired,is_archived:se.a.bool.isRequired,api_key:se.a.string.isRequired}),Zn=se.a.shape({column:se.a.string,op:se.a.oneOf([">",">=","<","<=","==","!="]),value:se.a.oneOfType([se.a.string,se.a.number]),custom_subject:se.a.string,custom_body:se.a.string}),ei=se.a.shape({id:se.a.any,name:se.a.string,created_at:se.a.string,last_triggered_at:se.a.string,updated_at:se.a.string,rearm:se.a.number,state:se.a.oneOf(["ok","triggered","unknown"]),user:$n,query:Xn,options:se.a.shape({column:se.a.string,op:se.a.string,value:se.a.oneOfType([se.a.string,se.a.number])}).isRequired});function ti(e,t,r,a){var n=t[r],i=e&&null!=n&&l.a.isMoment(n),s=!e&&(null==n||l.a.isMoment(n));if(!i&&!s)return new Error("Prop `"+r+"` supplied to `"+a+"` should be a Moment.js instance.")}var ri=Object(c.wrap)(!1,ti);function ai(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ni(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ni(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ii(e){var t=e.date,r=e.placeholder,i=e.autoUpdate,s=e.variation,o=function(e){return(e=Object(c.isNil)(e)?null:l()(e))&&e.isValid()?e:null}(t),u=ai(Object(a.useState)(null),2),d=u[0],m=u[1],p=Object(a.useMemo)(()=>o?o.format($.dateTimeFormat):null,[o]);return Object(a.useEffect)(()=>{function e(){m(o?o.fromNow():r)}if(e(),i){var t=setInterval(e,3e4);return()=>clearInterval(t)}},[i,o,r]),"timeAgoInTooltip"===s?n.a.createElement(Ne,{title:d},n.a.createElement("span",{"data-test":"TimeAgo"},p)):n.a.createElement(Ne,{title:p},n.a.createElement("span",{"data-test":"TimeAgo"},d))}function si(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}ri.isRequired=Object(c.wrap)(!0,ti),ii.propTypes={date:se.a.oneOfType([se.a.string,se.a.number,se.a.instanceOf(Date),ri]),placeholder:se.a.string,autoUpdate:se.a.bool,variation:se.a.oneOf(["timeAgoInTooltip"])},ii.defaultProps={date:null,placeholder:"",autoUpdate:!0};var li={NEVER:"Never",SECONDS:"second",MINUTES:"minute",HOURS:"hour",DAYS:"day",WEEKS:"week",MILLISECONDS:"millisecond"};function ci(e,t){if(!e)return"";var r=l()(e);return r.isValid()?r.format(t):"-"}function ui(e){return ci(e,$.dateTimeFormat)}function di(e){return ci(e,$.dateFormat)}function mi(e){var t=si(e.split(":"),2),r=t[0],a=t[1];return l.a.utc().hour(r).minute(a).local().format("HH:mm")}function pi(e){if(!e)return{interval:li.NEVER};var t=li.SECONDS;return e>=60&&(e/=60,t=li.MINUTES),e>=60&&(e/=60,t=li.HOURS),e>=24&&t===li.HOURS&&(e/=24,t=li.DAYS),e>=7&&!(e%7)&&t===li.DAYS&&(e/=7,t=li.WEEKS),{count:e,interval:t}}function fi(e,t){return e+(1!==t?"s":"")}function hi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"-";var r="",a=pi(e),n=a.interval,i=a.count,s=Math.round(i);return 1===s&&t.omitSingleValueNumber||(r="".concat(s," ")),r+=fi(n,s)}function bi(e){return e.replace(/_/g," ").replace(/(?:^|\s)\S/g,e=>e.toUpperCase())}function gi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return Math.round(e)!==e?e.toFixed(t):e.toString()}function yi(e,t){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0;if(isNaN(parseFloat(e))||!isFinite(e))return{value:"",unit:"",divisor:1};for(var n=0,i=1;e>=t&&n<r.length-1;)e/=t,i*=t,n+=1;return{value:gi(e,a),unit:r[n],divisor:i}}(e,1024,["bytes","KB","MB","GB","TB","PB"],t)}function vi(e){var t=yi(e),r=t.value,a=t.unit;return r?r+" "+a:"?"}function Oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l.a.isMoment(e)?"date"===t?di(e):ui(e):"boolean"==typeof e?e.toString():e}function Ei(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ji(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ei(Object(r),!0).forEach((function(t){wi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ei(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wi(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Si(){return(Si=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Pi(){return Object(c.extend)(this(...arguments),{sorter:!0})}var Ci={favorites:e=>Object(c.extend)({width:"1%",render:(e,t)=>n.a.createElement(Hn,{item:t})},e),avatar:(e,t)=>(t=Object(c.isFunction)(t)?t:c.identity,Object(c.extend)({width:"1%",render:(e,r)=>n.a.createElement("img",{src:r.user.profile_image_url,className:"profile__image_thumb",alt:t(e.name,r),title:t(e.name,r)})},e)),date:e=>Object(c.extend)({render:e=>di(e)},e),dateTime:e=>Object(c.extend)({render:e=>ui(e)},e),duration:e=>Object(c.extend)({width:"1%",className:"text-nowrap",render:e=>hi(e)},e),timeAgo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return Object(c.extend)({render:e=>n.a.createElement(ii,Si({date:e},t))},e)},custom:(e,t)=>Object(c.extend)({render:e},t)};Ci.date.sortable=Pi,Ci.dateTime.sortable=Pi,Ci.duration.sortable=Pi,Ci.timeAgo.sortable=Pi,Ci.custom.sortable=Pi;class Ni extends n.a.Component{constructor(){super(...arguments),wi(this,"getRowKey",e=>{var t=this.props.rowKey;return t?Object(c.isFunction)(t)?t(e.item):e.item[t]:e.key})}prepareColumns(){var e=this.props,t=e.orderByField,r=e.orderByReverse,a=e.toggleSorting,n=r?"descend":"ascend";return Object(c.map)(Object(c.map)(Object(c.filter)(this.props.columns,e=>!Object(c.isFunction)(e.isAvailable)||e.isAvailable()),e=>Object(c.extend)(e,{orderByField:e.orderByField||e.field})),(e,r)=>{var i=e.sorter?()=>({onClick:()=>a(e.orderByField)}):null,s=Object(c.isFunction)(e.render)?(t,r)=>e.render(t,r.item):c.identity;return Object(c.extend)(Object(c.omit)(e,["field","orderByField","render"]),{key:"column"+r,dataIndex:["item",e.field],defaultSortOrder:e.orderByField===t?n:null,onHeaderCell:i,render:s})})}render(){var e={columns:this.prepareColumns(),dataSource:Object(c.map)(this.props.items,(e,t)=>({key:"row"+t,item:e}))},t=Object(c.isFunction)(this.props.onRowClick)?e=>({onClick:t=>{this.props.onRowClick(t,e.item)}}):null,r=this.props.showHeader;return this.props.loading&&(Object(c.isEmpty)(e.dataSource)?(e.columns=e.columns.map(e=>ji(ji({},e),{},{sorter:!1,render:()=>n.a.createElement(Qn.a,{active:!0,paragraph:!1})})),e.dataSource=Object(c.range)(10).map(e=>({key:"".concat(e)}))):e.loading={indicator:null}),n.a.createElement(Vn.a,Si({className:ge()("table-data",{"ant-table-headerless":!r}),showHeader:r,rowKey:this.getRowKey,pagination:!1,onRow:t,"data-test":this.props["data-test"]},e))}}function ki(e){var t=e.title,r=e.value,a=e.loading;return n.a.createElement(Ln.a,{spinning:a},n.a.createElement(en.a,null,t,n.a.createElement("div",{className:"f-20"},r)))}wi(Ni,"propTypes",{loading:se.a.bool,items:se.a.arrayOf(se.a.object),columns:se.a.arrayOf(se.a.shape({field:se.a.string,orderByField:se.a.string,render:se.a.func,isAvailable:se.a.func})),showHeader:se.a.bool,onRowClick:se.a.func,orderByField:se.a.string,orderByReverse:se.a.bool,toggleSorting:se.a.func,"data-test":se.a.string,rowKey:se.a.oneOfType([se.a.string,se.a.func])}),wi(Ni,"defaultProps",{loading:!1,items:[],columns:[],showHeader:!0,onRowClick:null,orderByField:null,orderByReverse:!1,toggleSorting:()=>{}}),ki.propTypes={title:se.a.string.isRequired,value:se.a.oneOfType([se.a.number,se.a.string]),loading:se.a.bool.isRequired},ki.defaultProps={value:""};var _i=[{title:"Queue",dataIndex:"origin"},{title:"Query ID",dataIndex:["meta","query_id"]},{title:"Org ID",dataIndex:["meta","org_id"]},{title:"Data Source ID",dataIndex:["meta","data_source_id"]},{title:"User ID",dataIndex:["meta","user_id"]},Ci.custom(e=>e.toString(),{title:"Scheduled",dataIndex:["meta","scheduled"]}),Ci.timeAgo({title:"Start Time",dataIndex:"started_at"}),Ci.timeAgo({title:"Enqueue Time",dataIndex:"enqueued_at"})],Ai=[{title:"Queue",dataIndex:"origin"},{title:"Job Name",dataIndex:"name"},Ci.timeAgo({title:"Start Time",dataIndex:"started_at"}),Ci.timeAgo({title:"Enqueue Time",dataIndex:"enqueued_at"})],xi=[Ci.custom(e=>n.a.createElement("span",null,n.a.createElement(zn.a,{status:{busy:"processing",idle:"default",started:"success",suspended:"warning"}[e]})," ",e),{title:"State",dataIndex:"state"})].concat(Object(c.map)(["Hostname","PID","Name","Queues","Current Job","Successful Jobs","Failed Jobs"],e=>({title:e,dataIndex:e.toLowerCase().replace(/\s/g,"_")}))).concat([Ci.dateTime({title:"Birth Date",dataIndex:"birth_date"}),Ci.duration({title:"Total Working Time",dataIndex:"total_working_time"})]),qi=Object(c.map)(["Name","Started","Queued"],e=>({title:e,dataIndex:e.toLowerCase()})),Ti={loading:se.a.bool.isRequired,items:se.a.arrayOf(se.a.object).isRequired};function Ii(e){var t=e.loading,r=e.items;return n.a.createElement(Vn.a,{loading:t,columns:xi,rowKey:"name",dataSource:r,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function Di(e){var t=e.loading,r=e.items;return n.a.createElement(Vn.a,{loading:t,columns:qi,rowKey:"name",dataSource:r,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function Ri(e){var t=e.loading,r=e.items;return n.a.createElement(Vn.a,{loading:t,columns:_i,rowKey:"id",dataSource:r,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}function Mi(e){var t=e.loading,r=e.items;return n.a.createElement(Vn.a,{loading:t,columns:Ai,rowKey:"id",dataSource:r,pagination:{defaultPageSize:25,pageSizeOptions:["10","25","50"],showSizeChanger:!0}})}Ii.propTypes=Ti,Di.propTypes=Ti,Ri.propTypes=Ti,Mi.propTypes=Ti;var zi=["started"];function Fi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Li(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Li(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Li(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ui(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ui(Object(r),!0).forEach((function(t){Qi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ui(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Bi(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qi(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Wi extends n.a.Component{constructor(){super(...arguments),Qi(this,"state",{activeTab:R.hash,isLoading:!0,error:null,queueCounters:[],overallCounters:{started:0,queued:0},startedJobs:[],workers:[]}),Qi(this,"_refreshTimer",null),Qi(this,"refresh",()=>{K.get("/api/admin/queries/rq_status").then(e=>this.processQueues(e)).catch(e=>this.handleError(e)),this._refreshTimer=setTimeout(this.refresh,6e4)}),Qi(this,"processQueues",e=>{var t=e.queues,r=e.workers,a=Object(c.values)(t).map(e=>{var t=e.started,r=Bi(e,zi);return Vi({started:t.length},r)}),n=a.reduce((e,t)=>({started:e.started+t.started,queued:e.queued+t.queued}),{started:0,queued:0}),i=Object(c.flatMap)(Object(c.values)(t),e=>e.started.map(e=>Vi(Vi({},e),{},{enqueued_at:l.a.utc(e.enqueued_at),started_at:l.a.utc(e.started_at)})));this.setState({isLoading:!1,queueCounters:a,startedJobs:i,overallCounters:n,workers:r})}),Qi(this,"handleError",e=>{this.setState({isLoading:!1,error:e})})}componentDidMount(){vt("view","page","admin/rq_status"),this.refresh()}componentWillUnmount(){clearTimeout(this._refreshTimer),this.processQueues=()=>{},this.handleError=()=>{}}render(){var e=this.state,t=e.isLoading,r=e.error,a=e.queueCounters,i=e.startedJobs,s=e.overallCounters,o=e.workers,l=e.activeTab,u=Fi(Object(c.partition)(i,["name","redash.tasks.queries.execution.execute_query"]),2),d=u[0],m=u[1];return n.a.createElement(Rn,{activeTab:"jobs"},n.a.createElement("div",{className:"p-15"},r&&n.a.createElement(p.a,{type:"error",message:"Failed loading status. Please refresh."}),!r&&n.a.createElement(n.a.Fragment,null,n.a.createElement(In.Row,{gutter:15,className:"m-b-15"},n.a.createElement(In.Col,{span:8},n.a.createElement(ki,{title:"Started Jobs",value:s.started,loading:t})),n.a.createElement(In.Col,{span:8},n.a.createElement(ki,{title:"Queued Jobs",value:s.queued,loading:t}))),n.a.createElement(Tn.a,{activeKey:l||"queues",onTabClick:e=>{R.setHash(e),this.setState({activeTab:e})},animated:!1},n.a.createElement(Tn.a.TabPane,{key:"queues",tab:"Queues"},n.a.createElement(Di,{loading:t,items:a})),n.a.createElement(Tn.a.TabPane,{key:"workers",tab:"Workers"},n.a.createElement(Ii,{loading:t,items:o})),n.a.createElement(Tn.a.TabPane,{key:"queries",tab:"Queries"},n.a.createElement(Ri,{loading:t,items:d})),n.a.createElement(Tn.a.TabPane,{key:"other",tab:"Other Jobs"},n.a.createElement(Mi,{loading:t,items:m}))))))}}jn.register("Admin.Jobs",Ga({path:"/admin/queries/jobs",title:"RQ Status",render:e=>n.a.createElement(Wi,e)}));var Hi=r(142),Gi=r.n(Hi),Ki=r(244),Yi=r.n(Ki);function $i(e){var t=e.page,r=e.showPageSizeSelect,a=e.pageSize,i=e.onPageSizeChange,s=e.totalCount,o=e.onChange;return s<=(r?5:a)?null:n.a.createElement("div",{className:"paginator-container"},n.a.createElement(Yi.a,{showSizeChanger:r,pageSizeOptions:["5","10","20","50","100"],onShowSizeChange:(e,t)=>i(t),defaultCurrent:t,pageSize:a,total:s,onChange:o}))}$i.propTypes={page:se.a.number.isRequired,showPageSizeSelect:se.a.bool,pageSize:se.a.number.isRequired,totalCount:se.a.number.isRequired,onPageSizeChange:se.a.func,onChange:se.a.func},$i.defaultProps={showPageSizeSelect:!1,onChange:()=>{},onPageSizeChange:()=>{}};var Ji=r(20),Xi=r.n(Ji);function Zi(){return(Zi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function es(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ts(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ts(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function rs(e){var t=e.dialog,r=e.tags,i=e.getAvailableTags,s=es(Object(a.useState)([]),2),o=s[0],l=s[1],u=es(Object(a.useState)(!0),2),d=u[0],m=u[1],p=es(Object(a.useState)(()=>Object(c.uniq)(Object(c.map)(r,c.trim))),2),f=p[0],h=p[1],b=es(Object(a.useState)(null),2),g=b[0],y=b[1];return Object(a.useEffect)(()=>{g&&!d&&g.focus()},[g,d]),Object(a.useEffect)(()=>{var e=!1;return i().then(t=>{e||(l(Object(c.uniq)(Object(c.compact)(Object(c.map)(t,c.trim)))),m(!1))}),()=>{e=!0}},[i]),n.a.createElement(V.a,Zi({},t.props,{onOk:()=>t.close(f),title:"Add/Edit Tags",className:"shortModal",wrapProps:{"data-test":"EditTagsDialog"}}),n.a.createElement(Xi.a,{ref:y,mode:"tags",className:"w-100",placeholder:"Add some tags...",defaultValue:f,onChange:e=>h(Object(c.compact)(Object(c.map)(e,c.trim))),disabled:d,loading:d},Object(c.map)(o,e=>n.a.createElement(Xi.a.Option,{key:e},e))))}rs.propTypes={dialog:Je.isRequired,tags:se.a.arrayOf(se.a.string),getAvailableTags:se.a.func.isRequired},rs.defaultProps={tags:[]};var as=Xe(rs),ns=["isDraft","isArchived"];function is(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ss(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class os extends n.a.Component{constructor(){super(...arguments),ss(this,"editTags",(e,t)=>{as.showModal({tags:e,getAvailableTags:t}).onClose(this.props.onEdit)})}renderEditButton(){var e=Object(c.map)(this.props.tags,c.trim);return n.a.createElement(Ee,{className:"label label-tag hidden-xs",onClick:()=>this.editTags(e,this.props.getAvailableTags),"data-test":"EditTagsButton"},0===e.length&&n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"zmdi zmdi-plus m-r-5","aria-hidden":"true"}),"Add tag"),e.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"zmdi zmdi-edit","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Edit")))}render(){var e=this.props,t=e.tags,r=e.tagSeparator;return n.a.createElement("div",{className:"tags-control "+this.props.className,"data-test":"TagsControl"},this.props.children,Object(c.map)(t,(e,t)=>n.a.createElement(n.a.Fragment,{key:e},r&&t>0&&n.a.createElement("span",{className:"tag-separator"},r),n.a.createElement("span",{className:"label label-tag",key:e,title:e,"data-test":"TagLabel"},e))),this.props.canEdit&&this.renderEditButton(),this.props.tagsExtra)}}function ls(e){var t=e.archivedTooltip;function r(e){var r=e.isDraft,a=e.isArchived,i=is(e,ns);return n.a.createElement(os,i,!a&&r&&n.a.createElement("span",{className:"label label-tag-unpublished"},"Unpublished"),a&&n.a.createElement(Ne,{placement:"right",title:t},n.a.createElement("span",{className:"label label-tag-archived"},"Archived")))}return r.propTypes={isDraft:se.a.bool,isArchived:se.a.bool},r.defaultProps={isDraft:!1,isArchived:!1},r}ss(os,"propTypes",{tags:se.a.arrayOf(se.a.string),canEdit:se.a.bool,getAvailableTags:se.a.func,onEdit:se.a.func,className:se.a.string,tagsExtra:se.a.node,tagSeparator:se.a.node,children:se.a.node}),ss(os,"defaultProps",{tags:[],canEdit:!1,getAvailableTags:()=>Promise.resolve([]),onEdit:()=>{},className:"",tagsExtra:null,tagSeparator:null,children:null});var cs=ls({archivedTooltip:"This query is archived and can't be used in dashboards, or appear in search results."}),us=ls({archivedTooltip:"This dashboard is archived and won't be listed in dashboards nor search results."});function ds(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ms(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ms(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ms(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ps(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fs extends n.a.Component{get content(){var e=(this.props.schedule||fs.defaultProps.schedule).interval;if(!e)return["Never"];var t=hi(e,{omitSingleValueNumber:!0}),r="Every ".concat(t),a="Refreshes every ".concat(t),n=this.props.schedule,i=n.time,s=n.day_of_week;return i&&(a+=" at ".concat(mi(i))),s&&(a+=" on ".concat(s)),[r,a]}render(){if(this.props.isNew)return"Never";var e=ds(this.content,2),t=e[0],r=e[1],a=r?n.a.createElement(Ne,{title:r},t):t;return this.props.isLink?n.a.createElement(Ee,{type:"link",className:"schedule-phrase",onClick:this.props.onClick,"data-test":"EditSchedule"},a):a}}ps(fs,"propTypes",{schedule:Kn,isNew:se.a.bool.isRequired,isLink:se.a.bool,onClick:se.a.func}),ps(fs,"defaultProps",{schedule:Yn,isLink:!1,onClick:()=>{}});var hs=r(698),bs=r.n(hs),gs=["isLoaded","totalCount","pageItems","params"],ys=["children","onError"];function vs(){return(vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Os(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Es(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function js(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Es(Object(r),!0).forEach((function(t){ws(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Es(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ws(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ss=se.a.shape({params:se.a.object.isRequired,isLoaded:se.a.bool.isRequired,isEmpty:se.a.bool.isRequired,searchTerm:se.a.string,updateSearch:se.a.func.isRequired,selectedTags:se.a.array.isRequired,updateSelectedTags:se.a.func.isRequired,orderByField:se.a.string,orderByReverse:se.a.bool.isRequired,toggleSorting:se.a.func.isRequired,page:se.a.number.isRequired,itemsPerPage:se.a.number.isRequired,totalItemsCount:se.a.number.isRequired,pageSizeOptions:se.a.arrayOf(se.a.number).isRequired,pageItems:se.a.array.isRequired,updatePagination:se.a.func.isRequired,handleError:se.a.func.isRequired});function Ps(e,t,r){class a extends n.a.Component{constructor(e){super(e),ws(this,"_itemsSource",void 0);var a=r(),n=t();this._itemsSource=n,n.setState(js(js({},a.getState()),{},{validate:!1})),n.getCallbackContext=()=>this.state,n.onBeforeUpdate=()=>{var e=n.getState();a.setState(e),this.setState(this.getState(js(js({},e),{},{isLoaded:!1})))},n.onAfterUpdate=()=>{var e=n.getState();this.setState(this.getState(js(js({},e),{},{isLoaded:!0})))},n.onError=e=>this.props.onError(e);var i=this.getState(js(js({},n.getState()),{},{isLoaded:!1})),s=n.updatePagination,o=n.toggleSorting,l=n.updateSearch,u=n.updateSelectedTags,d=n.update,m=n.handleError;this.state=js(js({},i),{},{toggleSorting:o,updateSearch:Object(c.debounce)(l,200),updateSelectedTags:u,updatePagination:s,update:d,handleError:m})}componentDidMount(){this.state.update()}componentWillUnmount(){this._itemsSource.onBeforeUpdate=()=>{},this._itemsSource.onAfterUpdate=()=>{},this._itemsSource.onError=()=>{}}getState(e){var t=e.isLoaded,r=e.totalCount,a=e.pageItems,n=e.params;return js(js({},Os(e,gs)),{},{params:js(js({},n),Object(c.omit)(this.props,["onError","children"])),isLoaded:t,isEmpty:!t||0===r,totalItemsCount:r||0,pageSizeOptions:$.pageSizeOptions,pageItems:a||[]})}render(){var t=this.props,r=t.children,a=(t.onError,Os(t,ys));return n.a.createElement(e,vs({},a,{controller:this.state}),r)}}return ws(a,"propTypes",{onError:se.a.func,children:se.a.node}),ws(a,"defaultProps",{onError:e=>{setTimeout(()=>{throw e})},children:null}),bs()(a,e),a}function Cs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ns{get totalPages(){return Math.ceil(this.totalCount/this.itemsPerPage)}setPage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(c.isUndefined)(e)||(e=parseInt(e,10)||1,this.page=t?e>=1&&e<=this.totalPages?e:1:e>=1?e:1)}setItemsPerPage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(c.isUndefined)(e)||(e=parseInt(e,10)||20,this.itemsPerPage=e>=1?e:1,t&&this.setPage(this.page,t))}setTotalCount(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(c.isUndefined)(e)||(e=parseInt(e,10)||0,this.totalCount=e,t&&this.setPage(this.page,t))}constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=e.itemsPerPage,a=e.totalCount,n=e.validate,i=void 0===n||n;Cs(this,"page",1),Cs(this,"itemsPerPage",20),Cs(this,"totalCount",0),this.setItemsPerPage(r,i),this.setTotalCount(a,i),this.setPage(t,i)}getItemsForPage(e){var t=this.itemsPerPage*(this.page-1),r=t+this.itemsPerPage;return e.slice(t,r)}}function ks(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _s(e,t){return e?t?"-"+e:e:null}function As(e){var t=(e=Object(c.isString)(e)?e:"").startsWith("-");return t&&(e=e.substring(1)),{field:""!==e?e:null,reverse:t}}class xs{get compiled(){return _s(this.field,this.reverse)}set compiled(e){var t=As(e),r=t.field,a=t.reverse;this.field=r,this.reverse=a}setField(e){this.field=Object(c.isString)(e)&&""!==e?e:null}setReverse(e){this.reverse=!!e}constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.orderByField,r=e.orderByReverse,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;ks(this,"field",null),ks(this,"reverse",!1),ks(this,"sortByIteratees",null),this.setField(t),this.setReverse(r),this.sortByIteratees=a}toggleField(e){Object(c.isString)(e)&&""!==e&&(e===this.field?this.reverse=!this.reverse:(this.field=e,this.reverse=!1))}sort(e){if(this.field){var t=this.sortByIteratees&&this.sortByIteratees[this.field];return e=Object(c.sortBy)(e,t?[t]:this.field),this.reverse&&e.reverse(),e}}}r(1466);function qs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ts{_getRequest(e,t){return this._originalGetRequest({},t)}_processResults(e,t,r){var a=e.results,n=e.count;return{results:this._originalProcessResults(a,r),count:n}}constructor(e){var t=e.getRequest,r=e.doRequest,a=e.processResults;this._originalGetRequest=Object(c.isFunction)(t)?t:c.identity,this._originalDoRequest=r,this._originalProcessResults=Object(c.isFunction)(a)?a:c.identity}fetch(e,t,r){var a=this._getRequest(t,r);return this._originalDoRequest(a,r).then(e=>this._processResults(e,t,r))}}class Is extends Ts{constructor(){super(...arguments),qs(this,"_allItems",[])}_getRequest(e,t){var r=e.searchTerm,a=e.selectedTags;return this._originalGetRequest({q:Object(c.isString)(r)&&""!==r?r:void 0,tags:a},t)}_processResults(e,t,r){var a=t.paginator,n=t.sorter;return this._allItems=this._originalProcessResults(e,r),this._allItems=n.sort(this._allItems),{results:a.getItemsForPage(this._allItems),count:this._allItems.length,allResults:this._allItems}}fetch(e,t,r){if(Object(c.isNil)(e)||e.tags||e.sorting)return super.fetch(e,t,r);var a=t.paginator,n=t.sorter;return e.sorting&&(this._allItems=n.sort(this._allItems)),Promise.resolve({results:a.getItemsForPage(this._allItems),count:this._allItems.length,allResults:this._allItems})}}class Ds extends Ts{_getRequest(e,t){var r=e.paginator,a=e.sorter,n=e.searchTerm,i=e.selectedTags;return this._originalGetRequest({page:r.page,page_size:r.itemsPerPage,order:a.compiled,q:Object(c.isString)(n)&&""!==n?n:void 0,tags:i},t)}}var Rs=["getRequest","doRequest","processResults","isPlainList","sortByIteratees"],Ms=["getResource","getItemProcessor"];function zs(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(r),!0).forEach((function(t){Us(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Us(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Vs{_beforeUpdate(){return Object(c.isFunction)(this.onBeforeUpdate)?Promise.resolve(this.onBeforeUpdate(this.getState(),this.getCallbackContext())):Promise.resolve()}_afterUpdate(){return Object(c.isFunction)(this.onAfterUpdate)?Promise.resolve(this.onAfterUpdate(this.getState(),this.getCallbackContext())):Promise.resolve()}_changed(e){var t={paginator:this._paginator,sorter:this._sorter,searchTerm:this._searchTerm,selectedTags:this._selectedTags},r={},a=Ls(Ls({},this.getCallbackContext()),{},{setCustomParams:e=>{Object(c.extend)(r,e)}});return this._beforeUpdate().then(()=>{var n=Math.random().toString(36).substr(2);return this._currentFetchToken=n,this._fetcher.fetch(e,t,a).then(e=>{var t=e.results,a=e.count,i=e.allResults;if(this._currentFetchToken===n)return this._pageItems=t,this._allItems=i||null,this._paginator.setTotalCount(a),this._params=Ls(Ls({},this._params),r),this._afterUpdate()}).catch(e=>this.handleError(e))})}constructor(e){var t=e.getRequest,r=e.doRequest,a=e.processResults,n=e.isPlainList,i=void 0!==n&&n,s=e.sortByIteratees,o=void 0===s?void 0:s,l=zs(e,Rs);Us(this,"onBeforeUpdate",null),Us(this,"onAfterUpdate",null),Us(this,"onError",null),Us(this,"sortByIteratees",void 0),Us(this,"getCallbackContext",()=>null),Us(this,"updatePagination",e=>{var t=e.page,r=e.itemsPerPage,a=this._paginator,n=a.page,i=a.itemsPerPage;this._paginator.setItemsPerPage(r),this._paginator.setPage(t),this._changed({pagination:{page:n!==this._paginator.page,itemsPerPage:i!==this._paginator.itemsPerPage}})}),Us(this,"toggleSorting",e=>{this._sorter.toggleField(e),this._savedOrderByField=this._sorter.field,this._changed({sorting:!0})}),Us(this,"updateSearch",e=>{this._searchTerm=e,""===e?this._sorter.setField(this._savedOrderByField):this._sorter.setField(null),this._paginator.setPage(1),this._changed({search:!0,pagination:{page:!0}})}),Us(this,"updateSelectedTags",e=>{this._selectedTags=e,this._paginator.setPage(1),this._changed({tags:!0,pagination:{page:!0}})}),Us(this,"update",()=>this._changed()),Us(this,"handleError",e=>{Object(c.isFunction)(this.onError)&&this.onError(e)}),Object(c.isFunction)(t)||(t=c.identity),this._fetcher=i?new Is({getRequest:t,doRequest:r,processResults:a}):new Ds({getRequest:t,doRequest:r,processResults:a}),this.sortByIteratees=o,this.setState(l),this._pageItems=[],this._params={}}getState(){return{page:this._paginator.page,itemsPerPage:this._paginator.itemsPerPage,orderByField:this._sorter.field,orderByReverse:this._sorter.reverse,searchTerm:this._searchTerm,selectedTags:this._selectedTags,totalCount:this._paginator.totalCount,pageItems:this._pageItems,allItems:this._allItems,params:this._params}}setState(e){this._paginator=new Ns(e),this._sorter=new xs(e,this.sortByIteratees),this._searchTerm=e.searchTerm||"",this._selectedTags=e.selectedTags||[],this._savedOrderByField=this._sorter.field}}class Bs extends Vs{constructor(e){var t=e.getResource,r=e.getItemProcessor,a=zs(e,Ms);r=Object(c.isFunction)(r)?r:()=>null,super(Ls(Ls({},a),{},{doRequest:(e,r)=>t(r)(e),processResults:(e,t)=>{var a=r(t);return a=Object(c.isFunction)(a)?a:c.identity,Object(c.map)(e,e=>a(e,t))}}))}}function Qs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ws(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hs{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._state=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qs(Object(r),!0).forEach((function(t){Ws(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)}getState(){return Object(c.defaults)(this._state,{page:1,itemsPerPage:$.pageSize,orderByField:"created_at",orderByReverse:!1,searchTerm:"",tags:[]})}setState(){}}class Gs extends Hs{getState(){var e=super.getState(),t=R.search,r=t.q||"",a=""!==r?"":_s(e.orderByField,e.orderByReverse),n=As(t.order||a),i=n.field,s=n.reverse;return{page:parseInt(t.page,10)||e.page,itemsPerPage:parseInt(t.page_size,10)||e.itemsPerPage,orderByField:i,orderByReverse:s,searchTerm:r}}setState(e){var t=e.page,r=e.itemsPerPage,a=e.orderByField,n=e.orderByReverse,i=e.searchTerm;R.setSearch({page:t,page_size:r,order:_s(a,n),q:""!==i?i:null},!0)}}function Ks(){return(Ks=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ys(e){return n.a.createElement("div",{className:"text-center"},n.a.createElement(Ie,Ks({icon:"fa-spinner fa-2x fa-pulse",message:"Loading..."},e)))}function $s(){return($s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Js(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Xs extends n.a.Component{constructor(){var e;super(...arguments),e=this,Js(this,"listColumns",[{title:"ID",field:"id",width:"1%",align:"right",sorter:!0},Ci.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(S,{className:"table-main-title",href:"queries/"+t.id},t.name),n.a.createElement(cs,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:"Name",field:"name",width:null}),Ci.avatar({field:"user",className:"p-l-0 p-r-0"},e=>"Created by ".concat(e)),Ci.dateTime.sortable({title:"Created At",field:"created_at"}),Ci.duration.sortable({title:"Runtime",field:"runtime"}),Ci.dateTime.sortable({title:"Last Executed At",field:"retrieved_at",orderByField:"executed_at"}),Ci.custom.sortable((e,t)=>n.a.createElement(fs,{schedule:t.schedule,isNew:t.isNew()}),{title:"Update Schedule",field:"schedule"})]),Js(this,"state",{autoUpdate:!0}),Js(this,"_updateTimer",null),Js(this,"autoUpdateSwitchId",Object(c.uniqueId)("auto-update-switch")),Js(this,"update",(function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&e.state.autoUpdate&&e.props.controller.update(),e._updateTimer=setTimeout(e.update,6e4)}))}componentDidMount(){vt("view","page","admin/queries/outdated"),this.update(!0)}componentWillUnmount(){clearTimeout(this._updateTimer)}render(){var e=this.props.controller;return n.a.createElement(Rn,{activeTab:e.params.currentPage},n.a.createElement("div",{className:"m-15"},n.a.createElement("div",null,n.a.createElement("label",{htmlFor:this.autoUpdateSwitchId,className:"m-0"},"Auto update"),n.a.createElement(Gi.a,{id:this.autoUpdateSwitchId,className:"m-l-10",checked:this.state.autoUpdate,onChange:e=>this.setState({autoUpdate:e})})),e.params.lastUpdatedAt&&n.a.createElement("div",{className:"m-t-5"},"Last updated: ",n.a.createElement(ii,{date:1e3*e.params.lastUpdatedAt}))),!e.isLoaded&&n.a.createElement(Ys,null),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center p-15"},"There are no outdated queries."),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}Js(Xs,"propTypes",{controller:Ss.isRequired});var Zs=Ps(Xs,()=>new Vs({doRequest:(e,t)=>K.get("/api/admin/queries/outdated").then(e=>{var r=e.queries,a=e.updated_at;return t.setCustomParams({lastUpdatedAt:parseFloat(a)}),r}),processResults:e=>Object(c.map)(e,e=>new ir(e)),isPlainList:!0}),()=>new Hs({orderByField:"created_at",orderByReverse:!0}));jn.register("Admin.OutdatedQueries",Ga({path:"/admin/queries/outdated",title:"Outdated Queries",render:e=>n.a.createElement(Zs,$s({},e,{currentPage:"outdated_queries"}))}));var eo=r(59),to=r.n(eo);function ro(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ao(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ao(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function no(e){var t=e.info;return t=Object(c.toPairs)(t),n.a.createElement(en.a,{title:"General",size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},"No data"),t.length>0&&n.a.createElement(to.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=ro(e,2),r=t[0],a=t[1];return n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},a)},bi(r))}}))}function io(e){var t=e.info;return n.a.createElement(en.a,{title:"Redash Database",size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},"No data"),t.length>0&&n.a.createElement(to.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=ro(e,2),r=t[0],a=t[1];return n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},vi(a))},r)}}))}function so(e){var t=e.info;return t=Object(c.toPairs)(t),n.a.createElement(en.a,{title:"Queues",size:"small"},0===t.length&&n.a.createElement("div",{className:"text-muted text-center"},"No data"),t.length>0&&n.a.createElement(to.a,{size:"small",itemLayout:"vertical",dataSource:t,renderItem:e=>{var t=ro(e,2),r=t[0],a=t[1];return n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},a.size)},r)}}))}function oo(e){var t=e.info,r=t?[n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},n.a.createElement(ii,{date:t.lastRefreshAt,placeholder:"n/a"}))},"Last Refresh"),n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},n.a.createElement(ii,{date:t.startedAt,placeholder:"n/a"}))},"Started"),n.a.createElement(to.a.Item,{extra:n.a.createElement("span",{className:"badge"},t.outdatedQueriesCount)},"Outdated Queries Count")]:[];return n.a.createElement(en.a,{title:"Manager",size:"small"},!t&&n.a.createElement("div",{className:"text-muted text-center"},"No data"),t&&n.a.createElement(to.a,{size:"small",itemLayout:"vertical",dataSource:r,renderItem:e=>e}))}function lo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class co extends n.a.Component{constructor(){super(...arguments),lo(this,"state",{queues:[],manager:null,databaseMetrics:{},status:{}}),lo(this,"_refreshTimer",null),lo(this,"refresh",()=>{K.get("/status.json").then(e=>{this.setState({queues:e.manager.queues,manager:{startedAt:1e3*e.manager.started_at,lastRefreshAt:1e3*e.manager.last_refresh_at,outdatedQueriesCount:e.manager.outdated_queries_count},databaseMetrics:e.database_metrics.metrics||[],status:Object(c.omit)(e,["workers","manager","database_metrics"])})}).catch(e=>this.props.onError(e)),this._refreshTimer=setTimeout(this.refresh,6e4)})}componentDidMount(){vt("view","page","admin/status"),this.refresh()}componentWillUnmount(){clearTimeout(this._refreshTimer)}render(){return n.a.createElement(Rn,{activeTab:"system_status"},n.a.createElement("div",{className:"system-status-page"},n.a.createElement("div",{className:"system-status-page-blocks"},n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(no,{info:this.state.status})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(oo,{info:this.state.manager})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(so,{info:this.state.queues})),n.a.createElement("div",{className:"system-status-page-block"},n.a.createElement(io,{info:this.state.databaseMetrics})))))}}function uo(){return(uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}lo(co,"propTypes",{onError:se.a.func}),lo(co,"defaultProps",{onError:()=>{}}),jn.register("Admin.SystemStatus",Ga({path:"/admin/status",title:"System Status",render:e=>n.a.createElement(co,e)}));var mo={"greater than":">","less than":"<",equals:"="},po=e=>Object(c.merge)({},e,{options:{op:mo[e.options.op]||e.options.op}}),fo={query:()=>K.get("api/alerts"),get:e=>{var t=e.id;return K.get("api/alerts/".concat(t)).then(po)},save:e=>K.post((e=>e.id?"api/alerts/".concat(e.id):"api/alerts")(e),(e=>{var t=uo({},e);return void 0===t.query_id&&(t.query_id=t.query.id,t.destination_id=t.destinations,delete t.query,delete t.destinations),t})(e)),delete:e=>K.delete("api/alerts/".concat(e.id)),mute:e=>K.post("api/alerts/".concat(e.id,"/mute")),unmute:e=>K.delete("api/alerts/".concat(e.id,"/mute"))};function ho(){return(ho=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function bo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var go={unknown:"label-warning",ok:"label-success",triggered:"label-danger"};class yo extends n.a.Component{constructor(){super(...arguments),bo(this,"listColumns",[Ci.custom.sortable((e,t)=>n.a.createElement("span",{title:t.options.muted?"Muted":"Active"},n.a.createElement("i",{className:"fa fa-bell-".concat(t.options.muted?"slash":"o"," p-r-0"),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},t.options.muted?"Muted":"Active")),{title:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-bell p-r-0","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Sort by notification status.")),field:"muted",width:"1%"}),Ci.custom.sortable((e,t)=>n.a.createElement("div",null,n.a.createElement(S,{className:"table-main-title",href:"alerts/"+t.id},t.name)),{title:"Name",field:"name"}),Ci.custom((e,t)=>t.user.name,{title:"Created By",width:"1%"}),Ci.custom.sortable((e,t)=>n.a.createElement("div",null,n.a.createElement("span",{className:"label ".concat(go[t.state])},Object(c.toUpper)(t.state))),{title:"State",field:"state",width:"1%",className:"text-nowrap"}),Ci.timeAgo.sortable({title:"Last Updated At",field:"updated_at",width:"1%"}),Ci.dateTime.sortable({title:"Created At",field:"created_at",width:"1%"})])}render(){var e=this.props.controller;return n.a.createElement("div",{className:"page-alerts-list"},n.a.createElement("div",{className:"container"},n.a.createElement(Dn,{title:e.params.pageTitle,actions:Y.hasPermission("list_alerts")?n.a.createElement(S.Button,{block:!0,type:"primary",href:"alerts/new"},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Alert"):null}),n.a.createElement("div",null,e.isLoaded&&e.isEmpty?n.a.createElement(pe,{name:"AlertsList.EmptyState"},n.a.createElement(Xa,{icon:"fa fa-bell-o",illustration:"alert",description:"Get notified on certain events",helpMessage:n.a.createElement($a,{helpTriggerType:"ALERTS"}),showAlertStep:!0})):n.a.createElement("div",{className:"table-responsive bg-white tiled"},n.a.createElement(Ni,{loading:!e.isLoaded,items:e.pageItems,columns:this.listColumns,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}bo(yo,"propTypes",{controller:Ss.isRequired});var vo=Ps(yo,()=>new Bs({isPlainList:!0,getRequest:()=>({}),getResource:()=>fo.query.bind(fo)}),()=>new Hs({orderByField:"created_at",orderByReverse:!0,itemsPerPage:20}));jn.register("Alerts.List",Ga({path:"/alerts",title:"Alerts",render:e=>n.a.createElement(vo,ho({},e,{currentPage:"alerts"}))}));var Oo=r(124),Eo=r.n(Oo);function jo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function So(e){var t=e.doDelete,r=e.canEdit,i=e.mute,s=e.unmute,o=e.muted,l=jo(Object(a.useState)(!1),2),c=l[0],u=l[1],d=Object(a.useCallback)(e=>{u(!0),e().finally(()=>{u(!1)})},[]),m=Object(a.useCallback)(()=>{V.a.confirm({title:"Delete Alert",content:"Are you sure you want to delete this alert?",okText:"Delete",okType:"danger",onOk:()=>{u(!0),t().catch(()=>{u(!1)})},maskClosable:!0,autoFocusButton:null})},[t]);return n.a.createElement(Da.a,{className:ge()("m-l-5",{disabled:!r}),trigger:[r?"click":void 0],placement:"bottomRight",overlay:n.a.createElement(he.a,null,n.a.createElement(he.a.Item,null,o?n.a.createElement(Ee,{onClick:()=>d(s)},"Unmute Notifications"):n.a.createElement(Ee,{onClick:()=>d(i)},"Mute Notifications")),n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:m},"Delete")))},n.a.createElement(h.a,{"aria-label":"More actions"},c?n.a.createElement(Sn.a,null):n.a.createElement(Eo.a,{rotate:90,"aria-hidden":"true"})))}So.propTypes={doDelete:se.a.func.isRequired,canEdit:se.a.bool.isRequired,mute:se.a.func.isRequired,unmute:se.a.func.isRequired,muted:se.a.bool},So.defaultProps={muted:!1};var Po=r(25),Co=r.n(Po);function No(e){var t=e.alert,r=e.editMode,a=e.name,i=e.onChange,s=e.children,o=Ql(t);return n.a.createElement("div",{className:"alert-header"},n.a.createElement("div",{className:"alert-title"},n.a.createElement("h3",null,r&&t.query?n.a.createElement(He.a,{className:"f-inherit",placeholder:o,value:a,"aria-label":"Alert title",onChange:e=>i(e.target.value)}):a||o)),n.a.createElement("div",{className:"alert-actions"},s))}No.propTypes={alert:ei.isRequired,name:se.a.string,children:se.a.node,onChange:se.a.func,editMode:se.a.bool},No.defaultProps={name:null,children:null,onChange:null,editMode:!1};var ko=r(206),_o=r.n(ko),Ao=r(128),xo=r.n(Ao),qo={">":">",">=":"≥","<":"<","<=":"≤","==":"=","!=":"≠"},To=["==","!="];function Io(e){var t=e.children,r=e.minWidth;return n.a.createElement("div",{className:"criteria-disabled-input",style:{minWidth:r}},t)}function Do(e){var t=e.columnNames,r=e.resultValues,a=e.alertOptions,i=e.onChange,s=e.editMode,o=Object(c.isEmpty)(r)?null:Object(c.head)(r)[a.column],l=Object(c.includes)(To,a.op)?null:isNaN(a.value)?"Value column type doesn't match threshold type.":isNaN(o)?"Value column isn't supported by condition type.":null,u=n.a.createElement("small",{className:"alert-criteria-hint"},"Top row value is ",n.a.createElement("code",{className:"p-0"},Object(c.toString)(o)||"unknown"));return n.a.createElement("div",{"data-test":"Criteria"},n.a.createElement("div",{className:"input-title"},n.a.createElement("span",{className:"input-label"},"Value column"),s?n.a.createElement(Xi.a,{value:a.column,onChange:e=>i({column:e}),dropdownMatchSelectWidth:!1,style:{minWidth:100}},t.map(e=>n.a.createElement(Xi.a.Option,{key:e},e))):n.a.createElement(Io,{minWidth:70},a.column)),n.a.createElement("div",{className:"input-title"},n.a.createElement("span",{className:"input-label"},"Condition"),s?n.a.createElement(Xi.a,{value:a.op,onChange:e=>i({op:e}),optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:55}},n.a.createElement(Xi.a.Option,{value:">",label:qo[">"]},qo[">"]," greater than"),n.a.createElement(Xi.a.Option,{value:">=",label:qo[">="]},qo[">="]," greater than or equals"),n.a.createElement(Xi.a.Option,{disabled:!0,key:"dv1"},n.a.createElement(xo.a,{className:"select-option-divider m-t-10 m-b-5"})),n.a.createElement(Xi.a.Option,{value:"<",label:qo["<"]},qo["<"]," less than"),n.a.createElement(Xi.a.Option,{value:"<=",label:qo["<="]},qo["<="]," less than or equals"),n.a.createElement(Xi.a.Option,{disabled:!0,key:"dv2"},n.a.createElement(xo.a,{className:"select-option-divider m-t-10 m-b-5"})),n.a.createElement(Xi.a.Option,{value:"==",label:qo["=="]},qo["=="]," equals"),n.a.createElement(Xi.a.Option,{value:"!=",label:qo["!="]},qo["!="]," not equal to")):n.a.createElement(Io,{minWidth:50},qo[a.op])),n.a.createElement("div",{className:"input-title"},n.a.createElement("label",{className:"input-label",htmlFor:"threshold-criterion"},"Threshold"),s?n.a.createElement(He.a,{id:"threshold-criterion",style:{width:90},value:a.value,onChange:e=>i({value:e.target.value})}):n.a.createElement(Io,{minWidth:50},a.value)),n.a.createElement("div",{className:"ant-form-item-explain"},u,n.a.createElement("br",null),l&&n.a.createElement("small",null,n.a.createElement(_o.a,{className:"warning-icon-danger"})," ",l)))}Io.propTypes={children:se.a.node.isRequired,minWidth:se.a.number.isRequired},Do.propTypes={columnNames:se.a.arrayOf(se.a.string).isRequired,resultValues:se.a.arrayOf(se.a.object).isRequired,alertOptions:Zn.isRequired,onChange:se.a.func,editMode:se.a.bool},Do.defaultProps={onChange:()=>{},editMode:!1};var Ro=r(126),Mo=r.n(Ro),zo=["editMode"];function Fo(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Lo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Uo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Vo=[["Second",1],["Minute",60],["Hour",3600],["Day",86400],["Week",604800]];function Bo(e){var t=e.value,r=e.onChange,i=e.editMode,s=Lo(Object(a.useState)(),2),o=s[0],l=s[1],u=Lo(Object(a.useState)(),2),d=u[0],m=u[1];if(Object(a.useEffect)(()=>{for(var e=Vo.length-1;e>=0;e-=1){var r=Lo(Vo[e],2)[1];if(t%r==0){l(e),m(t/r);break}}},[t]),!Object(c.isNumber)(d)||!Object(c.isNumber)(o))return null;var p=1!==d?"s":"";if(i)return n.a.createElement(n.a.Fragment,null,n.a.createElement(Mo.a,{value:d,onChange:e=>{m(e),r(e*Vo[o][1])},min:1,precision:0}),n.a.createElement(Xi.a,{value:o,onChange:e=>{l(e),r(d*Vo[e][1])}},Vo.map((e,t)=>{var r=Lo(e,1)[0];return n.a.createElement(Xi.a.Option,{value:t,key:r},r,p)})));var f=Lo(Vo[o],1)[0];return d+" "+Object(c.toLower)(f)+p}function Qo(e){var t=e.value,r=e.onChange,i=Lo(Object(a.useState)(t<2?t:2),2),s=i[0],o=i[1];return n.a.createElement("div",{className:"alert-rearm"},n.a.createElement(Xi.a,{optionLabelProp:"label",defaultValue:s||0,dropdownMatchSelectWidth:!1,onChange:e=>{o(e),r(e<2?e:3600)}},n.a.createElement(Xi.a.Option,{value:0,label:"Just once"},"Just once ",n.a.createElement("em",null,"until back to normal")),n.a.createElement(Xi.a.Option,{value:1,label:"Each time alert is evaluated"},"Each time alert is evaluated ",n.a.createElement("em",null,"until back to normal")),n.a.createElement(Xi.a.Option,{value:2,label:"At most every"},"At most every ... ",n.a.createElement("em",null,"when alert is evaluated"))),2===s&&t&&n.a.createElement(Bo,{value:t,onChange:r,editMode:!0}))}function Wo(e){var t=e.value,r="";switch(t){case 0:r="just once, until back to normal";break;case 1:r="each time alert is evaluated, until back to normal";break;default:r=n.a.createElement(n.a.Fragment,null,"at most every ",n.a.createElement(Bo,{value:t,editMode:!1}),", when alert is evaluated")}return n.a.createElement("span",null,"Notifications are sent ",r,".")}function Ho(e){var t=e.editMode,r=Fo(e,zo);return t?n.a.createElement(Qo,r):n.a.createElement(Wo,r)}Bo.propTypes={onChange:se.a.func,value:se.a.number.isRequired,editMode:se.a.bool.isRequired},Bo.defaultProps={onChange:()=>{}},Qo.propTypes={onChange:se.a.func.isRequired,value:se.a.number.isRequired},Wo.propTypes={value:se.a.number.isRequired},Ho.propTypes={onChange:se.a.func,value:se.a.number.isRequired,editMode:se.a.bool},Ho.defaultProps={onChange:null,editMode:!1};var Go=r(1803);function Ko(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function $o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.initialResults,n=void 0===r?null:r,i=t.debounceTimeout,s=void 0===i?200:i,o=Object(a.useState)(n),l=Ko(o,2),c=l[0],u=l[1],d=Object(a.useState)(!1),m=Ko(d,2),p=m[0],f=m[1],h=Object(a.useRef)(null),b=Object(a.useRef)(!1),g=Object(Go.a)(t=>{f(!0),h.current=t,e(t).catch(()=>n).then(e=>{t!==h.current||b.current||(u(e),f(!1))})},s),y=Ko(g,1),v=y[0];return Object(a.useEffect)(()=>()=>{b.current=!0},[]),[v,c,p]}function Jo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Zo=Xi.a.Option;function el(e){return null===e?Promise.resolve(null):e?ir.query({q:e}).then(e=>e.results):ir.recent().then(e=>e.filter(e=>!e.is_draft))}function tl(e){var t=Jo(Object(a.useState)(""),2),r=t[0],i=t[1],s=Jo(Object(a.useState)(),2),o=s[0],l=s[1],u=Jo($o(el,{initialResults:[]}),3),d=u[0],m=u[1],p=u[2],f="Search a query by name",h=n.a.createElement("i",{className:"fa fa-times hide-in-percy",role:"button",tabIndex:0,"aria-label":"Clear",onClick:()=>g(null)}),b=n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:ge()("fa fa-spinner fa-pulse hide-in-percy",{hidden:!p}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Searching..."));function g(t){var r=null;t&&((r=Object(c.find)(m,{id:t}))||un.error("Something went wrong...","Couldn't select query")),i(r?null:""),l(r),e.onChange(r)}if(Object(a.useEffect)(()=>{d(r)},[d,r]),Object(a.useEffect)(()=>{e.selectedQuery&&l(e.selectedQuery)},[e.selectedQuery]),e.disabled)return n.a.createElement(He.a,{value:o&&o.name,"aria-label":"Tied query",placeholder:f,disabled:!0});if("select"===e.type){var y=o?h:null,v=o?o.name:r;return n.a.createElement(Xi.a,{showSearch:!0,dropdownMatchSelectWidth:!1,placeholder:f,value:v||void 0,onSearch:i,onChange:g,suffixIcon:p?b:y,notFoundContent:null,filterOption:!1,defaultActiveFirstOption:!1,className:e.className,"data-test":"QuerySelector"},m&&m.map(e=>{var t=e.is_draft;return n.a.createElement(Zo,{value:e.id,key:e.id,disabled:t,className:"query-selector-result","data-test":"QueryId".concat(e.id)},e.name," ",n.a.createElement(cs,{isDraft:e.is_draft,tags:e.tags,className:ge()("inline-tags-control",{disabled:t})}))}))}return n.a.createElement("span",{"data-test":"QuerySelector"},o?n.a.createElement(He.a,{value:o.name,"aria-label":"Tied query",suffix:h,readOnly:!0}):n.a.createElement(He.a,{placeholder:f,value:r,"aria-label":"Tied query",onChange:e=>i(e.target.value),suffix:b}),n.a.createElement("div",{className:"scrollbox",style:{maxHeight:"50vh",marginTop:15}},m&&(m.length?n.a.createElement("ul",{className:"list-group"},m.map(e=>n.a.createElement(Ee,{className:ge()("query-selector-result","list-group-item",{inactive:e.is_draft}),key:e.id,role:"listitem",onClick:()=>g(e.id),"data-test":"QueryId".concat(e.id)},e.name," ",n.a.createElement(cs,{isDraft:e.is_draft,tags:e.tags,className:"inline-tags-control"})))):n.a.createElement("div",{className:"text-muted"},"No results matching search term."))))}tl.propTypes={onChange:se.a.func.isRequired,selectedQuery:se.a.object,type:se.a.oneOf(["select","default"]),className:se.a.string,disabled:se.a.bool},tl.defaultProps={selectedQuery:null,type:"default",className:null,disabled:!1};var rl=r(699),al=r.n(rl);function nl(e){var t=e.query,r=e.queryResult,a=e.onChange,i=e.editMode,s=t&&t.schedule?n.a.createElement("small",null,"Scheduled to refresh"," ",n.a.createElement("i",{className:"alert-query-schedule"},n.a.createElement(fs,{schedule:t.schedule,isNew:!1}))):n.a.createElement("small",null,n.a.createElement(_o.a,{className:"warning-icon-danger"})," This query has no ",n.a.createElement("i",null,"refresh schedule"),"."," ",n.a.createElement(Ne,{title:"A query schedule is not necessary but is highly recommended for alerts. An Alert without a query schedule will only send notifications if a user in your organization manually executes this query."},n.a.createElement("a",{role:"presentation"},"Why it's recommended ",n.a.createElement(al.a,null))));return n.a.createElement(n.a.Fragment,null,i?n.a.createElement(tl,{onChange:a,selectedQuery:t,className:"alert-query-selector",type:"select"}):n.a.createElement(Ne,{title:"Open query in a new tab."},n.a.createElement(S,{href:"queries/".concat(t.id),target:"_blank",rel:"noopener noreferrer",className:"alert-query-link"},t.name," ",n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))),n.a.createElement("div",{className:"ant-form-item-explain"},t&&s),t&&!r&&n.a.createElement("div",{className:"m-t-30"},n.a.createElement(Sn.a,{className:"m-r-5"})," Loading query data"))}function il(){return(il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function sl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ol(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ol(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ol(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ll(e){var t=e.items,r=e.renderItem,i=e.onItemClick,s=Object(a.useCallback)(e=>{var t=r(e),a=t.content,s=t.className,o=t.isDisabled;return n.a.createElement(to.a.Item,{className:ge()("select-items-list","w-100","p-l-10","p-r-10",{disabled:o},s),onClick:o?null:()=>i(e)},a)},[r,i]);return n.a.createElement(to.a,{size:"small",dataSource:t,renderItem:s})}function cl(e){var t=e.dialog,r=e.dialogTitle,i=e.inputPlaceholder,s=e.itemKey,o=e.renderItem,l=e.renderStagedItem,u=e.searchItems,d=e.selectedItemsTitle,m=e.width,p=e.showCount,f=e.extraFooterContent,b=sl(Object(a.useState)([]),2),g=b[0],y=b[1],v=sl($o(u,{initialResults:[]}),3),O=v[0],E=v[1],j=v[2],w=E.length>0;Object(a.useEffect)(()=>{O()},[O]);var S=Object(a.useCallback)(e=>{var t=s(e);return!!Object(c.find)(g,e=>s(e)===t)},[g,s]),P=Object(a.useCallback)(e=>{if(S(e)){var t=s(e);y(Object(c.filter)(g,e=>s(e)!==t))}else y([...g,e])},[g,s,S]),C=Object(a.useCallback)(()=>{t.close(g).catch(e=>{e&&un.error("Failed to save some of selected items.")})},[t,g]);return n.a.createElement(V.a,il({},t.props,{className:"select-items-dialog",width:m,title:r,footer:n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("span",{className:"flex-fill m-r-5",style:{textAlign:"left",color:"rgba(0, 0, 0, 0.5)"}},f),n.a.createElement(h.a,il({},t.props.cancelButtonProps,{onClick:t.dismiss}),"Cancel"),n.a.createElement(h.a,il({},t.props.okButtonProps,{onClick:C,disabled:0===g.length||t.props.okButtonProps.disabled,type:"primary"}),"Save",p&&!Object(c.isEmpty)(g)?" (".concat(Object(c.size)(g),")"):null))}),n.a.createElement("div",{className:"d-flex align-items-center m-b-10"},n.a.createElement("div",{className:"flex-fill"},n.a.createElement(He.a.Search,{onChange:e=>O(e.target.value),placeholder:i,"aria-label":i,autoFocus:!0})),l&&n.a.createElement("div",{className:"w-50 m-l-20"},n.a.createElement("h5",{className:"m-0"},d))),n.a.createElement("div",{className:"d-flex align-items-stretch",style:{minHeight:"30vh",maxHeight:"50vh"}},n.a.createElement("div",{className:"flex-fill scrollbox"},j&&n.a.createElement(Ys,{className:""}),!j&&!w&&n.a.createElement(Ie,{icon:"fa-search",message:"No items match your search.",className:""}),!j&&w&&n.a.createElement(ll,{items:E,renderItem:e=>o(e,{isSelected:S(e)}),onItemClick:P})),l&&n.a.createElement("div",{className:"w-50 m-l-20 scrollbox"},g.length>0&&n.a.createElement(ll,{items:g,renderItem:e=>l(e,{isSelected:!0}),onItemClick:P}))))}nl.propTypes={query:Xn,queryResult:se.a.object,onChange:se.a.func,editMode:se.a.bool},nl.defaultProps={query:null,queryResult:null,onChange:()=>{},editMode:!1},ll.propTypes={items:se.a.array,renderItem:se.a.func,onItemClick:se.a.func},ll.defaultProps={items:[],renderItem:()=>{},onItemClick:()=>{}},cl.propTypes={dialog:Je.isRequired,dialogTitle:se.a.string,inputPlaceholder:se.a.string,selectedItemsTitle:se.a.string,searchItems:se.a.func.isRequired,itemKey:se.a.func,renderItem:se.a.func,renderStagedItem:se.a.func,width:se.a.oneOfType([se.a.string,se.a.number]),extraFooterContent:se.a.node,showCount:se.a.bool},cl.defaultProps={dialogTitle:"Add Items",inputPlaceholder:"Search...",selectedItemsTitle:"Selected items",itemKey:e=>e.id,renderItem:()=>"",renderStagedItem:null,width:"80%",extraFooterContent:null,showCount:!1};var ul=Xe(cl),dl="static/images/destinations",ml={query:()=>K.get("api/destinations"),get:e=>{var t=e.id;return K.get("api/destinations/".concat(t))},types:()=>K.get("api/destinations/types"),create:e=>K.post("api/destinations",e),save:e=>K.post("api/destinations/".concat(e.id),e),delete:e=>{var t=e.id;return K.delete("api/destinations/".concat(t))}},pl={query:e=>{var t=e.alertId;return K.get("api/alerts/".concat(t,"/subscriptions"))},create:e=>K.post("api/alerts/".concat(e.alert_id,"/subscriptions"),e),delete:e=>K.delete("api/alerts/".concat(e.alert_id,"/subscriptions/").concat(e.id))};function fl(e){var t=e.isSelected,r=e.isStaged,a=e.alreadyInGroup,i=e.deselectedIcon;return r?n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-remove","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Remove")):a?n.a.createElement(Ne,{title:"Already selected"},n.a.createElement("span",{tabIndex:0},n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Already selected"))):t?n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Selected")):n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa ".concat(i),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Select"))}function hl(e){var t=e.featureName,r=e.className,a=e.mode,i=e.adminOnly,s=qe("sr-mail-description");if(!$.mailSettingsMissing)return null;if(i&&!Y.isAdmin)return null;var o=n.a.createElement("span",{id:s},"Your mail server isn't configured correctly, and is needed for ",t," to work."," ",n.a.createElement(Qe,{type:"MAIL_CONFIG",className:"f-inherit"}));return"icon"===a?n.a.createElement(Ne,{title:o,placement:"topRight",arrowPointAtCenter:!0},n.a.createElement("span",{className:r,"aria-label":"Mail alert","aria-describedby":s,tabIndex:0},n.a.createElement("i",{className:"fa fa-exclamation-triangle","aria-hidden":"true"}))):n.a.createElement(p.a,{message:o,type:"error",className:r})}function bl(){return(bl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function gl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}fl.propTypes={isSelected:se.a.bool,isStaged:se.a.bool,alreadyInGroup:se.a.bool,deselectedIcon:se.a.string},fl.defaultProps={isSelected:!1,isStaged:!1,alreadyInGroup:!1,deselectedIcon:"fa-angle-double-right"},hl.propTypes={featureName:se.a.string.isRequired,className:se.a.string,mode:se.a.oneOf(["alert","icon"]),adminOnly:se.a.bool},hl.defaultProps={className:null,mode:"alert",adminOnly:!1};function Ol(e){return e.destination||(e.destination={id:-1,name:e.user.email,icon:"DEPRECATED",type:"email"}),e}function El(e){var t=e.destination,r=t.name,a=t.type,i=e.user,s=e.unsubscribe,o=Y.isAdmin||Y.id===i.id;return n.a.createElement("li",{className:"destination-wrapper"},n.a.createElement("img",{src:"".concat(dl,"/").concat(a,".png"),className:"destination-icon",alt:r}),n.a.createElement("span",{className:"flex-fill"},r),"email"===a&&n.a.createElement(hl,{className:"destination-warning",featureName:"alert emails",mode:"icon"}),o&&n.a.createElement(Ne,{title:"Remove",mouseEnterDelay:.5},n.a.createElement(Ee,{className:"remove-button",onClick:s},n.a.createElement(xe.a,null))))}El.propTypes={destination:Jn.isRequired,user:$n.isRequired,unsubscribe:se.a.func.isRequired};class jl extends n.a.Component{constructor(){super(...arguments),vl(this,"state",{dests:[],subs:null}),vl(this,"showAddAlertSubDialog",()=>{var e=this.state,t=e.dests,r=e.subs;ul.showModal({width:570,showCount:!0,extraFooterContent:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-info-circle","aria-hidden":"true"})," Create new destinations in"," ",n.a.createElement(Ne,{title:"Opens page in a new tab."},n.a.createElement(S,{href:"destinations/new",target:"_blank"},"Alert Destinations"))),dialogTitle:"Add Existing Alert Destinations",inputPlaceholder:"Search destinations...",searchItems:e=>(e=Object(c.toLower)(e),Promise.resolve(t.filter(t=>Object(c.includes)(Object(c.toLower)(t.name),e)))),renderItem:(e,t)=>{var a=t.isSelected,i=!!Object(c.find)(r,t=>t.destination.id===e.id);return{content:n.a.createElement("div",{className:"destination-wrapper"},n.a.createElement("img",{src:"".concat(dl,"/").concat(e.type,".png"),className:"destination-icon",alt:e.name}),n.a.createElement("span",{className:"flex-fill"},e.name),n.a.createElement(fl,{isSelected:a,alreadyInGroup:i,deselectedIcon:"fa-plus"})),isDisabled:i,className:a||i?"selected":""}}}).onClose(e=>{var t=Object(c.map)(e,e=>this.subscribe(e));return Promise.all(t).then(()=>{un.success("Subscribed.")}).catch(()=>(un.error("Failed saving subscription."),Promise.reject(null)))})}),vl(this,"onUserEmailToggle",e=>{e?this.unsubscribe(e):this.subscribe()}),vl(this,"subscribe",e=>{var t={alert_id:this.props.alertId};return e&&(t.destination_id=e.id),pl.create(t).then(e=>{var t=this.state.subs;this.setState({subs:[...t,Ol(e)]})})}),vl(this,"unsubscribe",e=>{pl.delete(e).then(()=>{var t=this.state.subs;this.setState({subs:Object(c.without)(t,e)})}).catch(()=>{un.error("Failed unsubscribing.")})})}componentDidMount(){var e=this.props.alertId;Promise.all([ml.query(),pl.query({alertId:e})]).then(e=>{var t=gl(e,2),r=t[0],a=t[1];a=a.map(Ol),this.setState({dests:r,subs:a})})}render(){if(!this.props.alertId)return null;var e=this.state.subs,t=Object(c.find)(e,{destination:{id:-1},user:{id:Y.id}}),r=Object(c.without)(e,t),a=$.mailSettingsMissing;return n.a.createElement("div",{className:"alert-destinations","data-test":"AlertDestinations"},n.a.createElement(Ne,{title:'Click to add an existing "Alert Destination"',mouseEnterDelay:.5},n.a.createElement(h.a,{"data-test":"ShowAddAlertSubDialog",type:"primary",size:"small",className:"add-button",onClick:this.showAddAlertSubDialog},n.a.createElement("i",{className:"fa fa-plus f-12 m-r-5","aria-hidden":"true"})," Add")),n.a.createElement("ul",null,n.a.createElement("li",{className:"destination-wrapper"},n.a.createElement("i",{className:"destination-icon fa fa-envelope","aria-hidden":"true"}),n.a.createElement("span",{className:"flex-fill"},Y.email),n.a.createElement(hl,{className:"destination-warning",featureName:"alert emails",mode:"icon"}),!a&&n.a.createElement(Gi.a,{size:"small",className:"toggle-button",checked:!!t,loading:!e,onChange:()=>this.onUserEmailToggle(t),"data-test":"UserEmailToggle"})),r.map(e=>n.a.createElement(El,bl({key:e.id,unsubscribe:()=>this.unsubscribe(e)},e)))))}}vl(jl,"propTypes",{alertId:se.a.any.isRequired});var wl=["children","label","className"];function Sl(){return(Sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Pl(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Cl(e){var t=e.children,r=e.label,a=e.className,i=Pl(e,wl),s={span:16};return r||(s.offset=4),a=ge()("alert-form-item",a),n.a.createElement(Co.a.Item,Sl({labelCol:{span:4},wrapperCol:s,label:r,className:a},i),t)}function Nl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kl(e){var t=e.state,r=e.lastTriggered;return n.a.createElement("div",{className:"alert-state"},n.a.createElement("span",{className:"alert-state-indicator label ".concat(go[t])},"Status: ",t),"unknown"===t&&n.a.createElement("div",{className:"ant-form-item-explain"},"Alert condition has not been evaluated."),r&&n.a.createElement("div",{className:"ant-form-item-explain"},"Last triggered"," ",n.a.createElement("span",{className:"alert-last-triggered"},n.a.createElement(ii,{date:r}))))}Cl.propTypes={children:se.a.node,label:se.a.string,className:se.a.string},Cl.defaultProps={children:null,label:null,className:null},kl.propTypes={state:se.a.string.isRequired,lastTriggered:se.a.string},kl.defaultProps={lastTriggered:null};class _l extends n.a.Component{constructor(){super(...arguments),Nl(this,"state",{unmuting:!1}),Nl(this,"unmute",()=>{this.setState({unmuting:!0}),this.props.unmute().finally(()=>{this.setState({unmuting:!1})})})}render(){var e=this.props,t=e.alert,r=e.queryResult,a=e.canEdit,i=e.onEdit,s=e.menuButton,o=t.query,l=t.name,c=t.options,u=t.rearm;return n.a.createElement(n.a.Fragment,null,n.a.createElement(No,{name:l,alert:t},n.a.createElement(pe,{name:"AlertView.HeaderExtra",alert:t}),n.a.createElement(Ne,{title:a?"":"You do not have sufficient permissions to edit this alert"},n.a.createElement(h.a,{type:"default",onClick:a?i:null,className:ge()({disabled:!a})},n.a.createElement("i",{className:"fa fa-edit m-r-5","aria-hidden":"true"}),"Edit"),s)),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement(In.Row,{type:"flex",gutter:16},n.a.createElement(In.Col,{xs:24,md:16,className:"d-flex"},n.a.createElement(Co.a,{className:"flex-fill"},n.a.createElement(Cl,null,n.a.createElement(kl,{state:t.state,lastTriggered:t.last_triggered_at})),n.a.createElement(Cl,{label:"Query"},n.a.createElement(nl,{query:o,queryResult:r})),r&&c&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Cl,{label:"Trigger when",className:"alert-criteria"},n.a.createElement(Do,{columnNames:r.getColumnNames(),resultValues:r.getData(),alertOptions:c})),n.a.createElement(Cl,{label:"Notifications",className:"form-item-line-height-normal"},n.a.createElement(Ho,{value:u||0}),n.a.createElement("br",null),"Set to ",c.custom_subject||c.custom_body?"custom":"default"," notification template.")))),n.a.createElement(In.Col,{xs:24,md:8},c.muted&&n.a.createElement(p.a,{className:"m-b-20",message:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-bell-slash-o","aria-hidden":"true"})," Notifications are muted"),description:n.a.createElement(n.a.Fragment,null,"Notifications for this alert will not be sent.",n.a.createElement("br",null),a&&n.a.createElement(n.a.Fragment,null,"To restore notifications click",n.a.createElement(h.a,{size:"small",type:"primary",onClick:this.unmute,loading:this.state.unmuting,className:"m-t-5 m-l-5"},"Unmute"))),type:"warning"}),n.a.createElement("h4",null,"Destinations"," ",n.a.createElement(Ne,{title:"Open Alert Destinations page in a new tab."},n.a.createElement(S,{href:"destinations",target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link f-13","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")))),n.a.createElement(jl,{alertId:t.id})))))}}function Al(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ql(e){var t=e.alert,r=e.query,i=e.columnNames,s=e.resultValues,o=e.subject,l=e.setSubject,u=e.body,d=e.setBody,m=!(!o&&!u),p=Al(Object(a.useState)(m?1:0),2),f=p[0],h=p[1],b=Al(Object(a.useState)(!1),2),g=b[0],y=b[1],v=function(e,t,r,a){var n=Object(c.isEmpty)(a)?null:Object(c.head)(a)[e.options.column];return{ALERT_STATUS:"TRIGGERED",ALERT_CONDITION:e.options.op,ALERT_THRESHOLD:e.options.value,ALERT_NAME:e.name,ALERT_URL:"".concat(window.location.origin,"/alerts/").concat(e.id),QUERY_NAME:t.name,QUERY_URL:"".concat(window.location.origin,"/queries/").concat(t.id),QUERY_RESULT_VALUE:Object(c.isNull)(n)||Object(c.isUndefined)(n)?"UNKNOWN":n,QUERY_RESULT_ROWS:a,QUERY_RESULT_COLS:r}}(t,r,i,s),O=e=>Dt.a.render(e||"",v);return n.a.createElement("div",{className:"alert-template"},n.a.createElement(Xi.a,{value:f,onChange:e=>{e||!m?(h(e),y(!1)):V.a.confirm({title:"Are you sure?",content:"Switching to default template will discard your custom template.",onOk:()=>{l(null),d(null),h(e),y(!1)},maskClosable:!0,autoFocusButton:null})},optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:"fit-content"}},n.a.createElement(Xi.a.Option,{value:0,label:"Use default template"},"Default template"),n.a.createElement(Xi.a.Option,{value:1,label:"Use custom template"},"Custom template")),!!f&&n.a.createElement("div",{className:"alert-custom-template","data-test":"AlertCustomTemplate"},n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("h5",{className:"flex-fill"},"Subject / Body"),"Preview"," ",n.a.createElement(Gi.a,{size:"small",className:"alert-template-preview",value:g,onChange:y})),n.a.createElement(He.a,{value:g?O(o):o,"aria-label":"Subject",onChange:e=>l(e.target.value),disabled:g,"data-test":"CustomSubject"}),n.a.createElement(He.a.TextArea,{value:g?O(u):u,"aria-label":"Body",autoSize:{minRows:9},onChange:e=>d(e.target.value),disabled:g,"data-test":"CustomBody"}),n.a.createElement(Qe,{type:"ALERT_NOTIF_TEMPLATE_GUIDE",className:"f-13"},n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"})," Formatting guide"," ",n.a.createElement("span",{className:"sr-only"},"(help)"))))}_l.propTypes={alert:ei.isRequired,queryResult:se.a.object,canEdit:se.a.bool.isRequired,onEdit:se.a.func.isRequired,menuButton:se.a.node.isRequired,unmute:se.a.func},_l.defaultProps={queryResult:null,unmute:null},ql.propTypes={alert:ei.isRequired,query:Xn.isRequired,columnNames:se.a.arrayOf(se.a.string).isRequired,resultValues:se.a.arrayOf(se.a.any).isRequired,subject:se.a.string,setSubject:se.a.func.isRequired,body:se.a.string,setBody:se.a.func.isRequired},ql.defaultProps={subject:"",body:""};var Tl=ql;function Il(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Dl extends n.a.Component{constructor(){super(...arguments),Il(this,"_isMounted",!1),Il(this,"state",{saving:!1}),Il(this,"save",()=>{this.setState({saving:!0}),this.props.save().catch(()=>{this._isMounted&&this.setState({saving:!1})})}),Il(this,"cancel",()=>{this.props.cancel()})}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){var e=this.props,t=e.alert,r=e.queryResult,a=e.pendingRearm,i=e.onNotificationTemplateChange,s=e.menuButton,o=this.props,l=o.onQuerySelected,c=o.onNameChange,u=o.onRearmChange,d=o.onCriteriaChange,m=t.query,p=t.name,f=t.options,b=this.state.saving;return n.a.createElement(n.a.Fragment,null,n.a.createElement(No,{name:p,alert:t,onChange:c,editMode:!0},n.a.createElement(pe,{name:"AlertEdit.HeaderExtra",alert:t}),n.a.createElement(h.a,{className:"m-r-5",onClick:()=>this.cancel()},n.a.createElement("i",{className:"fa fa-times m-r-5","aria-hidden":"true"}),"Cancel"),n.a.createElement(h.a,{type:"primary",onClick:()=>this.save()},b?n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Saving...")):n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-check m-r-5","aria-hidden":"true"})),"Save Changes"),s),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement("div",{className:"d-flex"},n.a.createElement(Co.a,{className:"flex-fill"},n.a.createElement(Cl,{label:"Query"},n.a.createElement(nl,{query:m,queryResult:r,onChange:l,editMode:!0})),r&&f&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Cl,{label:"Trigger when",className:"alert-criteria"},n.a.createElement(Do,{columnNames:r.getColumnNames(),resultValues:r.getData(),alertOptions:f,onChange:d,editMode:!0})),n.a.createElement(Cl,{label:"When triggered, send notification"},n.a.createElement(Ho,{value:a||0,onChange:u,editMode:!0})),n.a.createElement(Cl,{label:"Template"},n.a.createElement(Tl,{alert:t,query:m,columnNames:r.getColumnNames(),resultValues:r.getData(),subject:f.custom_subject,setSubject:e=>i({custom_subject:e}),body:f.custom_body,setBody:e=>i({custom_body:e})})))),n.a.createElement("div",null,n.a.createElement(Qe,{className:"f-13",type:"ALERT_SETUP"},"Setup Instructions ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(help)"))))))}}function Rl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Dl.propTypes={alert:ei.isRequired,queryResult:se.a.object,pendingRearm:se.a.number,menuButton:se.a.node.isRequired,save:se.a.func.isRequired,cancel:se.a.func.isRequired,onQuerySelected:se.a.func.isRequired,onNameChange:se.a.func.isRequired,onCriteriaChange:se.a.func.isRequired,onRearmChange:se.a.func.isRequired,onNotificationTemplateChange:se.a.func.isRequired},Dl.defaultProps={queryResult:null,pendingRearm:null};class Ml extends n.a.Component{constructor(){super(...arguments),Rl(this,"state",{saving:!1}),Rl(this,"save",()=>{this.setState({saving:!0}),this.props.save().catch(()=>{this.setState({saving:!1})})})}render(){var e=this.props,t=e.alert,r=e.queryResult,a=e.pendingRearm,i=e.onNotificationTemplateChange,s=this.props,o=s.onQuerySelected,l=s.onNameChange,c=s.onRearmChange,u=s.onCriteriaChange,d=t.query,m=t.name,p=t.options,f=this.state.saving;return n.a.createElement(n.a.Fragment,null,n.a.createElement(No,{alert:t,name:m,onChange:l,editMode:!0}),n.a.createElement("div",{className:"bg-white tiled p-20"},n.a.createElement("div",{className:"d-flex"},n.a.createElement(Co.a,{className:"flex-fill"},n.a.createElement("div",{className:"m-b-30"},"Start by selecting the query that you would like to monitor using the search bar.",n.a.createElement("br",null),"Keep in mind that Alerts do not work with queries that use parameters."),n.a.createElement(Cl,{label:"Query"},n.a.createElement(nl,{query:d,queryResult:r,onChange:o,editMode:!0})),r&&p&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Cl,{label:"Trigger when",className:"alert-criteria"},n.a.createElement(Do,{columnNames:r.getColumnNames(),resultValues:r.getData(),alertOptions:p,onChange:u,editMode:!0})),n.a.createElement(Cl,{label:"When triggered, send notification"},n.a.createElement(Ho,{value:a||0,onChange:c,editMode:!0})),n.a.createElement(Cl,{label:"Template"},n.a.createElement(Tl,{alert:t,query:d,columnNames:r.getColumnNames(),resultValues:r.getData(),subject:p.custom_subject,setSubject:e=>i({custom_subject:e}),body:p.custom_body,setBody:e=>i({custom_body:e})}))),n.a.createElement(Cl,null,n.a.createElement(h.a,{type:"primary",onClick:this.save,disabled:!d,className:"btn-create-alert"},f&&n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse m-r-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Saving...")),"Create Alert"))),n.a.createElement(Qe,{className:"f-13",type:"ALERT_SETUP"},"Setup Instructions ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(help)")))))}}function zl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Fl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zl(Object(r),!0).forEach((function(t){Ul(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ll(){return(Ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ul(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ml.propTypes={alert:ei.isRequired,queryResult:se.a.object,pendingRearm:se.a.number,onQuerySelected:se.a.func.isRequired,save:se.a.func.isRequired,onNameChange:se.a.func.isRequired,onRearmChange:se.a.func.isRequired,onCriteriaChange:se.a.func.isRequired,onNotificationTemplateChange:se.a.func.isRequired},Ml.defaultProps={queryResult:null,pendingRearm:null};var Vl={NEW:0,VIEW:1,EDIT:2},Bl=Object(c.template)("<%= query.name %>: <%= options.column %> <%= options.op %> <%= options.value %>");function Ql(e){return e.query?Bl(e):"New Alert"}class Wl extends n.a.Component{constructor(){super(...arguments),Ul(this,"_isMounted",!1),Ul(this,"state",{alert:null,queryResult:null,pendingRearm:null,canEdit:!1,mode:null}),Ul(this,"save",()=>{var e=this.state,t=e.alert,r=e.pendingRearm;return t.name=Object(c.trim)(t.name)||Ql(t),t.rearm=r||null,fo.save(t).then(e=>{un.success("Saved."),bt("alerts/".concat(e.id),!0),this.setState({alert:e,mode:Vl.VIEW})}).catch(()=>{un.error("Failed saving alert.")})}),Ul(this,"onQuerySelected",e=>{this.setState(t=>({alert:Ll(t.alert,{query:e}),queryResult:null})),e&&new ir(e).getQueryResultPromise().then(e=>{if(this._isMounted){this.setState({queryResult:e});var t=this.state.alert.options.column,r=e.getColumnNames();t&&Object(c.includes)(r,t)||(t=Object(c.head)(e.getColumnNames())),this.setAlertOptions({column:t})}})}),Ul(this,"onNameChange",e=>{var t=this.state.alert;this.setState({alert:Ll(t,{name:e})})}),Ul(this,"onRearmChange",e=>{this.setState({pendingRearm:e})}),Ul(this,"setAlertOptions",e=>{var t=this.state.alert,r=Fl(Fl({},t.options),e);this.setState({alert:Ll(t,{options:r})})}),Ul(this,"delete",()=>{var e=this.state.alert;return fo.delete(e).then(()=>{un.success("Alert deleted successfully."),bt("alerts")}).catch(()=>{un.error("Failed deleting alert.")})}),Ul(this,"mute",()=>{var e=this.state.alert;return fo.mute(e).then(()=>{this.setAlertOptions({muted:!0}),un.warn("Notifications have been muted.")}).catch(()=>{un.error("Failed muting notifications.")})}),Ul(this,"unmute",()=>{var e=this.state.alert;return fo.unmute(e).then(()=>{this.setAlertOptions({muted:!1}),un.success("Notifications have been restored.")}).catch(()=>{un.error("Failed restoring notifications.")})}),Ul(this,"edit",()=>{var e=this.state.alert.id;bt("alerts/".concat(e,"/edit"),!0),this.setState({mode:Vl.EDIT})}),Ul(this,"cancel",()=>{var e=this.state.alert.id;bt("alerts/".concat(e),!0),this.setState({mode:Vl.VIEW})})}componentDidMount(){this._isMounted=!0;var e=this.props.mode;if(this.setState({mode:e}),e===Vl.NEW)this.setState({alert:{options:{op:">",value:1,muted:!1}},pendingRearm:0,canEdit:!0});else{var t=this.props.alertId;fo.get({id:t}).then(e=>{if(this._isMounted){var t=Y.canEdit(e);t||(this.setState({mode:Vl.VIEW}),un.warn("You cannot edit this alert","You do not have sufficient permissions to edit this alert, and have been redirected to the view-only page.",{duration:0})),this.setState({alert:e,canEdit:t,pendingRearm:e.rearm}),this.onQuerySelected(e.query)}}).catch(e=>{this._isMounted&&this.props.onError(e)})}}componentWillUnmount(){this._isMounted=!1}render(){var e=this.state.alert;if(!e)return n.a.createElement(Ys,{className:"m-t-30"});var t=!!e.options.muted,r=this.state,a=r.queryResult,i=r.mode,s=r.canEdit,o=r.pendingRearm,l=n.a.createElement(So,{doDelete:this.delete,muted:t,mute:this.mute,unmute:this.unmute,canEdit:s}),c={alert:e,queryResult:a,pendingRearm:o,save:this.save,menuButton:l,onQuerySelected:this.onQuerySelected,onRearmChange:this.onRearmChange,onNameChange:this.onNameChange,onCriteriaChange:this.setAlertOptions,onNotificationTemplateChange:this.setAlertOptions};return n.a.createElement("div",{className:"alert-page"},n.a.createElement("div",{className:"container"},i===Vl.NEW&&n.a.createElement(Ml,c),i===Vl.VIEW&&n.a.createElement(_l,Ll({canEdit:s,onEdit:this.edit,muted:t,unmute:this.unmute},c)),i===Vl.EDIT&&n.a.createElement(Dl,Ll({cancel:this.cancel},c))))}}function Hl(e){return e.tags||[]}function Gl(e){return K.get(e).then(Hl)}function Kl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Yl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}Ul(Wl,"propTypes",{mode:se.a.oneOf(Object(c.values)(Vl)),alertId:se.a.string,onError:se.a.func}),Ul(Wl,"defaultProps",{mode:null,alertId:null,onError:()=>{}}),jn.register("Alerts.New",Ga({path:"/alerts/new",title:"New Alert",render:e=>n.a.createElement(Wl,Ll({},e,{mode:Vl.NEW}))})),jn.register("Alerts.View",Ga({path:"/alerts/:alertId",title:"Alert",render:e=>n.a.createElement(Wl,Ll({},e,{mode:Vl.VIEW}))})),jn.register("Alerts.Edit",Ga({path:"/alerts/:alertId/edit",title:"Alert",render:e=>n.a.createElement(Wl,Ll({},e,{mode:Vl.EDIT}))}));var $l=function(e){var t=e.tagsUrl,r=e.showUnselectAll,i=void 0!==r&&r,s=e.onUpdate,o=Kl(Object(a.useState)([]),2),l=o[0],u=o[1],d=Kl(Object(a.useState)([]),2),m=d[0],p=d[1];Object(a.useEffect)(()=>{var e=!1;return Gl(t).then(t=>{e||u(t)}),()=>{e=!0}},[t]);var f=Object(a.useCallback)((e,t)=>{var r;r=e.shiftKey?Object(c.includes)(m,t)?Object(c.difference)(m,[t]):[...m,t]:Object(c.includes)(m,t)&&1===m.length?[]:[t],p(r),s&&s([...r])},[m,s]),h=Object(a.useCallback)(()=>{p([]),s&&s([])},[s]);return 0===l.length?null:n.a.createElement("div",{className:"tags-list"},n.a.createElement("div",{className:"tags-list-title"},n.a.createElement("span",{className:"tags-list-label"},"Tags"),i&&m.length>0&&n.a.createElement(Ee,{type:"link",onClick:h},n.a.createElement(xe.a,null),"clear selection")),n.a.createElement("div",{className:"tiled"},n.a.createElement(he.a,{className:"invert-stripe-position",mode:"inline",selectedKeys:m},Object(c.map)(l,e=>n.a.createElement(he.a.Item,{key:e.name,className:"m-0"},n.a.createElement(Ee,{className:"d-flex align-items-center justify-content-between",onClick:t=>f(t,e.name)},n.a.createElement("span",{className:"max-character col-xs-11"},e.name),n.a.createElement(zn.a,{count:e.count})))))))};function Jl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Zl(e){var t=e.placeholder,r=e.value,i=e.showIcon,s=e.onChange,o=e.label,l=Jl(Object(a.useState)(r),2),c=l[0],u=l[1];Object(a.useEffect)(()=>{u(r)},[r]);var d=Object(a.useCallback)(e=>{var t=e.target.value;u(t),s(t)},[s]),m=i?He.a.Search:He.a;return n.a.createElement("div",{className:"m-b-10"},n.a.createElement(m,{className:"form-control",placeholder:t,value:c,"aria-label":o,onChange:d}))}function ec(e){var t=e.items,r=e.selected;return 0===(t=Object(c.filter)(t,e=>!Object(c.isFunction)(e.isAvailable)||e.isAvailable())).length?null:n.a.createElement("div",{className:"m-b-10 tags-list tiled"},n.a.createElement(he.a,{className:"invert-stripe-position",mode:"inline",selectable:!1,selectedKeys:[r]},Object(c.map)(t,e=>n.a.createElement(he.a.Item,{key:e.key,className:"m-0"},n.a.createElement(S,{href:e.href},Object(c.isString)(e.icon)&&""!==e.icon&&n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:e.icon,"aria-hidden":"true"})),Object(c.isFunction)(e.icon)&&(e.icon(e)||null),e.title)))))}function tc(e){var t=e.icon;return n.a.createElement("span",{className:"btn-favorite m-r-5"},n.a.createElement("i",{className:t,"aria-hidden":"true"}))}function rc(e){var t=e.user;return Object(c.isString)(t.profile_image_url)&&""!==t.profile_image_url?n.a.createElement("img",{src:t.profile_image_url,className:"profile__image--sidebar m-r-5",width:"13",alt:t.name}):null}function ac(e){var t=e.url,r=e.onChange,a=e.showUnselectAll;return""===t?null:n.a.createElement("div",{className:"m-b-10"},n.a.createElement($l,{tagsUrl:t,onUpdate:r,showUnselectAll:a}))}Zl.propTypes={value:se.a.string.isRequired,placeholder:se.a.string,showIcon:se.a.bool,onChange:se.a.func.isRequired,label:se.a.string},Zl.defaultProps={placeholder:"Search...",showIcon:!1,label:"Search"},ec.propTypes={items:se.a.arrayOf(se.a.shape({key:se.a.string.isRequired,href:se.a.string.isRequired,title:se.a.string.isRequired,icon:se.a.func,isAvailable:se.a.func})),selected:se.a.string},ec.defaultProps={items:[],selected:null},tc.propTypes={icon:se.a.string.isRequired},rc.propTypes={user:se.a.shape({profile_image_url:se.a.string,name:se.a.string}).isRequired},ac.propTypes={url:se.a.string.isRequired,onChange:se.a.func.isRequired,showUnselectAll:se.a.bool,unselectAllButtonTitle:se.a.string};var nc=r(53),ic=r.n(nc);function sc(){return(sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function oc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return lc(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function cc(e,t,r){var i=oc(Object(a.useState)({isAvailable:!1}),2),s=i[0],o=i[1],l=oc(Object(a.useState)([]),2),u=l[0],d=l[1];Object(a.useEffect)(()=>{d([])},[e.pageItems,s.isAvailable]);var m=Object(a.useMemo)(()=>{var t=e.pageItems;return 0!==t.length&&0!==u.length&&Object(c.intersection)(u,t).length===t.length},[u,e.pageItems]),p=Object(a.useCallback)(()=>{d(m?[]:e.pageItems)},[m,e.pageItems]),f=Object(a.useCallback)(e=>{Object(c.includes)(u,e)?d(Object(c.filter)(u,t=>t!==e)):d([...u,e])},[u]),h=Object(a.useMemo)(()=>Ci.custom((e,t)=>n.a.createElement(ic.a,{checked:Object(c.includes)(u,t),onChange:()=>f(t)}),{title:()=>n.a.createElement(ic.a,{checked:m,onChange:p}),field:"id",width:"1%"}),[u,m,p,f]),b=Object(a.useCallback)((function(e){return r?n.a.createElement(r,sc({onStateChange:o},e)):null}),[r]);return Object(a.useMemo)(()=>({areExtraActionsAvailable:s.isAvailable,listColumns:s.isAvailable?[h,...t]:t,Component:b,selectedItems:u,setSelectedItems:d}),[s,t,h,u,b])}var uc=["className","children"],dc=["className","children"],mc=["children","className"];function pc(){return(pc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function fc(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var hc={className:se.a.string,children:se.a.node},bc={className:null,children:null};function gc(e){var t=e.className,r=e.children,a=fc(e,uc);return n.a.createElement("div",pc({className:ge()("layout-sidebar",t)},a),n.a.createElement("div",null,r))}function yc(e){var t=e.className,r=e.children,a=fc(e,dc);return n.a.createElement("div",pc({className:ge()("layout-content",t)},a),n.a.createElement("div",null,r))}function vc(e){var t=e.children,r=e.className,a=void 0===r?void 0:r,i=fc(e,mc);return n.a.createElement("div",pc({className:ge()("layout-with-sidebar",a)},i),t)}function Oc(e){var t=e.objectType,r=e.tags;return n.a.createElement(Ie,{icon:"fa-tags"},"No ",t," found tagged with ",n.a.createElement(os,{className:"inline-tags-control",tags:Array.from(r),tagSeparator:"+"}),".")}function Ec(e){var t=e.page,r=e.searchTerm,n=e.selectedTags;if(""!==r)return a.createElement(Ie,{message:"Sorry, we couldn't find anything.",icon:"fa-search"});if(n.length>0)return a.createElement(Oc,{objectType:"dashboards",tags:n});switch(t){case"favorites":return a.createElement(Ie,{message:"Mark dashboards as Favorite to list them here.",icon:"fa-star"});case"my":var i=Y.hasPermission("create_dashboard")?a.createElement("span",null,a.createElement(h.a,{type:"primary",size:"small",onClick:()=>ia.showModal()},"Create your first dashboard!")," ",a.createElement(Qe,{className:"f-14",type:"DASHBOARDS",showTooltip:!1},"Need help?")):a.createElement("span",null,"Sorry, we couldn't find anything.");return a.createElement(Ie,{icon:"fa-search"},i);default:return a.createElement(pe,{name:"DashboardList.EmptyState"},a.createElement(Xa,{icon:"zmdi zmdi-view-quilt",description:"See the big picture",illustration:"dashboard",helpMessage:a.createElement($a,{helpTriggerType:"DASHBOARDS"}),showDashboardStep:!0}))}}function jc(){return(jc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}gc.propTypes=hc,gc.defaultProps=bc,yc.propTypes=hc,yc.defaultProps=bc,vc.propTypes=hc,vc.defaultProps=bc,vc.Sidebar=gc,vc.Content=yc,Oc.propTypes={objectType:se.a.string.isRequired,tags:se.a.oneOfType([se.a.array,se.a.objectOf(Set)]).isRequired},Ec.propTypes={page:ie.string.isRequired,searchTerm:ie.string.isRequired,selectedTags:ie.array.isRequired};var wc=[{key:"all",href:"dashboards",title:"All Dashboards",icon:()=>n.a.createElement(tc,{icon:"zmdi zmdi-view-quilt"})},{key:"my",href:"dashboards/my",title:"My Dashboards",icon:()=>n.a.createElement(rc,{user:Y})},{key:"favorites",href:"dashboards/favorites",title:"Favorites",icon:()=>n.a.createElement(tc,{icon:"fa fa-star"})}],Sc=[Ci.favorites({className:"p-r-0"}),Ci.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(S,{className:"table-main-title",href:t.url,"data-test":"DashboardId".concat(t.id)},t.name),n.a.createElement(us,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:"Name",field:"name",width:null}),Ci.custom((e,t)=>t.user.name,{title:"Created By",width:"1%"}),Ci.dateTime.sortable({title:"Created At",field:"created_at",width:"1%"})];function Pc(e){return n.a.createElement(pe,jc({name:"DashboardList.Actions"},e))}function Cc(e){var t=e.controller,r=cc(t,Sc,Pc),a=r.areExtraActionsAvailable,i=r.listColumns,s=r.Component,o=r.selectedItems;return n.a.createElement("div",{className:"page-dashboard-list"},n.a.createElement("div",{className:"container"},n.a.createElement(Dn,{title:t.params.pageTitle,actions:Y.hasPermission("create_dashboard")?n.a.createElement(h.a,{block:!0,type:"primary",onClick:()=>ia.showModal()},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Dashboard"):null}),n.a.createElement(vc,null,n.a.createElement(vc.Sidebar,{className:"m-b-0"},n.a.createElement(Zl,{placeholder:"Search Dashboards...",label:"Search dashboards",value:t.searchTerm,onChange:t.updateSearch}),n.a.createElement(ec,{items:wc,selected:t.params.currentPage}),n.a.createElement(ac,{url:"api/dashboards/tags",onChange:t.updateSelectedTags,showUnselectAll:!0})),n.a.createElement(vc.Content,null,n.a.createElement("div",{"data-test":"DashboardLayoutContent"},t.isLoaded&&t.isEmpty?n.a.createElement(Ec,{page:t.params.currentPage,searchTerm:t.searchTerm,selectedTags:t.selectedTags}):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:ge()({"m-b-10":a})},n.a.createElement(s,{selectedItems:o})),n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(Ni,{items:t.pageItems,loading:!t.isLoaded,columns:i,orderByField:t.orderByField,orderByReverse:t.orderByReverse,toggleSorting:t.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:t.totalItemsCount,pageSize:t.itemsPerPage,onPageSizeChange:e=>t.updatePagination({itemsPerPage:e}),page:t.page,onChange:e=>t.updatePagination({page:e})}))))))))}Cc.propTypes={controller:Ss.isRequired};var Nc=Ps(Cc,()=>new Bs({getResource(e){var t=e.params.currentPage;return{all:$r.query.bind($r),my:$r.myDashboards.bind($r),favorites:$r.favorites.bind($r)}[t]},getItemProcessor:()=>e=>new $r(e)}),()=>new Gs({orderByField:"created_at",orderByReverse:!0}));jn.register("Dashboards.List",Ga({path:"/dashboards",title:"Dashboards",render:e=>n.a.createElement(Nc,jc({},e,{currentPage:"all"}))})),jn.register("Dashboards.Favorites",Ga({path:"/dashboards/favorites",title:"Favorite Dashboards",render:e=>n.a.createElement(Nc,jc({},e,{currentPage:"favorites"}))})),jn.register("Dashboards.My",Ga({path:"/dashboards/my",title:"My Dashboards",render:e=>n.a.createElement(Nc,jc({},e,{currentPage:"my"}))}));var kc=r(441),_c=r(144),Ac=r(143),xc=r.n(Ac),qc=r(204),Tc=r(442),Ic=r.n(Tc),Dc=(r(1495),/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Cmd":"Ctrl"),Rc=/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"Option":"Alt";var Mc={};function zc(e,t){e.preventDefault(),e.retunValue=!1,Object(c.each)(Mc[t],e=>e())}var Fc={modKey:Dc,altKey:Rc,bind:e=>{Object(c.each)(e,(e,t)=>{var r=t.toLowerCase().split(",").map(c.trim);Object(c.each)(r,t=>{Mc[t]=[...Object(c.without)(Mc[t],e),e],Ic.a.bindGlobal(t,zc)})})},unbind:e=>{Object(c.each)(e,(e,t)=>{var r=t.toLowerCase().split(",").map(c.trim);Object(c.each)(r,t=>{Mc[t]=Object(c.without)(Mc[t],e),0===Mc[t].length&&(Mc[t]=void 0,Ic.a.unbind(t))})})}};function Lc(e){var t=e.paramCount,r=e.onClick,a=t?n.a.createElement("i",{className:"fa fa-check","aria-hidden":"true"}):n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading..."));return n.a.createElement("div",{className:"parameter-apply-button","data-show":!!t,"data-test":"ParameterApplyButton"},n.a.createElement(zn.a,{count:t},n.a.createElement(Ne,{title:t?"".concat(Fc.modKey," + Enter"):null},n.a.createElement("span",null,n.a.createElement(h.a,{onClick:r},a," Apply Changes")))))}Lc.propTypes={onClick:se.a.func.isRequired,paramCount:se.a.number.isRequired};var Uc=Lc,Vc=document.createElement("canvas");Vc.style.display="none",document.body.appendChild(Vc);var Bc=["options"];function Qc(){return(Qc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Wc(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Hc=function(e){var t=e.options,r=Wc(e,Bc),i=Object(a.useMemo)(()=>{if(t&&t.length>400){var e=Object(c.maxBy)(t,"label.length");if(e){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,r=Vc.getContext("2d");if(r){var a=window.getComputedStyle(t);r.font="".concat(a.fontSize," ").concat(a.fontFamily);var n=r.measureText(e),i=n.width;return"actualBoundingBoxLeft"in n&&(i=Math.abs(n.actualBoundingBoxLeft)+Math.abs(n.actualBoundingBoxRight)),i}return null}(e.label);if(r)return r+40}return!0}return!1},[t]);return n.a.createElement(Xi.a,Qc({dropdownMatchSelectWidth:i,options:t,allowClear:!0,optionFilterProp:"label"},r))},Gc=r(111),Kc=r.n(Gc),Yc=["defaultValue","value","onSelect","className"];function $c(){return($c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Jc(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Xc=n.a.forwardRef((e,t)=>{var r=e.defaultValue,a=e.value,i=e.onSelect,s=e.className,o=Jc(e,Yc),l=$.dateFormat||"YYYY-MM-DD",c={};return r&&r.isValid()&&(c.defaultValue=r),(null===a||a&&a.isValid())&&(c.value=a),n.a.createElement(Kc.a,$c({ref:t,className:s},c,{format:l,placeholder:"Select Date",onChange:i},o))});Xc.propTypes={defaultValue:ri,value:ri,onSelect:se.a.func,className:se.a.string},Xc.defaultProps={defaultValue:null,value:void 0,onSelect:()=>{},className:""};var Zc=Xc,eu=["defaultValue","value","withSeconds","onSelect","className"];function tu(){return(tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ru(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var au=n.a.forwardRef((e,t)=>{var r=e.defaultValue,a=e.value,i=e.withSeconds,s=e.onSelect,o=e.className,l=ru(e,eu),c=($.dateFormat||"YYYY-MM-DD")+(i?" HH:mm:ss":" HH:mm"),u={};return r&&r.isValid()&&(u.defaultValue=r),(null===a||a&&a.isValid())&&(u.value=a),n.a.createElement(Kc.a,tu({ref:t,className:o,showTime:!0},u,{format:c,placeholder:"Select Date and Time",onChange:s},l))});au.propTypes={defaultValue:ri,value:ri,withSeconds:se.a.bool,onSelect:se.a.func,className:se.a.string},au.defaultProps={defaultValue:null,value:void 0,withSeconds:!1,onSelect:()=>{},className:""};var nu=au,iu=r(700),su=r.n(iu),ou=r(701),lu=r.n(ou),cu=r(702),uu=r.n(cu),du=rn.a.Text;function mu(e){var t=e.options,r=e.selectedDynamicValue,i=e.onSelect,s=e.enabled,o=e.staticValueLabel,l=n.a.createElement(he.a,{className:"dynamic-menu",onClick:e=>{var r=e.key;return i(Object(c.get)(t,r,"static"))},selectedKeys:["".concat(Object(c.findIndex)(t,{value:r}))],"data-test":"DynamicButtonMenu"},t.map((e,t)=>n.a.createElement(he.a.Item,{key:t},e.name," ",e.label&&n.a.createElement("em",null,Object(c.isFunction)(e.label)?e.label():e.label))),s&&n.a.createElement(he.a.Divider,null),s&&n.a.createElement(he.a.Item,null,n.a.createElement(su.a,null),n.a.createElement(du,{type:"secondary"},o))),u=Object(a.useRef)(null);return n.a.createElement("div",{ref:u},n.a.createElement("div",{role:"presentation",onClick:e=>e.stopPropagation()},n.a.createElement(Da.a.Button,{overlay:l,className:"dynamic-button",placement:"bottomRight",trigger:["click"],icon:s?n.a.createElement(lu.a,{className:"dynamic-icon"}):n.a.createElement(uu.a,{className:"dynamic-icon"}),getPopupContainer:()=>u.current,"data-test":"DynamicButton"})))}mu.propTypes={options:se.a.arrayOf(se.a.object),selectedDynamicValue:se.a.oneOfType([fr,Sr]),onSelect:se.a.func,enabled:se.a.bool,staticValueLabel:se.a.string},mu.defaultProps={options:[],selectedDynamicValue:null,onSelect:()=>{},enabled:!1,staticValueLabel:"Back to Static Value"};var pu=mu;function fu(){return(fu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function hu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bu extends n.a.Component{constructor(e){super(e),hu(this,"onDynamicValueSelect",e=>{var t=this.props,r=t.onSelect,a=t.parameter;if("static"===e){var n=a.getExecutionValue();r(n?l()(n):null)}else r(e.value);this.dateComponentRef.current.focus()}),this.dateComponentRef=n.a.createRef()}render(){var e=this.props,t=e.type,r=e.value,a=e.className,i=e.dateOptions,s=e.dynamicButtonOptions,o=e.onSelect,u=br(r),d=Object(c.includes)(t,"datetime"),m={},p=Zc;if(d&&(p=nu,Object(c.includes)(t,"with-seconds")&&(m.withSeconds=!0)),(l.a.isMoment(r)||null===r)&&(m.value=r),u){var f=r;m.placeholder=f&&f.name,m.value=null}return n.a.createElement("div",{className:ge()("date-parameter",a)},n.a.createElement(p,fu({},i,{ref:this.dateComponentRef,className:ge()("redash-datepicker",t,{"dynamic-value":u}),onSelect:o,suffixIcon:null},m)),n.a.createElement(pu,{options:s.options,staticValueLabel:s.staticValueLabel,selectedDynamicValue:u?r:null,enabled:u,onSelect:this.onDynamicValueSelect}))}}hu(bu,"propTypes",{type:se.a.string,className:se.a.string,value:se.a.any,parameter:se.a.any,onSelect:se.a.func,dynamicButtonOptions:se.a.shape({staticValueLabel:se.a.string,options:se.a.arrayOf(se.a.shape({name:se.a.string,value:se.a.object,label:se.a.oneOfType([se.a.string,se.a.func])}))}),dateOptions:se.a.any}),hu(bu,"defaultProps",{type:"",className:"",value:null,parameter:null,dynamicButtonOptions:{options:[]},onSelect:()=>{}});var gu=bu;function yu(){return(yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var vu=[{name:"Today/Now",value:gr("d_now"),label:()=>gr("d_now").value().format("MMM D")},{name:"Yesterday",value:gr("d_yesterday"),label:()=>gr("d_yesterday").value().format("MMM D")}];function Ou(e){return n.a.createElement(gu,yu({dynamicButtonOptions:{options:vu}},e,{dateOptions:{"aria-label":"Parameter date value"}}))}Ou.propTypes={type:se.a.string,className:se.a.string,value:se.a.any,parameter:se.a.any,onSelect:se.a.func},Ou.defaultProps={type:"",className:"",value:null,parameter:null,onSelect:()=>{}};var Eu=Ou,ju=["defaultValue","value","onSelect","className"];function wu(){return(wu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Su(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Pu=Kc.a.RangePicker,Cu=n.a.forwardRef((e,t)=>{var r=e.defaultValue,a=e.value,i=e.onSelect,s=e.className,o=Su(e,ju),l=$.dateFormat||"YYYY-MM-DD",u={};return Object(c.isArray)(r)&&r[0].isValid()&&r[1].isValid()&&(u.defaultValue=r),(null===a||Object(c.isArray)(a)&&a[0].isValid()&&a[1].isValid())&&(u.value=a),n.a.createElement(Pu,wu({ref:t,className:s},u,{format:l,onChange:i},o))});Cu.propTypes={defaultValue:se.a.arrayOf(ri),value:se.a.arrayOf(ri),onSelect:se.a.func,className:se.a.string},Cu.defaultProps={defaultValue:null,value:void 0,onSelect:()=>{},className:""};var Nu=Cu,ku=["defaultValue","value","withSeconds","onSelect","className"];function _u(){return(_u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Au(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var xu=Kc.a.RangePicker,qu=n.a.forwardRef((e,t)=>{var r=e.defaultValue,a=e.value,i=e.withSeconds,s=e.onSelect,o=e.className,l=Au(e,ku),u=($.dateFormat||"YYYY-MM-DD")+(i?" HH:mm:ss":" HH:mm"),d={};return Object(c.isArray)(r)&&r[0].isValid()&&r[1].isValid()&&(d.defaultValue=r),(null===a||Object(c.isArray)(a)&&a[0].isValid()&&a[1].isValid())&&(d.value=a),n.a.createElement(xu,_u({ref:t,className:o,showTime:!0},d,{format:u,onChange:s},l))});qu.propTypes={defaultValue:se.a.arrayOf(ri),value:se.a.arrayOf(ri),withSeconds:se.a.bool,onSelect:se.a.func,className:se.a.string},qu.defaultProps={defaultValue:null,value:void 0,withSeconds:!1,onSelect:()=>{},className:""};var Tu=qu,Iu=["type","value","onSelect","className","dynamicButtonOptions","dateRangeOptions","parameter"];function Du(){return(Du=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ru(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Mu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class zu extends n.a.Component{constructor(e){super(e),Mu(this,"onDynamicValueSelect",e=>{var t=this.props,r=t.onSelect,a=t.parameter;if("static"===e){var n=a.getExecutionValue();Object(c.isObject)(n)&&n.start&&n.end?r([l()(n.start),l()(n.end)]):r(null)}else r(e.value);this.dateRangeComponentRef.current.focus()}),this.dateRangeComponentRef=n.a.createRef()}render(){var e=this.props,t=e.type,r=e.value,a=e.onSelect,i=e.className,s=e.dynamicButtonOptions,o=e.dateRangeOptions,u=(e.parameter,Ru(e,Iu)),d=Object(c.includes)(t,"datetime-range"),m=Cr(r),p={},f=Nu;return d&&(f=Tu,Object(c.includes)(t,"with-seconds")&&(p.withSeconds=!0)),(function(e){return Object(c.isArray)(e)&&2===e.length&&l.a.isMoment(e[0])&&l.a.isMoment(e[1])}(r)||null===r)&&(p.value=r),m&&(p.placeholder=[r&&r.name],p.value=null),n.a.createElement("div",Du({},u,{className:ge()("date-range-parameter",i)}),n.a.createElement(f,Du({},o,{ref:this.dateRangeComponentRef,className:ge()("redash-datepicker date-range-input",t,{"dynamic-value":m}),onSelect:a,suffixIcon:null},p)),n.a.createElement(pu,{options:s.options,staticValueLabel:s.staticValueLabel,selectedDynamicValue:m?r:null,enabled:m,onSelect:this.onDynamicValueSelect}))}}Mu(zu,"propTypes",{type:se.a.oneOf(["date-range","datetime-range","datetime-range-with-seconds"]).isRequired,className:se.a.string,value:se.a.any,parameter:se.a.any,onSelect:se.a.func,dynamicButtonOptions:se.a.shape({staticValueLabel:se.a.string,options:se.a.arrayOf(se.a.shape({name:se.a.string,value:se.a.object,label:se.a.oneOfType([se.a.string,se.a.func])}))}),dateRangeOptions:se.a.any}),Mu(zu,"defaultProps",{type:"date-range",className:"",value:null,parameter:null,dynamicButtonOptions:{options:[]},onSelect:()=>{}});var Fu=zu;function Lu(){return(Lu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var Uu=[{name:"This week",value:Nr("d_this_week"),label:()=>Nr("d_this_week").value()[0].format("MMM D")+" - "+Nr("d_this_week").value()[1].format("MMM D")},{name:"This month",value:Nr("d_this_month"),label:()=>Nr("d_this_month").value()[0].format("MMMM")},{name:"This year",value:Nr("d_this_year"),label:()=>Nr("d_this_year").value()[0].format("YYYY")},{name:"Last week",value:Nr("d_last_week"),label:()=>Nr("d_last_week").value()[0].format("MMM D")+" - "+Nr("d_last_week").value()[1].format("MMM D")},{name:"Last month",value:Nr("d_last_month"),label:()=>Nr("d_last_month").value()[0].format("MMMM")},{name:"Last year",value:Nr("d_last_year"),label:()=>Nr("d_last_year").value()[0].format("YYYY")},{name:"Last 7 days",value:Nr("d_last_7_days"),label:()=>Nr("d_last_7_days").value()[0].format("MMM D")+" - Today"},{name:"Last 14 days",value:Nr("d_last_14_days"),label:()=>Nr("d_last_14_days").value()[0].format("MMM D")+" - Today"},{name:"Last 30 days",value:Nr("d_last_30_days"),label:()=>Nr("d_last_30_days").value()[0].format("MMM D")+" - Today"},{name:"Last 60 days",value:Nr("d_last_60_days"),label:()=>Nr("d_last_60_days").value()[0].format("MMM D")+" - Today"},{name:"Last 90 days",value:Nr("d_last_90_days"),label:()=>Nr("d_last_90_days").value()[0].format("MMM D")+" - Today"},{name:"Last 12 months",value:Nr("d_last_12_months"),label:null}],Vu=[{name:"Today",value:Nr("d_today"),label:()=>Nr("d_today").value()[0].format("MMM D")},{name:"Yesterday",value:Nr("d_yesterday"),label:()=>Nr("d_yesterday").value()[0].format("MMM D")},...Uu];function Bu(e){var t=Object(c.includes)(e.type,"datetime-range")?Vu:Uu;return n.a.createElement(Fu,Lu({},e,{dynamicButtonOptions:{options:t}}))}Bu.propTypes={type:se.a.string,className:se.a.string,value:se.a.any,parameter:se.a.any,onSelect:se.a.func},Bu.defaultProps={type:"",className:"",value:null,parameter:null,onSelect:()=>{}};var Qu=Bu,Wu=(r(1515),["className","mode","onSelect","queryId","value"]);function Hu(){return(Hu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Gu(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ku(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ku=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,s=Object.create(i.prototype),o=new P(n||[]);return a(s,"_invoke",{value:E(e,r,o)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function m(){}function p(){}function f(){}var h={};l(h,i,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(C([])));g&&g!==t&&r.call(g,i)&&(h=g);var y=f.prototype=m.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){var n;a(this,"_invoke",{value:function(a,i){function s(){return new t((function(n,s){!function a(n,i,s,o){var l=u(e[n],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,s,o)}),(function(e){a("throw",e,s,o)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,o)}))}o(l.arg)}(a,i,n,s)}))}return n=n?n.then(s,s):s()}})}function E(e,t,r){var a="suspendedStart";return function(n,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return N()}for(r.method=n,r.arg=i;;){var s=r.delegate;if(s){var o=j(s,r);if(o){if(o===d)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var l=u(e,t,r);if("normal"===l.type){if(a=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a="completed",r.method="throw",r.arg=l.arg)}}}function j(e,t){var r=t.method,a=e.iterator[r];if(void 0===a)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,j(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var n=u(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,n=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:N}}function N(){return{value:void 0,done:!0}}return p.prototype=f,a(y,"constructor",{value:f,configurable:!0}),a(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(O.prototype),l(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,a,n,i){void 0===i&&(i=Promise);var s=new O(c(t,r,a,n),i);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(y),l(y,o,"Generator"),l(y,i,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(r,a){return s.type="throw",s.arg=e,t.next=r,a&&(t.method="next",t.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var o=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(o&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;S(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function Yu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $u extends n.a.Component{constructor(e){super(e),this.state={options:[],value:null,loading:!1}}componentDidMount(){this._loadOptions(this.props.queryId)}componentDidUpdate(e){this.props.queryId!==e.queryId&&this._loadOptions(this.props.queryId),this.props.value!==e.value&&this.setValue(this.props.value)}setValue(e){var t=this.state.options;if("multiple"===this.props.mode){e=Object(c.isArray)(e)?e:[e];var r=Object(c.map)(t,e=>e.value),a=Object(c.intersection)(e,r);return this.setState({value:a}),a}return e=void 0!==Object(c.find)(t,e=>e.value===this.props.value)?e:Object(c.get)(Object(c.first)(t),"value"),this.setState({value:e}),e}_loadOptions(e){var t,r=this;return Ku().async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e||e===r.state.queryId){a.next=6;break}return r.setState({loading:!0}),a.next=4,Ku().awrap(r.props.parameter.loadDropdownValues());case 4:t=a.sent,r.props.queryId===e&&r.setState({options:t,loading:!1},()=>{var e=r.setValue(r.props.value);Object(c.isEqual)(e,r.props.value)||r.props.onSelect(e)});case 6:case"end":return a.stop()}}),null,null,null,Promise)}render(){var e=this.props,t=e.className,r=e.mode,a=e.onSelect,i=(e.queryId,e.value,Gu(e,Wu)),s=this.state,o=s.loading,l=s.options;return n.a.createElement("span",null,n.a.createElement(Hc,Hu({className:t,disabled:o,loading:o,mode:r,value:this.state.value,onChange:a,options:Object(c.map)(l,e=>{var t=e.value,r=e.name;return{label:String(r),value:t}}),showSearch:!0,showArrow:!0,notFoundContent:Object(c.isEmpty)(l)?"No options available":null},i)))}}function Ju(){return(Ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Xu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Yu($u,"propTypes",{parameter:se.a.any,value:se.a.any,mode:se.a.oneOf(["default","multiple"]),queryId:se.a.number,onSelect:se.a.func,className:se.a.string}),Yu($u,"defaultProps",{value:null,mode:"default",parameter:null,queryId:null,onSelect:()=>{},className:""});var Zu={maxTagCount:3,maxTagTextLength:10,maxTagPlaceholder:e=>"+".concat(e.length," more")};class ed extends n.a.Component{constructor(e){super(e),Xu(this,"componentDidUpdate",e=>{var t=this.props,r=t.value,a=t.parameter;e.value===r&&e.parameter===a||this.setState({value:a.hasPendingValue?a.pendingValue:r,isDirty:a.hasPendingValue})}),Xu(this,"onSelect",e=>{var t=!Object(c.isEqual)(e,this.props.value);this.setState({value:e,isDirty:t}),this.props.onSelect(e,t)}),this.state={value:e.parameter.hasPendingValue?e.parameter.pendingValue:e.value,isDirty:e.parameter.hasPendingValue}}renderDateParameter(){var e=this.props,t=e.type,r=e.parameter,a=this.state.value;return n.a.createElement(Eu,{type:t,className:this.props.className,value:a,parameter:r,onSelect:this.onSelect})}renderDateRangeParameter(){var e=this.props,t=e.type,r=e.parameter,a=this.state.value;return n.a.createElement(Qu,{type:t,className:this.props.className,value:a,parameter:r,onSelect:this.onSelect})}renderEnumInput(){var e,t=this.props,r=t.enumOptions,a=t.parameter,i=this.state.value,s=r.split("\n").filter(e=>""!==e);return n.a.createElement(Hc,Ju({className:this.props.className,mode:a.multiValuesOptions?"multiple":"default",value:(e=i,a.multiValuesOptions&&null===e?[]:e),onChange:this.onSelect,options:Object(c.map)(s,e=>({label:String(e),value:e})),showSearch:!0,showArrow:!0,notFoundContent:Object(c.isEmpty)(s)?"No options available":null},Zu))}renderQueryBasedInput(){var e=this.props,t=e.queryId,r=e.parameter,a=this.state.value;return n.a.createElement($u,Ju({className:this.props.className,mode:r.multiValuesOptions?"multiple":"default",parameter:r,value:a,queryId:t,onSelect:this.onSelect,style:{minWidth:60}},Zu))}renderNumberInput(){var e=this.props.className,t=this.state.value,r=e=>isNaN(e)?void 0:e;return n.a.createElement(Mo.a,{className:e,value:r(t),"aria-label":"Parameter number value",onChange:e=>this.onSelect(r(e))})}renderTextInput(){var e=this.props.className,t=this.state.value;return n.a.createElement(He.a,{className:e,value:t,"aria-label":"Parameter text value","data-test":"TextParamInput",onChange:e=>this.onSelect(e.target.value)})}renderInput(){switch(this.props.type){case"datetime-with-seconds":case"datetime-local":case"date":return this.renderDateParameter();case"datetime-range-with-seconds":case"datetime-range":case"date-range":return this.renderDateRangeParameter();case"enum":return this.renderEnumInput();case"query":return this.renderQueryBasedInput();case"number":return this.renderNumberInput();default:return this.renderTextInput()}}render(){var e=this.state.isDirty;return n.a.createElement("div",{className:"parameter-input","data-dirty":e||null,"data-test":"ParameterValueInput"},this.renderInput())}}Xu(ed,"propTypes",{type:se.a.string,value:se.a.any,enumOptions:se.a.string,queryId:se.a.number,parameter:se.a.any,onSelect:se.a.func,className:se.a.string}),Xu(ed,"defaultProps",{type:"text",value:null,enumOptions:"",queryId:null,parameter:null,onSelect:()=>{},className:""});var td=ed;function rd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ad(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rd(Object(r),!0).forEach((function(t){nd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function id(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function od(){return(od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ld=Xi.a.Option,cd={labelCol:{span:6},wrapperCol:{span:16}};function ud(e){return Object(c.capitalize)(Object(c.words)(e).join(" "))}function dd(e){var t=e.name,r=e.type,a=e.onChange,i=e.existingNames,s=e.setValidation,o="",l="";return t?Object(c.includes)(i,t)?(o="Parameter with this name already exists",s(!1),l="error"):(function(e){return/-range/.test(e)}(r)&&(o=n.a.createElement(n.a.Fragment,null,"Appears in query as"," ",n.a.createElement("code",{style:{display:"inline-block",color:"inherit"}},"{{".concat(t,".start}} {{").concat(t,".end}}")))),s(!0)):(o="Choose a keyword for this parameter",s(!1)),n.a.createElement(Co.a.Item,od({required:!0,label:"Keyword",help:o,validateStatus:l},cd),n.a.createElement(He.a,{onChange:e=>a(e.target.value),autoFocus:!0}))}function md(e){var t=id(Object(a.useState)(Object(c.clone)(e.parameter)),2),r=t[0],i=t[1],s=id(Object(a.useState)(!0),2),o=s[0],l=s[1],u=id(Object(a.useState)(),2),d=u[0],m=u[1],p=!e.parameter.name;Object(a.useEffect)(()=>{var t=e.parameter.queryId;t&&ir.get({id:t}).then(m)},[e.parameter.queryId]);var f,b,g,y=qe("paramForm");return n.a.createElement(V.a,od({},e.dialog.props,{title:p?"Add Parameter":r.name,width:600,footer:[n.a.createElement(h.a,{key:"cancel",onClick:e.dialog.dismiss},"Cancel"),n.a.createElement(h.a,{key:"submit",htmlType:"submit",disabled:!!(!o||""===r.title||"query"===r.type&&!r.queryId),type:"primary",form:y,"data-test":"SaveParameterSettings"},p?"Add Parameter":"OK")]}),n.a.createElement(Co.a,{layout:"horizontal",onFinish:function(){r.title||(r.title=ud(r.name),i(r)),e.dialog.close(r)},id:y},p&&n.a.createElement(dd,{name:r.name,onChange:e=>i(ad(ad({},r),{},{name:e})),setValidation:l,existingNames:e.existingParams,type:r.type}),n.a.createElement(Co.a.Item,od({required:!0,label:"Title"},cd),n.a.createElement(He.a,{value:Object(c.isNull)(r.title)?ud(r.name):r.title,onChange:e=>i(ad(ad({},r),{},{title:e.target.value})),"data-test":"ParameterTitleInput"})),n.a.createElement(Co.a.Item,od({label:"Type"},cd),n.a.createElement(Xi.a,{value:r.type,onChange:e=>i(ad(ad({},r),{},{type:e})),"data-test":"ParameterTypeSelect"},n.a.createElement(ld,{value:"text","data-test":"TextParameterTypeOption"},"Text"),n.a.createElement(ld,{value:"number","data-test":"NumberParameterTypeOption"},"Number"),n.a.createElement(ld,{value:"enum"},"Dropdown List"),n.a.createElement(ld,{value:"query"},"Query Based Dropdown List"),n.a.createElement(ld,{disabled:!0,key:"dv1"},n.a.createElement(xo.a,{className:"select-option-divider"})),n.a.createElement(ld,{value:"date","data-test":"DateParameterTypeOption"},"Date"),n.a.createElement(ld,{value:"datetime-local","data-test":"DateTimeParameterTypeOption"},"Date and Time"),n.a.createElement(ld,{value:"datetime-with-seconds"},"Date and Time (with seconds)"),n.a.createElement(ld,{disabled:!0,key:"dv2"},n.a.createElement(xo.a,{className:"select-option-divider"})),n.a.createElement(ld,{value:"date-range","data-test":"DateRangeParameterTypeOption"},"Date Range"),n.a.createElement(ld,{value:"datetime-range"},"Date and Time Range"),n.a.createElement(ld,{value:"datetime-range-with-seconds"},"Date and Time Range (with seconds)"))),"enum"===r.type&&n.a.createElement(Co.a.Item,od({label:"Values",help:"Dropdown list values (newline delimited)"},cd),n.a.createElement(He.a.TextArea,{rows:3,value:r.enumOptions,onChange:e=>i(ad(ad({},r),{},{enumOptions:e.target.value}))})),"query"===r.type&&n.a.createElement(Co.a.Item,od({label:"Query",help:"Select query to load dropdown values from"},cd),n.a.createElement(tl,{selectedQuery:d,onChange:e=>i(ad(ad({},r),{},{queryId:e&&e.id})),type:"select"})),("enum"===r.type||"query"===r.type)&&n.a.createElement(Co.a.Item,od({className:"m-b-0",label:" ",colon:!1},cd),n.a.createElement(ic.a,{defaultChecked:!!r.multiValuesOptions,onChange:e=>i(ad(ad({},r),{},{multiValuesOptions:e.target.checked?{prefix:"",suffix:"",separator:","}:null})),"data-test":"AllowMultipleValuesCheckbox"},"Allow multiple values")),("enum"===r.type||"query"===r.type)&&r.multiValuesOptions&&n.a.createElement(Co.a.Item,od({label:"Quotation",help:n.a.createElement(n.a.Fragment,null,"Placed in query as: ",n.a.createElement("code",null,(f=r.multiValuesOptions,b=f.prefix,g=f.suffix,["value1","value2","value3"].map(e=>"".concat(b).concat(e).concat(g)).join(","))))},cd),n.a.createElement(Xi.a,{value:r.multiValuesOptions.prefix,onChange:e=>i(ad(ad({},r),{},{multiValuesOptions:ad(ad({},r.multiValuesOptions),{},{prefix:e,suffix:e})})),"data-test":"QuotationSelect"},n.a.createElement(ld,{value:""},"None (default)"),n.a.createElement(ld,{value:"'"},"Single Quotation Mark"),n.a.createElement(ld,{value:'"',"data-test":"DoubleQuotationMarkOption"},"Double Quotation Mark")))))}dd.propTypes={name:se.a.string.isRequired,onChange:se.a.func.isRequired,existingNames:se.a.arrayOf(se.a.string).isRequired,setValidation:se.a.func.isRequired,type:se.a.string.isRequired},md.propTypes={parameter:se.a.object.isRequired,dialog:Je.isRequired,existingParams:se.a.arrayOf(se.a.string)},md.defaultProps={existingParams:[]};var pd=Xe(md);function fd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hd(e){var t=Object(c.extend)({},R.search);e.forEach(e=>{Object(c.extend)(t,e.toUrlParams())}),R.setSearch(t,!0)}class bd extends n.a.Component{constructor(e){super(e),fd(this,"toCamelCase",e=>Object(c.isEmpty)(e)?"":e.replace(/\s+/g,"").toLowerCase()),fd(this,"componentDidUpdate",e=>{var t=this.props,r=t.parameters,a=t.disableUrlUpdate,n=e.parameters!==r,i=e.disableUrlUpdate!==a;n&&this.setState({parameters:r}),!n&&!i||a||hd(r)}),fd(this,"handleKeyDown",e=>{13===e.keyCode&&(e.ctrlKey||e.metaKey||e.altKey)&&(e.stopPropagation(),this.applyChanges())}),fd(this,"setPendingValue",(e,t,r)=>{var a=this.props.onPendingValuesChange;this.setState(n=>{var i=n.parameters;return r?e.setPendingValue(t):e.clearPendingValue(),a(),{parameters:i}})}),fd(this,"moveParameter",e=>{var t=e.oldIndex,r=e.newIndex,a=this.props.onParametersEdit;t!==r&&this.setState(e=>{var n=e.parameters;return n.splice(r,0,n.splice(t,1)[0]),a(n),{parameters:n}})}),fd(this,"applyChanges",()=>{var e=this.props,t=e.onValuesChange,r=e.disableUrlUpdate;this.setState(e=>{var a=e.parameters,n=a.filter(e=>e.hasPendingValue);return Object(c.forEach)(a,e=>e.applyPendingValue()),r||hd(a),t(n),{parameters:a}})}),fd(this,"showParameterSettings",(e,t)=>{var r=this.props.onParametersEdit;pd.showModal({parameter:e}).onClose(a=>{this.setState(n=>{var i=n.parameters,s=Object(c.extend)(e,a);return i[t]=qr(s,s.parentQueryId),r(i),{parameters:i}})})});var t=e.parameters,r=e.disableUrlUpdate;this.state={parameters:t},r||hd(t);var a=window.location.search.matchAll(/hide_filter=([^&]+)/g);this.hideValues=Array.from(a,e=>e[1])}renderParameter(e,t){if(this.hideValues.some(t=>this.toCamelCase(t)===this.toCamelCase(e.name)))return null;var r=this.props.editable;return e.hidden?null:n.a.createElement("div",{key:e.name,className:"di-block","data-test":"ParameterName-".concat(e.name)},n.a.createElement("div",{className:"parameter-heading"},n.a.createElement("label",null,e.title||bi(e.name)),r&&n.a.createElement(Ee,{className:"btn btn-default btn-xs m-l-5","aria-label":"Edit",onClick:()=>this.showParameterSettings(e,t),"data-test":"ParameterSettings-".concat(e.name),type:"button"},n.a.createElement("i",{className:"fa fa-cog","aria-hidden":"true"}))),n.a.createElement(td,{type:e.type,value:e.normalizedValue,parameter:e,enumOptions:e.enumOptions,queryId:e.queryId,onSelect:(t,r)=>this.setPendingValue(e,t,r)}))}render(){var e=this.state.parameters,t=this.props,r=t.sortable,a=t.appendSortableToParent,i=Object(c.size)(Object(c.filter)(e,"hasPendingValue"));return n.a.createElement(qc.SortableContainer,{disabled:!r,axis:"xy",useDragHandle:!0,lockToContainerEdges:!0,helperClass:"parameter-dragged",helperContainer:e=>a?e:document.body,updateBeforeSortStart:this.onBeforeSortStart,onSortEnd:this.moveParameter,containerProps:{className:"parameter-container",onKeyDown:i?this.handleKeyDown:null}},e&&e.map((e,t)=>n.a.createElement(qc.SortableElement,{key:e.name,index:t},n.a.createElement("div",{className:"parameter-block","data-editable":r||null,"data-test":"ParameterBlock-".concat(e.name)},r&&n.a.createElement(qc.DragHandle,{"data-test":"DragHandle-".concat(e.name)}),this.renderParameter(e,t)))),n.a.createElement(Uc,{onClick:this.applyChanges,paramCount:i}))}}function gd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vd(e){var t=e.from,r=Object(a.useMemo)(()=>l()(t).valueOf(),[t]),i=gd(Object(a.useState)(null),2),s=i[0],o=i[1];return Object(a.useEffect)(()=>{function e(){var e=l.a.now()-r,t=e>36e5?"HH:mm:ss":"mm:ss";o(l.a.utc(e).format(t))}e();var t=setInterval(e,1e3);return()=>clearInterval(t)},[r]),n.a.createElement("span",{className:"rd-timer"},s)}function Od(e){var t=e.visualization,r=d.registeredVisualizations[t.type];return n.a.createElement("span",{className:"visualization-name"},r&&t.name!==r.name?t.name:null)}fd(bd,"propTypes",{parameters:se.a.arrayOf(se.a.instanceOf(At)),editable:se.a.bool,sortable:se.a.bool,disableUrlUpdate:se.a.bool,onValuesChange:se.a.func,onPendingValuesChange:se.a.func,onParametersEdit:se.a.func,appendSortableToParent:se.a.bool}),fd(bd,"defaultProps",{parameters:[],editable:!1,sortable:!1,disableUrlUpdate:!1,onValuesChange:()=>{},onPendingValuesChange:()=>{},onParametersEdit:()=>{},appendSortableToParent:!0}),vd.propTypes={from:se.a.oneOfType([se.a.string,se.a.number,se.a.instanceOf(Date),ri])},vd.defaultProps={from:null},Od.propTypes={visualization:d.VisualizationType.isRequired};var Ed=Od;function jd(){return(jd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function wd(e){var t=e.query,r=e.visualization,a=e.readOnly;return n.a.createElement(e=>{return a?n.a.createElement("span",e):n.a.createElement(S,jd({href:(i=null,r&&(i="TABLE"===r.type?"table":r.id),t.getUrl(!1,i))},e));var i},{className:"query-link"},n.a.createElement(Ed,{visualization:r})," ",n.a.createElement("span",null,t.name))}wd.propTypes={query:se.a.object.isRequired,visualization:d.VisualizationType,readOnly:se.a.bool},wd.defaultProps={visualization:null,readOnly:!1};var Sd=wd;function Pd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Cd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pd(Object(r),!0).forEach((function(t){Nd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var kd="###Redash::Filters::SelectAll###",_d=se.a.shape({name:se.a.string.isRequired,friendlyName:se.a.string.isRequired,multiple:se.a.bool,current:se.a.oneOfType([se.a.any,se.a.arrayOf(se.a.any)]),values:se.a.arrayOf(se.a.any).isRequired}),Ad=se.a.arrayOf(_d);function xd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!Object(c.isArray)(e))return[];var r=e;return Object(c.isArray)(t)&&t.length>0&&(r=r.filter(e=>Object(c.every)(t,t=>{var r=e[t.name],a=Object(c.isArray)(t.current)?t.current:[t.current];return Object(c.some)(a,e=>l.a.isMoment(r)?r.isSame(e):e===r||String(r)===e)}))),r}function qd(e){var t=e.filters,r=e.onChange;return 0===t.length?null:(r=function(e,t){return(r,a)=>{if(Object(c.isArray)(a))a=Object(c.map)(a,e=>r.values[Object(c.toNumber)(e.key)]||e.key);else{var n=r.values[Object(c.toNumber)(a.key)];a=void 0!==n?n:a.key}r.multiple&&Object(c.includes)(a,kd)&&(a=[...r.values]),r.multiple&&Object(c.includes)(a,"###Redash::Filters::Clear###")&&(a=[]),e=Object(c.map)(e,e=>e.name===r.name?Cd(Cd({},r),{},{current:a}):e),t(e)}}(t,r),n.a.createElement("div",{className:"filters-wrapper","data-test":"Filters"},n.a.createElement("div",{className:"container bg-white"},n.a.createElement("div",{className:"row"},Object(c.map)(t,e=>{var t=Object(c.map)(e.values,(t,r)=>n.a.createElement(Xi.a.Option,{key:r},Oi(t,Object(c.get)(e,"column.type"))));return n.a.createElement("div",{key:e.name,className:"col-sm-6 p-l-0 filter-container","data-test":"FilterName-".concat(e.name)},n.a.createElement("label",null,e.friendlyName),0===t.length&&n.a.createElement(Xi.a,{className:"w-100",disabled:!0,value:"No values"}),t.length>0&&n.a.createElement(Xi.a,{labelInValue:!0,className:"w-100",mode:e.multiple?"multiple":"default",value:Object(c.isArray)(e.current)?Object(c.map)(e.current,t=>({key:"".concat(Object(c.indexOf)(e.values,t)),label:Oi(t)})):{key:"".concat(Object(c.indexOf)(e.values,e.current)),label:Oi(e.current)},allowClear:e.multiple,optionFilterProp:"children",showSearch:!0,maxTagCount:3,maxTagTextLength:10,maxTagPlaceholder:e=>"+".concat(e.length," more"),onChange:t=>r(e,t)},!e.multiple&&t,e.multiple&&[n.a.createElement(Xi.a.Option,{key:"###Redash::Filters::Clear###","data-test":"ClearOption"},n.a.createElement("i",{className:"fa fa-square-o m-r-5","aria-hidden":"true"}),"Clear"),n.a.createElement(Xi.a.Option,{key:kd,"data-test":"SelectAllOption"},n.a.createElement("i",{className:"fa fa-check-square-o m-r-5","aria-hidden":"true"}),"Select All"),n.a.createElement(Xi.a.OptGroup,{key:"Values",title:"Values"},t)]))})))))}qd.propTypes={filters:Ad.isRequired,onChange:se.a.func},qd.defaultProps={onChange:()=>{}};var Td=qd;function Id(e){var t=Object(c.invoke)(e,"getStatus");return Object(a.useMemo)(()=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{status:t||Object(c.invoke)(e,"getStatus")||null,columns:Object(c.invoke)(e,"getColumns")||[],rows:Object(c.invoke)(e,"getData")||[],filters:Object(c.invoke)(e,"getFilters")||[],updatedAt:Object(c.invoke)(e,"getUpdatedAt")||null,retrievedAt:Object(c.get)(e,"query_result.retrieved_at",null),truncated:Object(c.invoke)(e,"getTruncated")||null,log:Object(c.invoke)(e,"getLog")||[],error:Object(c.invoke)(e,"getError")||null,runtime:Object(c.invoke)(e,"getRuntime")||null,metadata:Object(c.get)(e,"query_result.data.metadata",{})}}(e,t),[e,t])}function Dd(e){var t=Object(a.useRef)();return t.current=Object(c.isFunction)(e)?e:c.noop,Object(a.useCallback)((function(){return t.current(...arguments)}),[])}var Rd=r(703),Md=r(704),zd=r(705);function Fd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ld(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ud(e){return function(t){return Object(d.updateVisualizationsSettings)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fd(Object(r),!0).forEach((function(t){Ld(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({HelpTriggerComponent:Qe,LinkComponent:S,choroplethAvailableMaps:{countries:{name:"Countries",url:Rd.a,fieldNames:{name:"Short name",name_long:"Full name",abbrev:"Abbreviated name",iso_a2:"ISO code (2 letters)",iso_a3:"ISO code (3 letters)",iso_n3:"ISO code (3 digits)"}},usa:{name:"USA",url:Md.a,fieldNames:{name:"Name",ns_code:"National Standard ANSI Code (8-character)",geoid:"Geographic ID",usps_abbrev:"USPS Abbreviation",fips_code:"FIPS Code (2-character)"}},subdiv_japan:{name:"Japan/Prefectures",url:zd.a,fieldNames:{name:"Name",name_alt:"Name (alternative)",name_local:"Name (local)",iso_3166_2:"ISO-3166-2",postal:"Postal Code",type:"Type",type_en:"Type (EN)",region:"Region",region_code:"Region Code"}}}},Object(c.pick)($,["dateFormat","dateTimeFormat","integerFormat","floatFormat","booleanValues","tableCellMaxJSONSize","allowCustomJSVisualizations","hidePlotlyModeBar"]))),n.a.createElement(e,t)}}var Vd=Ud(d.Renderer),Bd=Ud(d.Editor);function Qd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wd(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Hd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Gd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(r),!0).forEach((function(t){Kd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Kd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yd(e,t){return 0===e.length||0===t.length?e:Object(c.map)(e,e=>{var r=Object(c.find)(t,t=>t.name===e.name);return r?Gd(Gd({},e),{},{current:r.current}):e})}function $d(e){var t=Id(e.queryResult),r=Qd(Object(a.useState)(()=>Yd(t.filters,e.filters)),2),i=r[0],s=r[1],o=Object(a.useRef)();o.current=i;var l=Dd(t=>{var r,a;a=i,(r=t).length===a.length&&(r=Object(c.fromPairs)(Object(c.map)(r,e=>[e.name,e])),a=Object(c.fromPairs)(Object(c.map)(a,e=>[e.name,e])),Object(c.isEqual)(r,a))||(s(t),e.onFiltersChange(t))});Object(a.useEffect)(()=>{l(Yd(t.filters,e.filters))},[t.filters,e.filters,l]),Object(a.useEffect)(()=>{l(Yd(o.current,e.filters))},[e.filters,l]);var u=Object(a.useMemo)(()=>({columns:t.columns,rows:xd(t.rows,i)}),[t,i]),d=e.showFilters,m=e.visualization,p=Gd({},m.options);return"TABLE"===m.type&&(p.paginationSize="widget"===e.context?"small":"default"),n.a.createElement(Vd,{key:"visualization".concat(m.id),type:m.type,options:p,data:u,visualizationName:m.name,addonBefore:d&&n.a.createElement(Td,{filters:i,onChange:l})})}function Jd(){return(Jd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Xd(e){var t=e.dialog,r=e.widget,a=e.filters;return n.a.createElement(V.a,Jd({},t.props,{title:n.a.createElement(n.a.Fragment,null,n.a.createElement(Ed,{visualization:r.visualization})," ",n.a.createElement("span",null,r.getQuery().name)),width:"95%",footer:n.a.createElement(h.a,{onClick:t.dismiss},"Close")}),n.a.createElement($d,{visualization:r.visualization,queryResult:r.getQueryResult(),filters:a,context:"widget"}))}$d.propTypes={visualization:d.VisualizationType.isRequired,queryResult:se.a.object.isRequired,showFilters:se.a.bool,filters:Ad,onFiltersChange:se.a.func,context:se.a.oneOf(["query","widget"]).isRequired},$d.defaultProps={showFilters:!0,filters:[],onFiltersChange:()=>{}},Xd.propTypes={dialog:Je.isRequired,widget:se.a.object.isRequired,filters:Ad},Xd.defaultProps={filters:[]};var Zd=Xe(Xd),em=r(196),tm=r.n(em),rm=r(170),am=r.n(rm),nm=r(66),im=r.n(nm),sm=r(434),om=r.n(sm),lm=r(314),cm=r.n(lm),um=r(169),dm=r.n(um);function mm(){return(mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function pm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fm(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function hm(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var bm="dashboard-add-new",gm="dashboard-map-to-existing",ym="widget-level",vm="static-value";function Om(e){return Object(c.fromPairs)(Object(c.map)(e,e=>{var t=Object(c.extend)({},e);switch(e.type){case bm:case gm:t.type=Lr.DashboardLevel,t.value=null;break;case vm:t.type=Lr.StaticValue,t.param=Tr(e.param),t.param.setValue(t.value),t.value=t.param.value;break;case ym:t.type=Lr.WidgetLevel,t.value=null}return delete t.param,[t.name,t]}))}function Em(e,t){var r=[];return Object(c.each)(e,e=>{e.type===Lr.DashboardLevel&&Object(c.each)(t,t=>{var a=t.options.parameterMappings;Object(c.each)(a,a=>{a.type===Lr.DashboardLevel&&a.mapTo===e.mapTo&&a.title!==e.title&&(a.title=e.title,r.push(t))})})}),r}class jm extends n.a.Component{constructor(){super(...arguments),hm(this,"formItemProps",{labelCol:{span:5},wrapperCol:{span:16},className:"form-item"}),hm(this,"updateSourceType",e=>{var t=this.props.mapping.mapTo,r=this.props.existingParamNames;e!==gm||Object(c.includes)(r,t)||(t=r[0]),this.updateParamMapping({type:e,mapTo:t})}),hm(this,"updateParamMapping",e=>{var t=this.props,r=t.onChange,a=t.mapping,n=Object(c.extend)({},a,e);n.value!==a.value&&(n.param=Tr(n.param),n.param.setValue(n.value)),Object(c.has)(e,"type")&&(e.type===vm?n.value=n.param.value:n.value=null),r(n)})}renderMappingTypeSelector(){var e=Object(c.isEmpty)(this.props.existingParamNames);return n.a.createElement(im.a.Group,{value:this.props.mapping.type,onChange:e=>this.updateSourceType(e.target.value)},n.a.createElement(im.a,{className:"radio",value:bm,"data-test":"NewDashboardParameterOption"},"New dashboard parameter"),n.a.createElement(im.a,{className:"radio",value:gm,disabled:e},"Existing dashboard parameter"," ",e?n.a.createElement(Ne,{title:"There are no dashboard parameters corresponding to this data type"},n.a.createElement(om.a,null)):null),n.a.createElement(im.a,{className:"radio",value:ym,"data-test":"WidgetParameterOption"},"Widget parameter"),n.a.createElement(im.a,{className:"radio",value:vm,"data-test":"StaticValueOption"},"Static value"))}renderDashboardAddNew(){var e=this.props.mapping.mapTo;return n.a.createElement(He.a,{value:e,"aria-label":"Parameter name (key)",onChange:e=>this.updateParamMapping({mapTo:e.target.value})})}renderDashboardMapToExisting(){var e=this.props,t=e.mapping,r=e.existingParamNames,a=Object(c.map)(r,e=>({label:e,value:e}));return n.a.createElement(Xi.a,{value:t.mapTo,onChange:e=>this.updateParamMapping({mapTo:e}),options:a})}renderStaticValue(){var e=this.props.mapping;return n.a.createElement(td,{type:e.param.type,value:e.param.normalizedValue,enumOptions:e.param.enumOptions,queryId:e.param.queryId,parameter:e.param,onSelect:e=>this.updateParamMapping({value:e})})}renderInputBlock(){switch(this.props.mapping.type){case bm:return["Key","Enter a new parameter keyword",this.renderDashboardAddNew()];case gm:return["Key","Select from a list of existing parameters",this.renderDashboardMapToExisting()];case vm:return["Value",null,this.renderStaticValue()];default:return[]}}render(){var e=this.props.inputError,t=pm(this.renderInputBlock(),3),r=t[0],a=t[1],i=t[2];return n.a.createElement(Co.a,{layout:"horizontal"},n.a.createElement(Co.a.Item,mm({label:"Source"},this.formItemProps),this.renderMappingTypeSelector()),n.a.createElement(Co.a.Item,mm({style:{height:60,visibility:i?"visible":"hidden"},label:r},this.formItemProps,{validateStatus:e?"error":"",help:e||a}),i))}}hm(jm,"propTypes",{mapping:se.a.object,existingParamNames:se.a.arrayOf(se.a.string),onChange:se.a.func,inputError:se.a.string}),hm(jm,"defaultProps",{mapping:{},existingParamNames:[],onChange:()=>{},inputError:null});class wm extends n.a.Component{constructor(e){super(e),hm(this,"onVisibleChange",e=>{e?this.show():this.hide()}),hm(this,"onChange",e=>{var t=null;e.type===bm&&(Object(c.isEmpty)(e.mapTo)?t="Keyword must have a value":Object(c.includes)(this.props.existingParamNames,e.mapTo)&&(t="A parameter with this name already exists")),this.setState({mapping:e,inputError:t})}),hm(this,"save",()=>{this.props.onChange(this.props.mapping,this.state.mapping),this.hide()}),hm(this,"show",()=>{this.setState({visible:!0,mapping:Object(c.clone)(this.props.mapping)})}),hm(this,"hide",()=>{this.setState({visible:!1})}),this.state={visible:!1,mapping:Object(c.clone)(this.props.mapping),inputError:null}}renderContent(){var e=this.state,t=e.mapping,r=e.inputError;return n.a.createElement("div",{className:"parameter-mapping-editor","data-test":"EditParamMappingPopover"},n.a.createElement("header",null,"Edit Source and Value ",n.a.createElement(Qe,{type:"VALUE_SOURCE_OPTIONS"})),n.a.createElement(jm,{mapping:t,existingParamNames:this.props.existingParamNames,onChange:this.onChange,inputError:r}),n.a.createElement("footer",null,n.a.createElement(h.a,{onClick:this.hide},"Cancel"),n.a.createElement(h.a,{onClick:this.save,disabled:!!r,type:"primary"},"OK")))}render(){var e=this.state,t=e.visible,r=e.mapping;return n.a.createElement(tm.a,{placement:"left",trigger:"click",content:this.renderContent(),visible:t,onVisibleChange:this.onVisibleChange},n.a.createElement(h.a,{size:"small",type:"dashed","data-test":"EditParamMappingButton-".concat(r.param.name)},n.a.createElement(cm.a,null)))}}hm(wm,"propTypes",{mapping:se.a.object.isRequired,existingParamNames:se.a.arrayOf(se.a.string).isRequired,onChange:se.a.func.isRequired});class Sm extends n.a.Component{constructor(){super(...arguments),hm(this,"state",{showPopup:!1,title:""}),hm(this,"onPopupVisibleChange",e=>{this.setState({showPopup:e,title:e?this.getMappingTitle():""})}),hm(this,"onEditingTitleChange",e=>{this.setState({title:e.target.value})}),hm(this,"save",()=>{var e=Object(c.extend)({},this.props.mapping,{title:this.state.title});this.props.onChange(e),this.hide()}),hm(this,"hide",()=>{this.setState({showPopup:!1})})}getMappingTitle(){var e=this.props.mapping;if(Object(c.isString)(e.title)&&""!==e.title)return e.title;if(e.type===gm){var t=Object(c.find)(this.props.existingParams,{name:e.mapTo});t&&(e=t)}return e.title||e.param.title}renderPopover(){var e=this.props.mapping.param.title;return n.a.createElement("div",{className:"parameter-mapping-title-editor"},n.a.createElement(He.a,{size:"small",value:this.state.title,placeholder:e,"aria-label":"Edit parameter title",onChange:this.onEditingTitleChange,onPressEnter:this.save,maxLength:100,autoFocus:!0}),n.a.createElement(h.a,{size:"small",type:"dashed",onClick:this.hide},n.a.createElement(xe.a,null)),n.a.createElement(h.a,{size:"small",type:"dashed",onClick:this.save},n.a.createElement(dm.a,null)))}renderEditButton(){return this.props.mapping.type===vm?n.a.createElement(Ne,{placement:"right",title:"Titles for static values don't appear in widgets"},n.a.createElement("span",{tabIndex:0},n.a.createElement("i",{className:"fa fa-eye-slash","aria-hidden":"true"}))):n.a.createElement(tm.a,{placement:"right",trigger:"click",content:this.renderPopover(),visible:this.state.showPopup,onVisibleChange:this.onPopupVisibleChange},n.a.createElement(h.a,{size:"small",type:"dashed"},n.a.createElement(cm.a,null)))}render(){var e=this.props.mapping.type===vm;return n.a.createElement("div",{className:ge()("parameter-mapping-title",{disabled:e})},n.a.createElement("span",{className:"text"},this.getMappingTitle()),this.renderEditButton())}}hm(Sm,"propTypes",{existingParams:se.a.arrayOf(se.a.object),mapping:se.a.object.isRequired,onChange:se.a.func.isRequired}),hm(Sm,"defaultProps",{existingParams:[]});class Pm extends n.a.Component{static getStringValue(e){return e?e instanceof Object&&"start"in e&&"end"in e?"".concat(e.start," ~ ").concat(e.end):"object"==typeof e?Object(c.map)(e,e=>this.getStringValue(e)).join(", "):e.toString():""}static getDefaultValue(e,t){var r=e.type,a=e.mapTo,n=e.name,i=e.param;if(r===gm&&a!==n){var s=Object(c.find)(t,{name:a});s&&(i=s)}else r===vm&&(i=Tr(i).setValue(e.value));var o=At.getExecutionValue(i);return i.hasDynamicValue&&(o=i.normalizedValue.name),this.getStringValue(o)}static getSourceTypeLabel(e){var t=e.type,r=e.mapTo;switch(t){case bm:case gm:return n.a.createElement(a.Fragment,null,"Dashboard ",n.a.createElement(am.a,{className:"tag"},r));case ym:return"Widget parameter";case vm:return"Static value";default:return""}}updateParamMapping(e,t){var r=[...this.props.mappings],a=Object(c.findIndex)(r,e);a>=0?r[a]=t:r.push(t),this.props.onChange(r)}render(){var e=this.props.existingParams,t=this.props.mappings.map(e=>({mapping:e}));return n.a.createElement("div",{className:"parameters-mapping-list"},n.a.createElement(Vn.a,{dataSource:t,size:"middle",pagination:!1,rowKey:(e,t)=>"row".concat(t)},n.a.createElement(Vn.a.Column,{title:"Title",dataIndex:"mapping",key:"title",render:t=>n.a.createElement(Sm,{existingParams:e,mapping:t,onChange:e=>this.updateParamMapping(t,e)})}),n.a.createElement(Vn.a.Column,{title:"Keyword",dataIndex:"mapping",key:"keyword",className:"keyword",render:e=>n.a.createElement("code",null,"{{ ".concat(e.name," }}"))}),n.a.createElement(Vn.a.Column,{title:"Default Value",dataIndex:"mapping",key:"value",render:e=>this.constructor.getDefaultValue(e,this.props.existingParams)}),n.a.createElement(Vn.a.Column,{title:"Value Source",dataIndex:"mapping",key:"source",render:t=>{var r=e.filter(e=>e.type===t.param.type).map(e=>e.name);return n.a.createElement(a.Fragment,null,this.constructor.getSourceTypeLabel(t)," ",n.a.createElement(wm,{mapping:t,existingParamNames:r,onChange:(e,t)=>this.updateParamMapping(e,t)}))}})))}}function Cm(){return(Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Nm(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function km(e,t){return Object(c.map)(Object(c.sortBy)(e,e=>e.name),e=>{var r;switch(e.type){case vm:return[e.name,e.value];case ym:return[e.name,e.param.value];case bm:case gm:return r=Object(c.find)(t,t=>t.name===e.mapTo),[e.name,r?r.value:null]}})}hm(Pm,"propTypes",{mappings:se.a.arrayOf(se.a.object),existingParams:se.a.arrayOf(se.a.object),onChange:se.a.func}),hm(Pm,"defaultProps",{mappings:[],existingParams:[],onChange:()=>{}});class _m extends n.a.Component{constructor(e){super(e),Nm(this,"originalParamValuesSnapshot",null);var t=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object(c.map)(e,e=>{var a=Object(c.extend)({},e),n=Object(c.includes)(r,e.mapTo);switch(a.param=Object(c.find)(t,t=>t.name===e.name),e.type){case Lr.DashboardLevel:a.type=n?gm:bm,a.value=null;break;case Lr.StaticValue:a.type=vm,a.param=Tr(a.param),a.param.setValue(a.value);break;case Lr.WidgetLevel:a.type=ym,a.value=null}return a})}(e.widget.options.parameterMappings,e.widget.query.getParametersDefs(),Object(c.map)(this.props.dashboard.getParametersDefs(),e=>e.name));this.originalParamValuesSnapshot=km(t,this.props.dashboard.getParametersDefs()),this.state={saveInProgress:!1,parameterMappings:t}}saveWidget(){var e=this.props.widget;this.setState({saveInProgress:!0});var t=Om(this.state.parameterMappings);e.options.parameterMappings=t;var r=!Object(c.isMatch)(this.originalParamValuesSnapshot,km(this.state.parameterMappings,this.props.dashboard.getParametersDefs())),a=[e,...Em(e.options.parameterMappings,this.props.dashboard.widgets)];Promise.all(Object(c.map)(a,e=>e.save())).then(()=>{this.props.dialog.close(r)}).catch(()=>{un.error("Widget cannot be updated")}).finally(()=>{this.setState({saveInProgress:!1})})}updateParamMappings(e){this.setState({parameterMappings:e})}render(){var e=this.props.dialog;return n.a.createElement(V.a,Cm({},e.props,{title:"Parameters",onOk:()=>this.saveWidget(),okButtonProps:{loading:this.state.saveInProgress},width:700}),this.state.parameterMappings.length>0&&n.a.createElement(Pm,{mappings:this.state.parameterMappings,existingParams:this.props.dashboard.getParametersDefs(),onChange:e=>this.updateParamMappings(e)}))}}Nm(_m,"propTypes",{dashboard:se.a.object.isRequired,widget:se.a.object.isRequired,dialog:Je.isRequired});var Am=Xe(_m);function xm(){return(xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function qm(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tm(e){var t=e.extraOptions,r=e.showDeleteOption,a=e.onDelete,i=n.a.createElement(he.a,{"data-test":"WidgetDropdownButtonMenu"},t,r&&t&&n.a.createElement(he.a.Divider,null),r&&n.a.createElement(he.a.Item,{onClick:a},"Remove from Dashboard"));return n.a.createElement("div",{className:"widget-menu-regular"},n.a.createElement(Da.a,{overlay:i,placement:"bottomRight",trigger:["click"]},n.a.createElement(Ee,{className:"action p-l-15 p-r-15","data-test":"WidgetDropdownButton","aria-label":"More options"},n.a.createElement("i",{className:"zmdi zmdi-more-vert","aria-hidden":"true"}))))}function Im(e){var t=e.onClick;return n.a.createElement("div",{className:"widget-menu-remove"},n.a.createElement(Ee,{className:"action",title:"Remove From Dashboard",onClick:t,"data-test":"WidgetDeleteButton","aria-label":"Close"},n.a.createElement("i",{className:"zmdi zmdi-close","aria-hidden":"true"})))}Tm.propTypes={extraOptions:se.a.node,showDeleteOption:se.a.bool,onDelete:se.a.func},Tm.defaultProps={extraOptions:null,showDeleteOption:!1,onDelete:()=>{}},Im.propTypes={onClick:se.a.func},Im.defaultProps={onClick:()=>{}};class Dm extends n.a.Component{constructor(){super(...arguments),qm(this,"deleteWidget",()=>{var e=this.props,t=e.widget,r=e.onDelete;V.a.confirm({title:"Delete Widget",content:"Are you sure you want to remove this widget from the dashboard?",okText:"Delete",okType:"danger",onOk:()=>t.delete().then(r),maskClosable:!0,autoFocusButton:null})})}componentDidMount(){vt("view","widget",this.props.widget.id)}render(){var e=this.props,t=e.className,r=e.children,a=e.header,i=e.footer,s=e.canEdit,o=e.isPublic,l=e.menuOptions,u=e.tileProps,d=!o&&(s||!Object(c.isEmpty)(l));return n.a.createElement("div",{className:"widget-wrapper"},n.a.createElement("div",xm({className:ge()("tile body-container",t)},u),n.a.createElement("div",{className:"widget-actions"},d&&n.a.createElement(Tm,{extraOptions:l,showDeleteOption:s,onDelete:this.deleteWidget}),s&&n.a.createElement(Im,{onClick:this.deleteWidget})),n.a.createElement("div",{className:"body-row widget-header"},a),r,i&&n.a.createElement("div",{className:"body-row tile__bottom-control"},i)))}}qm(Dm,"propTypes",{widget:se.a.object.isRequired,className:se.a.string,children:se.a.node,header:se.a.node,footer:se.a.node,canEdit:se.a.bool,isPublic:se.a.bool,refreshStartedAt:ri,menuOptions:se.a.node,tileProps:se.a.object,onDelete:se.a.func}),qm(Dm,"defaultProps",{className:"",children:null,header:null,footer:null,canEdit:!1,isPublic:!1,refreshStartedAt:null,menuOptions:null,tileProps:{},onDelete:()=>{}});var Rm=Dm;function Mm(){return(Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function zm(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lm(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lm(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Um(e){var t=e.widget,r=e.canEditDashboard,a=e.onParametersEdit,i=Y.hasPermission("view_query"),s=r&&!Object(c.isEmpty)(Object(c.invoke)(t,"query.getParametersDefs")),o=t.getQueryResult(),l=!o||!o.isEmpty||o.isEmpty(),u=e=>o.getLink(t.getQuery().id,e),d=e=>o.getName(t.getQuery().name,e);return Object(c.compact)([n.a.createElement(he.a.Item,{key:"download_csv",disabled:l},l?"Download as CSV File":n.a.createElement(S,{href:u("csv"),download:d("csv"),target:"_self"},"Download as CSV File")),n.a.createElement(he.a.Item,{key:"download_tsv",disabled:l},l?"Download as TSV File":n.a.createElement(S,{href:u("tsv"),download:d("tsv"),target:"_self"},"Download as TSV File")),n.a.createElement(he.a.Item,{key:"download_excel",disabled:l},l?"Download as Excel File":n.a.createElement(S,{href:u("xlsx"),download:d("xlsx"),target:"_self"},"Download as Excel File")),(i||s)&&n.a.createElement(he.a.Divider,{key:"divider"}),i&&n.a.createElement(he.a.Item,{key:"view_query"},n.a.createElement(S,{href:t.getQuery().getUrl(!0,t.visualization.id)},"View Query")),s&&n.a.createElement(he.a.Item,{key:"edit_parameters",onClick:a},"Edit Parameters")])}function Vm(e){var t=e.refreshStartedAt;return n.a.createElement("div",{className:"refresh-indicator"},n.a.createElement("div",{className:"refresh-icon"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Refreshing...")),n.a.createElement(vd,{from:t}))}function Bm(e){var t=e.widget,r=e.refreshStartedAt,a=e.parameters,i=e.isEditing,s=e.onParametersUpdate,o=e.onParametersEdit,l=Y.hasPermission("view_query");return n.a.createElement(n.a.Fragment,null,n.a.createElement(Vm,{refreshStartedAt:r}),n.a.createElement("div",{className:"t-header widget clearfix"},n.a.createElement("div",{className:"th-title"},n.a.createElement("p",null,n.a.createElement(Sd,{query:t.getQuery(),visualization:t.visualization,readOnly:!l})),!Object(c.isEmpty)(t.getQuery().description)&&n.a.createElement(xc.a,{className:"text-muted markdown query--description"},_c.markdown.toHTML(t.getQuery().description||"")))),!Object(c.isEmpty)(a)&&n.a.createElement("div",{className:"m-b-10"},n.a.createElement(bd,{parameters:a,sortable:i,appendSortableToParent:!1,onValuesChange:s,onParametersEdit:o})))}function Qm(e){var t=e.widget,r=e.isPublic,i=e.onRefresh,s=e.onExpand,o=t.getQueryResult(),l=Object(c.invoke)(o,"getUpdatedAt"),u=Fm(Object(a.useState)(),2),d=u[0],m=u[1],p=e=>{d||(m(e),i().finally(()=>m(null)))};return o?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",null,!r&&!!o&&n.a.createElement(Ee,{className:"refresh-button hidden-print btn btn-sm btn-default btn-transparent",onClick:()=>p(1),"data-test":"RefreshButton"},n.a.createElement("i",{className:ge()("zmdi zmdi-refresh",{"zmdi-hc-spin":1===d}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},1===d?"Refreshing, please wait. ":"Press to refresh. ")," ",n.a.createElement(ii,{date:l})),n.a.createElement("span",{className:"visible-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",ui(l)),r&&n.a.createElement("span",{className:"small hidden-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",n.a.createElement(ii,{date:l}))),n.a.createElement("span",null,!r&&n.a.createElement(Ee,{className:"btn btn-sm btn-default hidden-print btn-transparent btn__refresh",onClick:()=>p(2)},n.a.createElement("i",{className:ge()("zmdi zmdi-refresh",{"zmdi-hc-spin":2===d}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},2===d?"Refreshing, please wait.":"Press to refresh.")),n.a.createElement(Ee,{className:"btn btn-sm btn-default hidden-print btn-transparent btn__refresh",onClick:s},n.a.createElement("i",{className:"zmdi zmdi-fullscreen","aria-hidden":"true"})))):null}Vm.propTypes={refreshStartedAt:ri},Vm.defaultProps={refreshStartedAt:null},Bm.propTypes={widget:se.a.object.isRequired,refreshStartedAt:ri,parameters:se.a.arrayOf(se.a.object),isEditing:se.a.bool,onParametersUpdate:se.a.func,onParametersEdit:se.a.func},Bm.defaultProps={refreshStartedAt:null,onParametersUpdate:()=>{},onParametersEdit:()=>{},isEditing:!1,parameters:[]},Qm.propTypes={widget:se.a.object.isRequired,isPublic:se.a.bool,onRefresh:se.a.func.isRequired,onExpand:se.a.func.isRequired},Qm.defaultProps={isPublic:!1};class Wm extends n.a.Component{constructor(e){super(e),zm(this,"onLocalFiltersChange",e=>{this.setState({localFilters:e})}),zm(this,"expandWidget",()=>{Zd.showModal({widget:this.props.widget,filters:this.state.localFilters})}),zm(this,"editParameterMappings",()=>{var e=this.props,t=e.widget,r=e.dashboard,a=e.onRefresh,n=e.onParameterMappingsChange;Am.showModal({dashboard:r,widget:t}).onClose(e=>{e&&a(),n(),this.setState({localParameters:t.getLocalParameters()})})}),this.state={localParameters:e.widget.getLocalParameters(),localFilters:e.filters}}componentDidMount(){var e=this.props,t=e.widget,r=e.onLoad;vt("view","query",t.visualization.query.id,{dashboard:!0}),vt("view","visualization",t.visualization.id,{dashboard:!0}),r()}renderVisualization(){var e=this.props,t=e.widget,r=e.filters,a=t.getQueryResult();switch(a&&a.getStatus()){case"failed":return n.a.createElement("div",{className:"body-row-auto scrollbox"},a.getError()&&n.a.createElement("div",{className:"alert alert-danger m-5"},"Error running query: ",n.a.createElement("strong",null,a.getError())));case"done":return n.a.createElement("div",{className:"body-row-auto scrollbox"},n.a.createElement($d,{visualization:t.visualization,queryResult:a,filters:r,onFiltersChange:this.onLocalFiltersChange,context:"widget"}));default:return n.a.createElement("div",{className:"body-row-auto spinner-container",role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("div",{className:"spinner"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading...")))}}render(){var e=this.props,t=e.widget,r=e.isLoading,a=e.isPublic,i=e.canEdit,s=e.isEditing,o=e.onRefresh,l=this.state.localParameters,u=t.getQueryResult(),d=r&&!(!u||!u.getStatus());return n.a.createElement(Rm,Mm({},this.props,{className:"widget-visualization",menuOptions:Um({widget:t,canEditDashboard:i,onParametersEdit:this.editParameterMappings}),header:n.a.createElement(Bm,{widget:t,refreshStartedAt:d?t.refreshStartedAt:null,parameters:l,isEditing:s,onParametersUpdate:o,onParametersEdit:e=>{var r=Object(c.map)(e,"name");t.options.paramOrder=r,t.save("options",{paramOrder:r})}}),footer:n.a.createElement(Qm,{widget:t,isPublic:a,onRefresh:o,onExpand:this.expandWidget}),tileProps:{"data-refreshing":d}}),this.renderVisualization())}}zm(Wm,"propTypes",{widget:se.a.object.isRequired,dashboard:se.a.object.isRequired,filters:Ad,isPublic:se.a.bool,isLoading:se.a.bool,canEdit:se.a.bool,isEditing:se.a.bool,onLoad:se.a.func,onRefresh:se.a.func,onDelete:se.a.func,onParameterMappingsChange:se.a.func}),zm(Wm,"defaultProps",{filters:[],isPublic:!1,isLoading:!1,canEdit:!1,isEditing:!1,onLoad:()=>{},onRefresh:()=>{},onDelete:()=>{},onParameterMappingsChange:()=>{}});var Hm=Wm,Gm=["dialog","isNew"];function Km(){return(Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ym(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return $m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Jm(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xm(e){var t=e.dialog,r=e.isNew,i=Jm(e,Gm),s=Ym(Object(a.useState)(Object(c.toString)(i.text)),2),o=s[0],l=s[1],u=Ym(Object(a.useState)(null),2),d=u[0],m=u[1];Object(a.useEffect)(()=>{l(i.text),m(_c.markdown.toHTML(i.text))},[i.text]);var p=Ym(Object(Go.a)(()=>{m(_c.markdown.toHTML(o))},200),1)[0],f=Object(a.useCallback)(e=>{l(e.target.value),p()},[p]),h=Object(a.useCallback)(()=>{t.close(o).catch(()=>{un.error(r?"Widget could not be added":"Widget could not be saved")})},[t,r,o]),b=Object(a.useCallback)(()=>{var e=i.text;o!==e?V.a.confirm({title:"Quit editing?",content:"Changes you made so far will not be saved. Are you sure?",okText:"Yes, quit",okType:"danger",onOk:()=>t.dismiss(),maskClosable:!0,autoFocusButton:null,style:{top:170}}):t.dismiss()},[t,o,i.text]);return n.a.createElement(V.a,Km({},t.props,{title:r?"Add Textbox":"Edit Textbox",onOk:h,onCancel:b,okText:r?"Add to Dashboard":"Save",width:500,wrapProps:{"data-test":"TextboxDialog"}}),n.a.createElement("div",{className:"textbox-dialog"},n.a.createElement(He.a.TextArea,{className:"resize-vertical",rows:"5",value:o,"aria-label":"Textbox widget content",onChange:f,autoFocus:!0,placeholder:"This is where you write some text"}),n.a.createElement("small",null,"Supports basic"," ",n.a.createElement(S,{target:"_blank",rel:"noopener noreferrer",href:"https://www.markdownguide.org/cheat-sheet/#basic-syntax"},n.a.createElement(Ne,{title:"Markdown guide opens in new window"},"Markdown")),"."),o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(xo.a,{dashed:!0}),n.a.createElement("strong",{className:"preview-title"},"Preview:"),n.a.createElement(xc.a,{className:"preview markdown"},d))))}Xm.propTypes={dialog:Je.isRequired,isNew:se.a.bool,text:se.a.string},Xm.defaultProps={isNew:!1,text:""};var Zm=Xe(Xm);function ep(){return(ep=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function tp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ap(e){var t=e.widget,r=e.canEdit,i=tp(Object(a.useState)(t.text),2),s=i[0],o=i[1],l=[n.a.createElement(he.a.Item,{key:"edit",onClick:()=>{Zm.showModal({text:t.text}).onClose(e=>(t.text=e,o(e),t.save()))}},"Edit")];return t.width?n.a.createElement(Rm,ep({},e,{menuOptions:r?l:null,className:"widget-text"}),n.a.createElement(xc.a,{className:"body-row-auto scrollbox t-body p-15 markdown"},_c.markdown.toHTML(s||""))):null}ap.propTypes={widget:se.a.object.isRequired,canEdit:se.a.bool},ap.defaultProps={canEdit:!1};var np=ap;function ip(){return(ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var sp=function(e){return n.a.createElement(Rm,ip({},e,{className:"d-flex justify-content-center align-items-center widget-restricted"}),n.a.createElement("div",{className:"t-body scrollbox"},n.a.createElement("div",{className:"text-center"},n.a.createElement("h1",null,n.a.createElement("span",{className:"zmdi zmdi-lock"})),n.a.createElement("p",{className:"text-muted"},"This widget requires access to a data source you don't have access to."))))};function op(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return lp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function cp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var up=[".widget-header",".visualization-renderer",".scrollbox .alert",".spinner-container",".tile__bottom-control"].join(",");class dp{constructor(e){cp(this,"widgets",{}),cp(this,"interval",null),cp(this,"onHeightChange",null),cp(this,"add",e=>{this.isEmpty()&&this.start();var t='[data-widgetid="{0}"]'.replace("{0}",e);this.widgets[e]=[function(){var e=document.querySelector(t);if(e){var r=e.querySelectorAll(up);return Object(c.reduce)(r,(e,t)=>e+(t?t.getBoundingClientRect().height:0),0)}}]}),cp(this,"remove",e=>{this.exists(e)&&(this.widgets[e.toString()]=!1,this.isEmpty()&&this.stop())}),cp(this,"exists",e=>!!this.widgets[e.toString()]),cp(this,"isEmpty",()=>!Object(c.some)(this.widgets)),cp(this,"checkHeightChanges",()=>{Object.keys(this.widgets).filter(this.exists).forEach(e=>{var t=op(this.widgets[e],2),r=t[0],a=t[1],n=r();n&&n!==a&&(this.widgets[e][1]=n,this.onHeightChange(e,n))})}),cp(this,"start",()=>{this.stop(),this.interval=setInterval(this.checkHeightChanges,200)}),cp(this,"stop",()=>{clearInterval(this.interval)}),cp(this,"resume",()=>{this.isEmpty()||this.start()}),cp(this,"destroy",()=>{this.stop(),this.widgets=null}),this.onHeightChange=e}update(e){var t=e.filter(e=>e.options.position.autoHeight).map(e=>e.id.toString());t.filter(e=>!Object(c.includes)(Object.keys(this.widgets),e)).forEach(this.add),Object.keys(this.widgets).filter(e=>!Object(c.includes)(t,e)).forEach(this.remove)}}r(1516);function mp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pp=Object(kc.WidthProvider)(kc.Responsive),fp=se.a.shape({id:se.a.number.isRequired,options:se.a.shape({position:se.a.shape({col:se.a.number.isRequired,row:se.a.number.isRequired,sizeY:se.a.number.isRequired,minSizeY:se.a.number.isRequired,maxSizeY:se.a.number.isRequired,sizeX:se.a.number.isRequired,minSizeX:se.a.number.isRequired,maxSizeX:se.a.number.isRequired}).isRequired}).isRequired}),hp="single-column",bp="multi-column",gp=n.a.memo((function(e){var t=e.widget,r=e.dashboard,a=e.onLoadWidget,i=e.onRefreshWidget,s=e.onRemoveWidget,o=e.onParameterMappingsChange,l=e.isEditing,c=e.canEdit,u=e.isPublic,d=e.isLoading,m=e.filters,p=t.type,f=()=>s(t.id);return p===Dr?n.a.createElement(Hm,{widget:t,dashboard:r,filters:m,isEditing:l,canEdit:c,isPublic:u,isLoading:d,onLoad:()=>a(t),onRefresh:()=>i(t),onDelete:f,onParameterMappingsChange:o}):p===Ir?n.a.createElement(np,{widget:t,canEdit:c,isPublic:u,onDelete:f}):n.a.createElement(sp,{widget:t})}),(e,t)=>e.widget===t.widget&&e.canEdit===t.canEdit&&e.isPublic===t.isPublic&&e.isLoading===t.isLoading&&e.filters===t.filters&&e.isEditing===t.isEditing);class yp extends n.a.Component{static normalizeFrom(e){var t=e.id,r=e.options.position;return{i:t.toString(),x:r.col,y:r.row,w:r.sizeX,h:r.sizeY,minW:r.minSizeX,maxW:r.maxSizeX,minH:r.minSizeY,maxH:r.maxSizeY}}constructor(e){super(e),mp(this,"mode",null),mp(this,"autoHeightCtrl",null),mp(this,"onLayoutChange",(e,t)=>{if(t[bp]&&this.setState({layouts:t}),this.mode=document.body.offsetWidth<=wt?hp:bp,this.mode!==hp){var r=Object(c.chain)(t[bp]).keyBy("i").mapValues(this.normalizeTo).value();this.props.onLayoutChange(r)}}),mp(this,"onBreakpointChange",e=>{this.mode=e,this.props.onBreakpointChange(e===hp)}),mp(this,"onWidgetHeightUpdated",(e,t)=>{this.setState(r=>{var a=r.layouts,n=Object(c.cloneDeep)(a[bp]),i=Object(c.find)(n,{i:e.toString()});return i&&(i.h=Math.ceil((t+jt)/Et)),{layouts:{[bp]:n}}})}),mp(this,"onWidgetResize",(e,t,r)=>{t.h!==r.h&&this.autoHeightCtrl.remove(Number(r.i)),this.autoHeightCtrl.resume()}),mp(this,"normalizeTo",e=>({col:e.x,row:e.y,sizeX:e.w,sizeY:e.h,autoHeight:this.autoHeightCtrl.exists(e.i)})),this.state={layouts:{},disableAnimations:!0},this.autoHeightCtrl=new dp(this.onWidgetHeightUpdated),this.autoHeightCtrl.update(this.props.widgets)}componentDidMount(){this.onBreakpointChange(document.body.offsetWidth<=wt?hp:bp),setTimeout(()=>{this.setState({disableAnimations:!1})},50)}componentDidUpdate(){this.autoHeightCtrl.update(this.props.widgets)}componentWillUnmount(){this.autoHeightCtrl.destroy()}render(){var e=this.props,t=e.onLoadWidget,r=e.onRefreshWidget,a=e.onRemoveWidget,i=e.onParameterMappingsChange,s=e.filters,o=e.dashboard,l=e.isPublic,c=e.isEditing,u=e.widgets,d=ge()("dashboard-wrapper",c?"editing-mode":"preview-mode");return n.a.createElement("div",{className:d},n.a.createElement(pp,{draggableCancel:"input,.sortable-container",className:ge()("layout",{"disable-animations":this.state.disableAnimations}),cols:{[bp]:Ot,[hp]:1},rowHeight:Et-jt,margin:[jt,jt],isDraggable:c,isResizable:c,onResizeStart:this.autoHeightCtrl.stop,onResizeStop:this.onWidgetResize,layouts:this.state.layouts,onLayoutChange:this.onLayoutChange,onBreakpointChange:this.onBreakpointChange,breakpoints:{[bp]:wt,[hp]:0}},u.map(e=>n.a.createElement("div",{key:e.id,"data-grid":yp.normalizeFrom(e),"data-widgetid":e.id,"data-test":"WidgetId".concat(e.id),className:ge()("dashboard-widget-wrapper",{"widget-auto-height-enabled":this.autoHeightCtrl.exists(e.id)})},n.a.createElement(gp,{dashboard:o,widget:e,filters:s,isPublic:l,isLoading:e.loading,isEditing:c,canEdit:o.canEdit(),onLoadWidget:t,onRefreshWidget:r,onRemoveWidget:a,onParameterMappingsChange:i})))))}}mp(yp,"propTypes",{isEditing:se.a.bool.isRequired,isPublic:se.a.bool,dashboard:se.a.object.isRequired,widgets:se.a.arrayOf(fp).isRequired,filters:Ad,onBreakpointChange:se.a.func,onLoadWidget:se.a.func,onRefreshWidget:se.a.func,onRemoveWidget:se.a.func,onLayoutChange:se.a.func,onParameterMappingsChange:se.a.func}),mp(yp,"defaultProps",{isPublic:!1,filters:[],onLoadWidget:()=>{},onRefreshWidget:()=>{},onRemoveWidget:()=>{},onLayoutChange:()=>{},onBreakpointChange:()=>{},onParameterMappingsChange:()=>{}});var vp=yp,Op=new Map;function Ep(){Op.size>0&&(Op.forEach((e,t)=>{var r=t.getBoundingClientRect(),a=Math.round(10*r.width),n=Math.round(10*r.height);e.width===a&&e.height===n||(e.width=a,e.height=n,e.callback(t))}),setTimeout(Ep,100))}function jp(e,t){if(e&&!Op.has(e)){var r=0===Op.size;return Op.set(e,{callback:t}),r&&Ep(),()=>Op.delete(e)}return()=>{}}function wp(){return(wp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Sp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Pp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sp(Object(r),!0).forEach((function(t){Cp(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Cp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Np(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return kp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function _p(e){var t=e.query,r=e.visualization,i=e.onChange,s=Object(a.useMemo)(()=>t?Object(c.groupBy)(t.visualizations,"type"):{},[t]),o=qe("visualization-select"),l=Object(a.useCallback)(e=>{var r=t?Object(c.find)(t.visualizations,{id:e}):null;i(r||null)},[t,i]);return t?n.a.createElement("div",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:o},"Choose Visualization"),n.a.createElement(Xi.a,{id:o,className:"w-100",value:r?r.id:void 0,onChange:l},Object(c.map)(s,(e,t)=>n.a.createElement(Xi.a.OptGroup,{key:t,label:t},Object(c.map)(e,e=>n.a.createElement(Xi.a.Option,{key:"".concat(e.id),value:e.id},e.name))))))):null}function Ap(e){var t=e.dialog,r=e.dashboard,i=Np(Object(a.useState)(null),2),s=i[0],o=i[1],l=Np(Object(a.useState)(null),2),u=l[0],d=l[1],m=Np(Object(a.useState)([]),2),p=m[0],f=m[1],h=Object(a.useCallback)(e=>{o(null),d(null),f([]),e&&ir.get({id:e}).then(e=>{if(e){var t=Object(c.map)(r.getParametersDefs(),e=>e.name);o(e),f(Object(c.map)(e.getParametersDefs(),e=>({name:e.name,type:Object(c.includes)(t,e.name)?gm:bm,mapTo:e.name,value:e.normalizedValue,title:"",param:e}))),e.visualizations.length>0&&d(Object(c.first)(e.visualizations))}})},[r]),b=Object(a.useCallback)(()=>{t.close({visualization:u,parameterMappings:p}).catch(()=>{un.error("Widget could not be added")})},[t,u,p]),g=r.getParametersDefs(),y=qe("parameter-mappings");return n.a.createElement(V.a,wp({},t.props,{title:"Add Widget",onOk:b,okButtonProps:Pp(Pp({},t.props.okButtonProps),{},{disabled:!s||t.props.okButtonProps.disabled}),okText:"Add to Dashboard",width:700}),n.a.createElement("div",{"data-test":"AddWidgetDialog"},n.a.createElement(tl,{onChange:e=>h(e?e.id:null)}),s&&n.a.createElement(_p,{query:s,visualization:u,onChange:d}),p.length>0&&[n.a.createElement("label",{key:"parameters-title",htmlFor:y},"Parameters"),n.a.createElement(Pm,{key:"parameters-list",id:y,mappings:p,existingParams:g,onChange:f})]))}_p.propTypes={query:se.a.object,visualization:se.a.object,onChange:se.a.func},_p.defaultProps={query:null,visualization:null,onChange:()=>{}},Ap.propTypes={dialog:Je.isRequired,dashboard:se.a.object.isRequired};var xp=Xe(Ap),qp=["imageUrl","roundedImage","title","body","children","className"],Tp=["user","withLink","children"],Ip=["dataSource","withLink","children"];function Dp(){return(Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Rp(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Mp(e){var t=e.imageUrl,r=e.roundedImage,a=e.title,i=e.body,s=e.children,o=e.className,l=Rp(e,qp);return n.a.createElement("div",Dp({},l,{className:o+" w-100 d-flex align-items-center"}),n.a.createElement("img",{src:t,width:"32",height:"32",className:ge()({"profile__image--settings":r},"m-r-5"),alt:"Logo/Avatar"}),n.a.createElement("div",{className:"flex-fill"},n.a.createElement("div",null,a),i&&n.a.createElement("div",{className:"text-muted"},i)),s)}function zp(e){var t=e.user,r=e.withLink,a=e.children,i=Rp(e,Tp),s=r?n.a.createElement(S,{href:"users/"+t.id},t.name):t.name;return n.a.createElement(Mp,Dp({},i,{imageUrl:t.profile_image_url,title:s,body:t.email}),a)}function Fp(e){var t=e.dataSource,r=e.withLink,a=e.children,i=Rp(e,Ip),s="static/images/db-logos/".concat(t.type,".png"),o=r?n.a.createElement(S,{href:"data_sources/"+t.id},t.name):t.name;return n.a.createElement(Mp,Dp({},i,{imageUrl:s,title:o}),a)}Mp.propTypes={imageUrl:se.a.string.isRequired,title:se.a.node.isRequired,body:se.a.node,roundedImage:se.a.bool,className:se.a.string,children:se.a.node},Mp.defaultProps={body:null,roundedImage:!0,className:"",children:null},zp.propTypes={user:se.a.shape({profile_image_url:se.a.string.isRequired,name:se.a.string.isRequired,email:se.a.string.isRequired}).isRequired,withLink:se.a.bool,children:se.a.node},zp.defaultProps={withLink:!1,children:null},Fp.propTypes={dataSource:se.a.shape({name:se.a.string.isRequired,type:se.a.string.isRequired}).isRequired,withLink:se.a.bool,children:se.a.node},Fp.defaultProps={withLink:!1,children:null};var Lp=r(251),Up=r.n(Lp);Up.a.setConfig({ADD_ATTR:["target"]}),Up.a.addHook("afterSanitizeAttributes",(function(e){var t=e.getAttribute("target");Object(c.isString)(t)&&"_blank"===t.toLowerCase()?e.setAttribute("rel","noopener noreferrer"):e.removeAttribute("target")}));var Vp=Up.a.sanitize;function Bp(e){return Object(c.find)([Object(c.get)(e,"response.data.message"),Object(c.get)(e,"response.statusText"),"Unknown error"],c.isString)}function Qp(e){return"api/users/".concat(e.id,"/disable")}var Wp={query:e=>K.get("api/users",{params:e}),get:e=>{var t=e.id;return K.get("api/users/".concat(t))},create:e=>K.post("api/users",e),save:e=>K.post("api/users/".concat(e.id),e),enableUser:function(e){var t=Vp(e.name);return K.delete(Qp(e)).then(r=>(un.success("User ".concat(t," is now enabled.")),e.is_disabled=!1,e.profile_image_url=r.profile_image_url,r)).catch(e=>{un.error("Cannot enable user",Bp(e))})},disableUser:function(e){var t=Vp(e.name);return K.post(Qp(e)).then(r=>(un.warning("User ".concat(t," is now disabled.")),e.is_disabled=!0,e.profile_image_url=r.profile_image_url,r)).catch(e=>{un.error("Cannot disable user",Bp(e))})},deleteUser:function(e){var t=Vp(e.name);return K.delete("api/users/".concat(e.id)).then(e=>(un.warning("User ".concat(t," has been deleted.")),e)).catch(e=>{un.error("Cannot delete user",Bp(e))})},convertUserInfo:function(e){return{id:e.id,name:e.name,email:e.email,profileImageUrl:e.profile_image_url,apiKey:e.api_key,groupIds:e.groups,isDisabled:e.is_disabled,isInvitationPending:e.is_invitation_pending}},regenerateApiKey:function(e){return K.post("api/users/".concat(e.id,"/regenerate_api_key")).then(e=>(un.success("The API Key has been updated."),e.api_key)).catch(e=>{un.error("Failed regenerating API Key",Bp(e))})},sendPasswordReset:function(e){return K.post("api/users/".concat(e.id,"/reset_password")).then(e=>{if($.mailSettingsMissing)return un.warning("The mail server is not configured."),e.reset_link;un.success("Password reset email sent.")}).catch(e=>{un.error("Failed to send password reset email",Bp(e))})},resendInvitation:function(e){return K.post("api/users/".concat(e.id,"/invite")).then(e=>{if($.mailSettingsMissing)return un.warning("The mail server is not configured."),e.invite_link;un.success("Invitation sent.")}).catch(e=>{un.error("Failed to resend invitation",Bp(e))})}};function Hp(){return(Hp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Gp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kp(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Yp=Xi.a.Option;function $p(e){var t=e.context;return n.a.createElement(n.a.Fragment,null,"Manage Permissions",n.a.createElement("div",{className:"modal-header-desc"},"Editing this ".concat(t," is enabled for the users in this list and for admins. "),n.a.createElement(Qe,{type:"MANAGE_PERMISSIONS"})))}function Jp(e){var t=e.onSelect,r=e.shouldShowUser,i=Gp(Object(a.useState)(!0),2),s=i[0],o=i[1],l=Gp(Object(a.useState)([]),2),u=l[0],d=l[1],m=Gp(Object(a.useState)(""),2),p=m[0],f=m[1],h=Object(a.useCallback)(Object(c.debounce)(e=>(e=>Wp.query({q:e}).then(e=>e.results).catch(()=>[]))(e).then(d).finally(()=>o(!1)),200),[]);return Object(a.useEffect)(()=>{o(!0),h(p)},[h,p]),n.a.createElement(Xi.a,{className:"w-100 m-b-10",placeholder:"Add users...",showSearch:!0,onSearch:f,suffixIcon:s?n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading...")):n.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}),filterOption:!1,notFoundContent:null,value:void 0,getPopupContainer:e=>e.parentNode,onSelect:t},u.filter(r).map(e=>n.a.createElement(Yp,{key:e.id,value:e.id},n.a.createElement(zp,{user:e}))))}function Xp(e){var t,r=e.dialog,i=e.author,s=e.context,o=e.aclUrl,l=Gp(Object(a.useState)(!0),2),u=l[0],d=l[1],m=Gp(Object(a.useState)([]),2),p=m[0],f=m[1],b=(t=o,{loadGrantees:Object(a.useCallback)(()=>K.get(t).then(e=>{var t=[];return Object(c.each)(e,(e,r)=>{e.forEach(e=>{e.accessType=bi(r),t.push(e)})}),t}),[t]),addPermission:Object(a.useCallback)((function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modify";return K.post(t,{access_type:r,user_id:e}).catch(()=>un.error("Could not grant permission to the user"))}),[t]),removePermission:Object(a.useCallback)((function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modify";return K.delete(t,{data:{access_type:r,user_id:e}}).catch(()=>un.error("Could not remove permission from the user"))}),[t])}),g=b.loadGrantees,y=b.addPermission,v=b.removePermission,O=Object(a.useCallback)(()=>{d(!0),g().then(f).catch(()=>un.error("Failed to load grantees list")).finally(()=>d(!1))},[g]),E=Object(a.useCallback)(e=>e.id===i.id||!!Object(c.get)(Object(c.find)(p,{id:e.id}),"accessType"),[i.id,p]);return Object(a.useEffect)(()=>{O()},[o,O]),n.a.createElement(V.a,Hp({},r.props,{className:"permissions-editor-dialog",title:n.a.createElement($p,{context:s}),footer:n.a.createElement(h.a,{onClick:r.dismiss},"Close")}),n.a.createElement(Jp,{onSelect:e=>y(e).then(O),shouldShowUser:e=>!E(e)}),n.a.createElement("div",{className:"d-flex align-items-center m-t-5"},n.a.createElement("h5",{className:"flex-fill"},"Users with permissions"),u&&n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading..."))),n.a.createElement("div",{className:"scrollbox p-5",style:{maxHeight:"40vh"}},n.a.createElement(to.a,{size:"small",dataSource:[i,...p],renderItem:e=>n.a.createElement(to.a.Item,null,n.a.createElement(zp,{key:e.id,user:e},e.id===i.id?n.a.createElement(am.a,{className:"m-0"},"Author"):n.a.createElement(Ne,{title:"Remove user permissions"},n.a.createElement(Ee,{"aria-label":"Remove permissions",onClick:()=>v(e.id).then(O)},n.a.createElement("i",{className:"fa fa-remove clickable","aria-hidden":"true"})))))})))}$p.propTypes={context:se.a.oneOf(["query","dashboard"])},$p.defaultProps={context:"query"},Jp.propTypes={onSelect:se.a.func,shouldShowUser:se.a.func},Jp.defaultProps={onSelect:()=>{},shouldShowUser:()=>!0},Xp.propTypes={dialog:Je.isRequired,author:se.a.object.isRequired,context:se.a.oneOf(["query","dashboard"]),aclUrl:se.a.string.isRequired},Xp.defaultProps={context:"query"};var Zp=Xe(Xp),ef=r(246),tf=r.n(ef);function rf(){return(rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function af(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class nf extends n.a.Component{constructor(e){super(e),af(this,"copy",()=>{this.ref.current.select();try{if(!document.execCommand("copy"))throw new Error;this.setState({copied:"Copied!"})}catch(e){this.setState({copied:"Copy failed"})}this.resetCopyState=setTimeout(()=>this.setState({copied:null}),2e3)}),this.state={copied:null},this.ref=n.a.createRef(),this.copyFeatureSupported=document.queryCommandSupported("copy"),this.resetCopyState=null}componentWillUnmount(){this.resetCopyState&&clearTimeout(this.resetCopyState)}render(){var e=n.a.createElement(Ne,{title:this.state.copied||"Copy"},n.a.createElement(Ee,{onClick:this.copy},n.a.createElement(tf.a,null)));return n.a.createElement(He.a,rf({},this.props,{ref:this.ref,addonAfter:this.copyFeatureSupported&&e}))}}function sf(){return(sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function of(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class lf extends n.a.Component{constructor(e){super(e),of(this,"formItemProps",{labelCol:{span:8},wrapperCol:{span:16},style:{marginBottom:7}}),of(this,"enableAccess",()=>{var e=this.props.dashboard;this.setState({saving:!0}),K.post(this.apiUrl).then(t=>{e.publicAccessEnabled=!0,e.public_url=t.public_url}).catch(()=>{un.error("Failed to turn on sharing for this dashboard")}).finally(()=>{this.setState({saving:!1})})}),of(this,"disableAccess",()=>{var e=this.props.dashboard;this.setState({saving:!0}),K.delete(this.apiUrl).then(()=>{e.publicAccessEnabled=!1,delete e.public_url}).catch(()=>{un.error("Failed to turn off sharing for this dashboard")}).finally(()=>{this.setState({saving:!1})})}),of(this,"onChange",e=>{e?this.enableAccess():this.disableAccess()});var t=this.props.dashboard;this.state={saving:!1},this.apiUrl=Object(c.replace)("api/dashboards/{id}/share","{id}",t.id),this.enabled=this.props.hasOnlySafeQueries||t.publicAccessEnabled}static get headerContent(){return n.a.createElement(n.a.Fragment,null,"Share Dashboard",n.a.createElement("div",{className:"modal-header-desc"},"Allow public access to this dashboard with a secret address. ",n.a.createElement(Qe,{type:"SHARE_DASHBOARD"})))}render(){var e=this.props,t=e.dialog,r=e.dashboard,a=e.hasOnlySafeQueries,i=this.constructor.headerContent;return n.a.createElement(V.a,sf({},t.props,{title:i,footer:null}),n.a.createElement(Co.a,{layout:"horizontal"},!a&&n.a.createElement(Co.a.Item,null,n.a.createElement(p.a,{message:"For your security, sharing is currently not supported for dashboards containing queries with text parameters. Consider changing the text parameters in your query to a different type.",type:"error"})),n.a.createElement(Co.a.Item,sf({label:"Allow public access"},this.formItemProps),n.a.createElement(Gi.a,{checked:r.publicAccessEnabled,onChange:this.onChange,loading:this.state.saving,disabled:!this.enabled,"data-test":"PublicAccessEnabled"})),r.public_url&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Co.a.Item,null,n.a.createElement(p.a,{message:n.a.createElement("div",null,"Custom rule for hiding filter components when sharing links:",n.a.createElement("br",null),"You can hide filter components by appending `&hide_filter=","{{"," component_name","}}","` to the sharing URL.",n.a.createElement("br",null),"Example: http://","{{","ip","}}",":","{{","port","}}","/public/dashboards/","{{","id","}}","?p_country=ghana&p_site=10&hide_filter=country"),type:"warning"})),n.a.createElement(Co.a.Item,sf({label:"Secret address"},this.formItemProps),n.a.createElement(nf,{value:r.public_url,"data-test":"SecretAddress"})))))}}of(lf,"propTypes",{dashboard:se.a.object.isRequired,hasOnlySafeQueries:se.a.bool.isRequired,dialog:Je.isRequired});var cf=Xe(lf);function uf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return df(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return df(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function df(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function mf(){var e=uf(Object(a.useState)(Object(c.has)(R.search,"fullscreen")),2),t=e[0],r=e[1];Object(a.useEffect)(()=>{document.body.classList.toggle("headless",t),R.setSearch({fullscreen:!!t||null},!0)},[t]);return[t,()=>r(!t)]}function pf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ff(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ff(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ff(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function hf(e){var t=ae.getDashboardRefreshIntervals();return Object(c.max)([30,Object(c.min)(t),e])}function bf(e){var t=pf(Object(a.useState)(function(){var e=parseFloat(R.search.refresh);return Object(c.isNaN)(e)?null:hf(e)}()),2),r=t[0],n=t[1],i=Dd(e);return Object(a.useEffect)(()=>{if(R.setSearch({refresh:r||null},!0),r){var e=setInterval(i,1e3*r);return()=>clearInterval(e)}},[r,i]),Object(a.useMemo)(()=>[r,e=>n(hf(e)),()=>n(null)],[r])}function gf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var vf="saved",Of="saving",Ef="saving_failed";function jf(e,t){var r=gf(Object(a.useState)(e&&Object(c.has)(R.search,"edit")),2),n=r[0],i=r[1],s=gf(Object(a.useState)(vf),2),o=s[0],l=s[1],u=gf(Object(a.useState)([]),2),d=u[0],m=u[1],p=gf(Object(a.useState)(!1),2),f=p[0],h=p[1];Object(a.useEffect)(()=>{R.setSearch({edit:!!n||null},!0)},[n]),Object(a.useEffect)(()=>{f&&o===vf&&(h(!1),i(!1))},[f,o]);var b=Object(a.useCallback)(r=>{if(e){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(c.pickBy)(t,(t,r)=>{var a=Object(c.find)(e,{id:Number(r)}).options.position;return!Object(c.isMatch)(a,t)})}(t,r);l(Of),m(r);var n=Object(c.map)(a,(e,r)=>{var a=Object(c.find)(t,{id:Number(r)});return a?a.save("options",{position:e}):Promise.resolve()});return Promise.all(n).then(()=>l(vf)).catch(()=>{l(Ef),un.error("Error saving changes.")})}l(vf)},[e,t]),g=Object(a.useCallback)((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(Of),Object(c.debounce)(()=>b(...t),2e3)()}),[b]),y=Object(a.useCallback)(()=>b(d),[d,b]),v=Object(a.useCallback)(t=>{t||o===vf?i(e&&t):h(!0)},[o,e]);return{editingLayout:e&&n,setEditingLayout:v,saveDashboardLayout:n?g:b,retrySaveDashboardLayout:y,doneBtnClickedWhileSaving:f,dashboardStatus:o}}var wf=r(209),Sf=r.n(wf);function Pf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Cf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Nf(e){var t=Pf(Object(a.useState)(!1),2),r=t[0],n=t[1],i=Object(a.useCallback)(()=>{var t="duplicatedDashboardTab/".concat(Math.random().toString()),r=window.open("",t);n(!0),$r.fork({id:e.id}).then(e=>{r.location=function(e){var t=A.a.parse(window.location.search);e=Sf.a.parse(e);var r=A.a.parse(e.search);return Sf.a.format(Object(c.extend)(Object(c.pick)(e,["protocol","auth","host","pathname"]),{search:A.a.stringify(Object(c.extend)(t,r))}))}(e.getUrl())}).finally(()=>{n(!1)})},[e.id]);return[r,r?c.noop:i]}function kf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kf(Object(r),!0).forEach((function(t){Af(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Af(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Tf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(c.isEmpty)(t)?e:e.filter(e=>Object.values(e.getParameterMappings()).filter(e=>"dashboard-level"===e.type).some(e=>{var r=e.mapTo;return Object(c.includes)(t.map(e=>e.name),r)}))}var If=function(e){var t=xf(Object(a.useState)(e),2),r=t[0],n=t[1],i=xf(Object(a.useState)([]),2),s=i[0],o=i[1],l=xf(Object(a.useState)(!1),2),u=l[0],d=l[1],m=xf(Object(a.useState)(!1),2),p=m[0],f=m[1],h=Object(a.useMemo)(()=>r.getParametersDefs(),[r]),b=!r.is_archived&&ae.canEdit(r),g=Object(a.useMemo)(()=>!r.is_archived&&Object(c.has)(r,"user.id")&&(Y.id===r.user.id||Y.isAdmin),[r]),y=Object(a.useMemo)(()=>Object(c.every)(r.widgets,e=>!e.getQuery()||e.getQuery().is_safe),[r]),v=xf(Nf(r),2),O=v[0],E=v[1],j=Object(a.useCallback)(()=>{var e="api/dashboards/".concat(r.id,"/acl");Zp.showModal({aclUrl:e,context:"dashboard",author:r.user})},[r]),w=Object(a.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n(t=>Object(c.extend)({},t,e)),e=_f(_f({},e),{},{id:r.id}),t&&(e=_f(_f({},e),{},{version:r.version})),$r.save(e).then(t=>{n(r=>Object(c.extend)({},r,Object(c.pick)(t,Object(c.keys)(e)))),Object(c.has)(e,"name")&&R.setPath(tt.parse(t.url).pathname,!0)}).catch(e=>{var t=Object(c.get)(e,"response.status");403===t?un.error("Dashboard update failed","Permission Denied."):409===t&&un.error("It seems like the dashboard has been modified by another user. ","Please copy/backup your changes and reload this page.",{duration:null})})}),[r]),S=Object(a.useCallback)(()=>{vt("toggle_published","dashboard",r.id),w({is_draft:!r.is_draft},!1)},[r,w]),P=Object(a.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.getParametersDefs(),n(e=>Object(c.extend)({},e)),e.load(t).catch(e=>{if(!(e instanceof or))return Promise.reject(e)}).finally(()=>n(e=>Object(c.extend)({},e)))}),[]),C=Object(a.useCallback)(e=>P(e,!0),[P]),N=Object(a.useCallback)(e=>{n(t=>Object(c.extend)({},t,{widgets:t.widgets.filter(t=>void 0!==t.id&&t.id!==e)}))},[]),k=Object(a.useRef)();k.current=r;var _=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Tf(k.current.widgets,t),a=Object(c.compact)(r.map(t=>P(t,e).catch(e=>e)));return Promise.all(a).then(()=>{var e=Object(c.compact)(Object(c.map)(k.current.widgets,e=>e.getQueryResult())),t=Gr(k.current,e,R.search);o(t)})}),[P]),A=Object(a.useCallback)(e=>{u||(d(!0),_(!0,e).finally(()=>d(!1)))},[u,_]),x=Object(a.useCallback)(()=>{vt("archive","dashboard",r.id),$r.delete(r).then(e=>n(t=>Object(c.extend)({},t,Object(c.pick)(e,["is_archived"]))))},[r]),q=Object(a.useCallback)(()=>{var e=()=>n(e=>Object(c.extend)({},e));cf.showModal({dashboard:r,hasOnlySafeQueries:y}).onClose(e).onDismiss(e)},[r,y]),T=Object(a.useCallback)(()=>{Zm.showModal({isNew:!0}).onClose(e=>r.addWidget(e).then(()=>n(e=>Object(c.extend)({},e))))},[r]),I=Object(a.useCallback)(()=>{xp.showModal({dashboard:r}).onClose(e=>{var t=e.visualization,a=e.parameterMappings;return r.addWidget(t,{parameterMappings:Om(a)}).then(e=>{var t=[e,...Em(e.options.parameterMappings,r.widgets)];return Promise.all(t.map(e=>e.save())).then(()=>n(e=>Object(c.extend)({},e)))})})},[r]),D=xf(bf(A),3),M=D[0],z=D[1],F=D[2],L=xf(mf(),2),U=L[0],V=L[1],B=jf(!p&&b,r.widgets);return Object(a.useEffect)(()=>{n(e),_()},[e]),Object(a.useEffect)(()=>{document.title=r.name},[r.name]),Object(a.useEffect)(()=>{_()},[r.dashboard_filters_enabled]),_f(_f({dashboard:r,globalParameters:h,refreshing:u,filters:s,setFilters:o,loadDashboard:_,refreshDashboard:A,updateDashboard:w,togglePublished:S,archiveDashboard:x,loadWidget:P,refreshWidget:C,removeWidget:N,canEditDashboard:b,isDashboardOwnerOrAdmin:g,refreshRate:M,setRefreshRate:z,disableRefreshRate:F},B),{},{gridDisabled:p,setGridDisabled:f,fullscreen:U,toggleFullscreen:V,showShareDashboardDialog:q,showAddTextboxDialog:T,showAddWidgetDialog:I,managePermissions:j,isDuplicating:O,duplicateDashboard:E})};function Df(){return(Df=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Rf(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Mf extends n.a.Component{constructor(e){super(e),Rf(this,"startEditing",()=>{this.props.isEditable&&this.setState({editing:!0})}),Rf(this,"stopEditing",e=>{var t=Object(c.trim)(e);this.props.ignoreBlanks&&""===t||t===this.props.value||this.props.onDone(t),this.setState({editing:!1})}),Rf(this,"handleKeyDown",e=>{13!==e.keyCode||e.shiftKey?27===e.keyCode&&this.setState({editing:!1}):(e.preventDefault(),this.stopEditing(e.target.value))}),Rf(this,"renderNormal",()=>this.props.value?n.a.createElement("span",{role:"presentation",onFocus:this.startEditing,onClick:this.startEditing,className:this.props.isEditable?"editable":""},this.props.value):n.a.createElement("a",{className:"clickable",onClick:this.startEditing},this.props.placeholder)),Rf(this,"renderEdit",()=>{var e=this.props,t=e.multiline,r=e.value,a=e.editorProps,i=t?He.a.TextArea:He.a;return n.a.createElement(i,Df({defaultValue:r,"aria-label":"Editing",onBlur:e=>this.stopEditing(e.target.value),onKeyDown:this.handleKeyDown,autoFocus:!0},a))}),this.state={editing:e.defaultEditing}}componentDidUpdate(e,t){!this.state.editing&&t.editing&&this.props.onStopEditing()}render(){return n.a.createElement("span",{className:ge()("edit-in-place",{active:this.state.editing},this.props.className)},this.state.editing?this.renderEdit():this.renderNormal())}}function zf(){return Gl("api/dashboards/tags").then(e=>Object(c.map)(e,e=>e.name))}function Ff(e){return e?"primary":"default"}function Lf(e){var t=e.dashboardConfiguration,r=t.dashboard,a=t.canEditDashboard,i=t.updateDashboard,s=t.editingLayout;return n.a.createElement("div",{className:"title-with-tags"},n.a.createElement("div",{className:"page-title"},n.a.createElement(Hn,{item:r}),n.a.createElement("h3",null,n.a.createElement(Mf,{isEditable:s,onDone:e=>i({name:e}),value:r.name,ignoreBlanks:!0})),n.a.createElement(Ne,{title:r.user.name,placement:"bottom"},n.a.createElement("img",{src:r.user.profile_image_url,className:"profile-image",alt:r.user.name}))),n.a.createElement(us,{tags:r.tags,isDraft:r.is_draft,isArchived:r.is_archived,canEdit:a,getAvailableTags:zf,onEdit:e=>i({tags:e})}))}function Uf(e){var t=e.dashboardConfiguration,r=t.refreshRate,a=t.setRefreshRate,i=t.disableRefreshRate,s=t.refreshing,o=t.refreshDashboard,l=ae.getDashboardRefreshIntervals(),u=$.dashboardRefreshIntervals;return n.a.createElement(h.a.Group,null,n.a.createElement(Ne,{title:r?"Auto Refreshing every ".concat(hi(r)):null},n.a.createElement(h.a,{type:Ff(r),onClick:()=>o()},n.a.createElement("i",{className:ge()("zmdi zmdi-refresh m-r-5",{"zmdi-hc-spin":s}),"aria-hidden":"true"}),r?hi(r):"Refresh")),n.a.createElement(Da.a,{trigger:["click"],placement:"bottomRight",overlay:n.a.createElement(he.a,{onClick:e=>{var t=e.key,r=parseFloat(t);r?(a(r),o()):i()},selectedKeys:["".concat(r)]},u.map(e=>n.a.createElement(he.a.Item,{key:"".concat(e),disabled:!Object(c.includes)(l,e)},hi(e))),r&&n.a.createElement(he.a.Item,{key:null},"Disable auto refresh"))},n.a.createElement(h.a,{className:"icon-button hidden-xs",type:Ff(r)},n.a.createElement("i",{className:"fa fa-angle-down","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Split button!"))))}function Vf(e){var t=e.dashboardConfiguration,r=t.dashboard,a=t.setEditingLayout,i=t.togglePublished,s=t.archiveDashboard,o=t.managePermissions,l=t.gridDisabled,c=t.isDashboardOwnerOrAdmin,u=t.isDuplicating,d=t.duplicateDashboard;return n.a.createElement(Da.a,{trigger:["click"],placement:"bottomRight",overlay:n.a.createElement(he.a,{"data-test":"DashboardMoreButtonMenu"},n.a.createElement(he.a.Item,{className:ge()({hidden:l})},n.a.createElement(Ee,{onClick:()=>a(!0)},"Edit")),!u&&r.canEdit()&&n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:d},"Fork ",n.a.createElement("i",{className:"fa fa-external-link m-l-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)"))),$.showPermissionsControl&&c&&n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:o},"Manage Permissions")),!$.disablePublish&&!r.is_draft&&n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:i},"Unpublish")),n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:()=>{V.a.confirm({title:"Archive Dashboard",content:'Are you sure you want to archive the "'.concat(r.name,'" dashboard?'),okText:"Archive",okType:"danger",onOk:s,maskClosable:!0,autoFocusButton:null})}},"Archive")))},n.a.createElement(h.a,{className:"icon-button m-l-5","data-test":"DashboardMoreButton","aria-label":"More actions"},n.a.createElement(Eo.a,{rotate:90,"aria-hidden":"true"})))}function Bf(e){var t=e.dashboardConfiguration,r=e.headerExtra,a=t.dashboard,i=t.togglePublished,s=t.canEditDashboard,o=t.fullscreen,l=t.toggleFullscreen,c=t.showShareDashboardDialog,u=t.updateDashboard,d=a.is_draft,m=!a.is_draft,p=s&&!a.is_draft,f=!$.disablePublicUrls&&(a.publicAccessEnabled||p),b=s;return n.a.createElement("div",{className:"dashboard-control"},a.can_edit&&a.is_archived&&n.a.createElement(h.a,{onClick:()=>{vt("unarchive","dashboard",a.id),u({is_archived:!1},!1)}},"Unarchive"),!a.is_archived&&n.a.createElement("span",{className:"hidden-print"},d&&n.a.createElement(h.a,{className:"m-r-5 hidden-xs",onClick:i},n.a.createElement("span",{className:"fa fa-paper-plane m-r-5"})," Publish"),n.a.createElement(Uf,{dashboardConfiguration:t}),m&&n.a.createElement(Ne,{className:"hidden-xs",title:"Enable/Disable Fullscreen display"},n.a.createElement(h.a,{type:Ff(o),className:"icon-button m-l-5",onClick:l,"aria-label":"Toggle fullscreen display"},n.a.createElement("i",{className:"zmdi zmdi-fullscreen","aria-hidden":"true"}))),r,f&&n.a.createElement(Ne,{title:"Dashboard Sharing Options"},n.a.createElement(h.a,{className:"icon-button m-l-5",type:Ff(a.publicAccessEnabled),onClick:c,"data-test":"OpenShareForm","aria-label":"Share"},n.a.createElement("i",{className:"zmdi zmdi-share","aria-hidden":"true"}))),b&&n.a.createElement(Vf,{dashboardConfiguration:t})))}function Qf(e){var t,r=e.dashboardConfiguration,a=e.headerExtra,i=r.setEditingLayout,s=r.doneBtnClickedWhileSaving,o=r.dashboardStatus,l=r.retrySaveDashboardLayout;return t=o===vf?n.a.createElement("span",{className:"save-status"},"Saved"):o===Of?n.a.createElement("span",{className:"save-status","data-saving":!0},"Saving"):n.a.createElement("span",{className:"save-status","data-error":!0},"Saving Failed"),n.a.createElement("div",{className:"dashboard-control"},t,o===Ef?n.a.createElement(h.a,{type:"primary",onClick:l},"Retry"):n.a.createElement(h.a,{loading:s,type:"primary",onClick:()=>i(!1)},!s&&n.a.createElement("i",{className:"fa fa-check m-r-5","aria-hidden":"true"})," Done Editing"),a)}function Wf(e){var t=e.dashboardConfiguration,r=e.headerExtra,a=t.editingLayout?Qf:Bf;return n.a.createElement("div",{className:"dashboard-header"},n.a.createElement(Lf,{dashboardConfiguration:t}),n.a.createElement(a,{dashboardConfiguration:t,headerExtra:r}))}Rf(Mf,"propTypes",{ignoreBlanks:se.a.bool,isEditable:se.a.bool,placeholder:se.a.string,value:se.a.string,onDone:se.a.func.isRequired,onStopEditing:se.a.func,multiline:se.a.bool,editorProps:se.a.object,defaultEditing:se.a.bool}),Rf(Mf,"defaultProps",{ignoreBlanks:!1,isEditable:!0,placeholder:"",value:"",onStopEditing:()=>{},multiline:!1,editorProps:{},defaultEditing:!1}),Lf.propTypes={dashboardConfiguration:se.a.object.isRequired},Uf.propTypes={dashboardConfiguration:se.a.object.isRequired},Vf.propTypes={dashboardConfiguration:se.a.object.isRequired},Bf.propTypes={dashboardConfiguration:se.a.object.isRequired,headerExtra:se.a.node},Qf.propTypes={dashboardConfiguration:se.a.object.isRequired,headerExtra:se.a.node},Wf.propTypes={dashboardConfiguration:se.a.object.isRequired,headerExtra:se.a.node};var Hf=["dashboardConfiguration","className"];function Gf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Kf(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Yf(){return(Yf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function $f(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Jf(e){var t=e.dashboardConfiguration,r=t.dashboard,a=t.updateDashboard;return n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement(ic.a,{checked:!!r.dashboard_filters_enabled,onChange:e=>{var t=e.target;return a({dashboard_filters_enabled:t.checked})},"data-test":"DashboardFiltersCheckbox"},"Use Dashboard Level Filters"))}function Xf(e){var t=e.dashboardConfiguration,r=e.className,a=$f(e,Hf),i=t.showAddTextboxDialog,s=t.showAddWidgetDialog;return n.a.createElement("div",Yf({className:ge()("add-widget-container",r)},a),n.a.createElement("h2",null,n.a.createElement("i",{className:"zmdi zmdi-widgets","aria-hidden":"true"}),n.a.createElement("span",{className:"hidden-xs hidden-sm"},"Widgets are individual query visualizations or text boxes you can place on your dashboard in various arrangements.")),n.a.createElement("div",null,n.a.createElement(h.a,{className:"m-r-15",onClick:i,"data-test":"AddTextboxButton"},"Add Textbox"),n.a.createElement(h.a,{type:"primary",onClick:s,"data-test":"AddWidgetButton"},"Add Widget")))}function Zf(e){var t=If(e.dashboard),r=t.dashboard,i=t.filters,s=t.setFilters,o=t.loadDashboard,l=t.loadWidget,u=t.removeWidget,d=t.saveDashboardLayout,m=t.globalParameters,p=t.updateDashboard,f=t.refreshDashboard,h=t.refreshWidget,b=t.editingLayout,g=t.setGridDisabled,y=Gf(Object(a.useState)(null),2),v=y[0],O=y[1],E=Gf(Object(a.useState)({}),2),j=E[0],w=E[1];return Object(a.useEffect)(()=>{if(v)return jp(v,()=>{if(b){var e=window.getComputedStyle(v,null),t=v.getBoundingClientRect(),r=parseFloat(e.paddingLeft)||0,a=parseFloat(e.paddingRight)||0;w({left:Math.round(t.left)+a,width:v.clientWidth-r-a})}window.dispatchEvent(new Event("resize"))})},[v,b]),n.a.createElement("div",{className:"container",ref:O,"data-test":"DashboardId".concat(r.id,"Container")},n.a.createElement(Wf,{dashboardConfiguration:t,headerExtra:n.a.createElement(pe,{name:"Dashboard.HeaderExtra",dashboard:r,dashboardConfiguration:t})}),!Object(c.isEmpty)(m)&&n.a.createElement("div",{className:"dashboard-parameters m-b-10 p-15 bg-white tiled","data-test":"DashboardParameters"},n.a.createElement(bd,{parameters:m,onValuesChange:f,sortable:b,onParametersEdit:e=>{var t=Object(c.map)(e,"name");p({options:{globalParamOrder:t}})}})),!Object(c.isEmpty)(i)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled","data-test":"DashboardFilters"},n.a.createElement(Td,{filters:i,onChange:s})),b&&n.a.createElement(Jf,{dashboardConfiguration:t}),n.a.createElement("div",{id:"dashboard-container"},n.a.createElement(vp,{dashboard:r,widgets:r.widgets,filters:i,isEditing:b,onLayoutChange:b?d:()=>{},onBreakpointChange:g,onLoadWidget:l,onRefreshWidget:h,onRemoveWidget:u,onParameterMappingsChange:o})),b&&n.a.createElement(Xf,{dashboardConfiguration:t,style:j}))}function eh(e){var t=e.dashboardSlug,r=e.dashboardId,i=e.onError,s=Gf(Object(a.useState)(null),2),o=s[0],l=s[1],c=Dd(i);return Object(a.useEffect)(()=>{$r.get({id:r,slug:t}).then(e=>{vt("view","dashboard",e.id),l(e),r||R.setPath(tt.parse(e.url).pathname,!0)}).catch(c)},[r,t,c]),n.a.createElement("div",{className:"dashboard-page"},o&&n.a.createElement(Zf,{dashboard:o}))}Jf.propTypes={dashboardConfiguration:se.a.object.isRequired},Xf.propTypes={dashboardConfiguration:se.a.object.isRequired,className:se.a.string},Zf.propTypes={dashboard:se.a.object.isRequired},eh.propTypes={dashboardSlug:se.a.string,dashboardId:se.a.string,onError:se.a.func},eh.defaultProps={dashboardSlug:null,dashboardId:null,onError:se.a.func},jn.register("Dashboards.LegacyViewOrEdit",Ga({path:"/dashboard/:dashboardSlug",render:e=>n.a.createElement(eh,e)})),jn.register("Dashboards.ViewOrEdit",Ga({path:"/dashboards/:dashboardId([^-]+)(-.*)?",render:e=>n.a.createElement(eh,e)}));var th=["render","getApiKey"];function rh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ah(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function nh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ah(Object(r),!0).forEach((function(t){ih(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ah(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ih(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function lh(e){var t=e.apiKey,r=e.currentRoute,i=e.renderChildren,s=sh(Object(a.useState)(!1),2),o=s[0],l=s[1],c=Object(a.useContext)(P.ErrorBoundaryContext).handleError;return Object(a.useEffect)(()=>{var e=!1;return re.setApiKey(t),re.loadConfig().then(()=>{e||l(!0)}).catch(()=>{e||l(!1)}),()=>{e=!0}},[t]),!o||$.disablePublicUrls?null:n.a.createElement(n.a.Fragment,{key:r.key},i(nh(nh({},r.routeParams),{},{pageTitle:r.title,onError:c,apiKey:t})))}function ch(e){var t=e.render,r=e.getApiKey;return nh(nh({},rh(e,th)),{},{render:e=>n.a.createElement(lh,{apiKey:r(e),currentRoute:e,renderChildren:t})})}function uh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dh(e){var t=e.dashboard,r=If(t),a=r.globalParameters,i=r.filters,s=r.setFilters,o=r.refreshDashboard,l=r.loadWidget,u=r.refreshWidget;return n.a.createElement("div",{className:"container p-t-10 p-b-20"},n.a.createElement(Dn,{title:t.name}),!Object(c.isEmpty)(a)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement(bd,{parameters:a,onValuesChange:o})),!Object(c.isEmpty)(i)&&n.a.createElement("div",{className:"m-b-10 p-15 bg-white tiled"},n.a.createElement(Td,{filters:i,onChange:s})),n.a.createElement("div",{id:"dashboard-container"},n.a.createElement(vp,{dashboard:t,widgets:t.widgets,filters:i,isEditing:!1,isPublic:!0,onLoadWidget:l,onRefreshWidget:u})))}lh.propTypes={apiKey:se.a.string.isRequired,renderChildren:se.a.func},lh.defaultProps={renderChildren:()=>null},dh.propTypes={dashboard:se.a.object.isRequired};class mh extends n.a.Component{constructor(){super(...arguments),uh(this,"state",{loading:!0,dashboard:null})}componentDidMount(){$r.getByToken({token:this.props.token}).then(e=>this.setState({dashboard:e,loading:!1})).catch(e=>this.props.onError(e))}render(){var e=this.state,t=e.loading,r=e.dashboard;return n.a.createElement("div",{className:"public-dashboard-page"},t?n.a.createElement("div",{className:"container loading-message"},n.a.createElement(Ie,{className:"",icon:"fa-spinner fa-2x fa-pulse",message:"Loading..."})):n.a.createElement(dh,{dashboard:r}),n.a.createElement("div",{id:"footer"},n.a.createElement("div",{className:"text-center"},n.a.createElement(S,{href:"https://redash.io"},n.a.createElement("img",{alt:"Redash Logo",src:da.default,width:"38"}))),"Powered by ",n.a.createElement(S,{href:"https://redash.io/?ref=public-dashboard"},"Redash")))}}function ph(){return(ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function fh(e){return n.a.createElement("div",{className:"text-center"},n.a.createElement(Ie,ph({icon:"fa-search",message:"Sorry, we couldn't find anything."},e)))}function hh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bh(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bh(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function gh(){return(gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function yh(e){var t=e.item,r=e.keySuffix,a={key:"card".concat(r),className:"visual-card",onClick:t.onClick,children:n.a.createElement(n.a.Fragment,null,n.a.createElement("img",{alt:t.title,src:t.imgSrc}),n.a.createElement("h3",null,t.title))};return t.href?n.a.createElement(S,gh({href:t.href},a)):n.a.createElement(Ee,gh({type:"link"},a))}function vh(e){var t=e.items,r=void 0===t?[]:t,i=e.showSearch,s=void 0!==i&&i,o=hh(Object(a.useState)(""),2),l=o[0],u=o[1],d=r.filter(e=>Object(c.isEmpty)(l)||Object(c.includes)(e.title.toLowerCase(),l.toLowerCase()));return n.a.createElement("div",{"data-test":"CardsList"},s&&n.a.createElement("div",{className:"row p-10"},n.a.createElement("div",{className:"col-md-4 col-md-offset-4"},n.a.createElement(He.a.Search,{placeholder:"Search...","aria-label":"Search cards",onChange:e=>u(e.target.value),autoFocus:!0}))),Object(c.isEmpty)(d)?n.a.createElement(fh,{className:""}):n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-lg-12 d-inline-flex flex-wrap visual-card-list"},d.map((e,t)=>n.a.createElement(yh,{key:t,item:e,keySuffix:t.toString()})))))}uh(mh,"propTypes",{token:se.a.string.isRequired,onError:se.a.func}),uh(mh,"defaultProps",{onError:()=>{}}),jn.register("Dashboards.ViewShared",ch({path:"/public/dashboards/:token",render:e=>n.a.createElement(mh,e),getApiKey:e=>e.routeParams.token})),vh.propTypes={items:se.a.arrayOf(se.a.shape({title:se.a.string.isRequired,imgSrc:se.a.string.isRequired,onClick:se.a.func,href:se.a.string})),showSearch:se.a.bool};var Oh=r(443),Eh=r.n(Oh),jh=r(315),wh=r.n(jh),Sh=["collapsed","children","className"];function Ph(){return(Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Ch(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Nh(e){var t=e.collapsed,r=e.children,a=e.className,i=Ch(e,Sh);return n.a.createElement(wh.a,Ph({},i,{activeKey:t?null:"content",className:ge()(a,"ant-collapse-headerless")}),n.a.createElement(wh.a.Panel,{key:"content",header:""},r))}function kh(e){var t=e.title,r=e.name;return t||bi(r)}Nh.propTypes={collapsed:se.a.bool,children:se.a.node,className:se.a.string},Nh.defaultProps={collapsed:!0,children:null,className:""};var _h=r(308),Ah=r.n(_h);function xh(){return(xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var qh=Object(a.forwardRef)((function(e,t){return n.a.createElement("div",{className:"ace-editor-input","data-test":e["data-test"]},n.a.createElement(Ah.a,xh({ref:t,mode:"sql",theme:"textmate",height:"100px",editorProps:{$blockScrolling:1/0},showPrintMargin:!1},e)))})),Th=["form","field"];function Ih(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Dh=["form","field"];function Rh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Mh=r(706),zh=r.n(Mh),Fh=r(707),Lh=r.n(Fh),Uh=["form","field"];function Vh(){return(Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Bh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Qh=["form","field"];function Wh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Hh(e){e.form,e.field;var t=Wh(e,Qh);return n.a.createElement(He.a,t)}var Gh=["form","field"];function Kh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Yh=["form","field"];function $h(){return($h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Jh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Xh=["form","field"];function Zh(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var eb=["form","field"];function tb(){return(tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function rb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ab(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rb(Object(r),!0).forEach((function(t){nb(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rb(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ib(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var sb=se.a.shape({name:se.a.string.isRequired,title:se.a.string,type:se.a.oneOf(["ace","text","textarea","email","password","number","checkbox","file","select","content"]).isRequired,initialValue:se.a.oneOfType([se.a.string,se.a.number,se.a.bool,se.a.arrayOf(se.a.string),se.a.arrayOf(se.a.number)]),content:se.a.node,mode:se.a.string,required:se.a.bool,extra:se.a.bool,readOnly:se.a.bool,autoFocus:se.a.bool,minLength:se.a.number,placeholder:se.a.string,contentAfter:se.a.oneOfType([se.a.node,se.a.func]),loading:se.a.bool,props:se.a.object}),ob={checkbox:function(e){e.form;var t=e.field,r=Rh(e,Dh),a=kh(t);return n.a.createElement(ic.a,r,a)},file:function(e){var t=e.form,r=e.field,a=Bh(e,Uh),i=r.name,s=r.initialValue,o=t.getFieldValue,l=void 0!==o(i)&&o(i)!==s;return n.a.createElement(zh.a,Vh({},a,{beforeUpload:()=>!1}),n.a.createElement(h.a,{disabled:l},n.a.createElement(Lh.a,null)," Click to upload"))},select:function(e){e.form;var t=e.field,r=Jh(e,Yh),a=t.readOnly;return n.a.createElement(Xi.a,$h({},r,{optionFilterProp:"children",loading:t.loading||!1,mode:t.mode,getPopupContainer:e=>e.parentNode}),t.options&&t.options.map(e=>n.a.createElement(Xi.a.Option,{key:"".concat(e.value),value:e.value,disabled:a},e.name||e.value)))},number:function(e){e.form,e.field;var t=Kh(e,Gh);return n.a.createElement(Mo.a,t)},textarea:function(e){e.form,e.field;var t=Zh(e,Xh);return n.a.createElement(He.a.TextArea,t)},ace:function(e){e.form,e.field;var t=Ih(e,Th);return n.a.createElement(qh,t)},content:function(e){return e.field.content}};function lb(e){var t=e.form,r=e.field,a=ib(e,eb),i=r.name,s=r.type,o=r.readOnly,l=r.autoFocus,u=kh(r),d=ab(ab({},r.props),{},{className:"w-100",name:i,type:s,readOnly:o,autoFocus:l,placeholder:r.placeholder,"data-test":u},a),m=Object(c.get)(ob,s,Hh);return n.a.createElement(m,tb({},d,{form:t,field:r}))}function cb(e,t,r){var a=new Array(t.length);return Object.keys(e).forEach(n=>{var i=t.indexOf(n),s={name:n,title:e[n].title,type:e[n].type,placeholder:Object(c.isNil)(e[n].default)?null:e[n].default.toString(),required:e[n].required,extra:e[n].extra,initialValue:r[n]};"select"===s.type&&(s.placeholder="Select an option",s.options=e[n].options),i>-1?a[i]=s:a.push(s)}),a}function ub(e){Object(c.each)(e.properties,(t,r)=>{"password"!==r&&"passwd"!==r||(t.type="password"),r.endsWith("File")&&(t.type="file"),"boolean"===t.type&&(t.type="checkbox"),"string"===t.type&&(t.type="text"),Object(c.isEmpty)(t.enum)||(t.type="select",t.options=Object(c.map)(t.enum,e=>({value:e,name:e}))),Object(c.isEmpty)(t.extendedEnum)||(t.type="select",t.options=t.extendedEnum),t.required=Object(c.includes)(e.required,r),t.extra=Object(c.includes)(e.extra_options,r)}),e.order=e.order||[]}function db(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.properties;Object.keys(r).forEach(e=>{var a=r[e];if(Object(c.isUndefined)(a.default)||"checkbox"!==a.type||(t[e]=a.default),"select"===a.type){var n=Object(c.map)(a.options,e=>e.value);t[e]=Object(c.includes)(n,a.default)?a.default:n[0]}})}lb.propTypes={field:sb.isRequired};var mb={getFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{options:{}},r=e.configuration_schema;ub(r);var a=Object.keys(t.options).length>0;a||db(r,t.options);var i=!t.id,s=[{name:"name",title:"Name",type:"text",required:!0,initialValue:t.name,contentAfter:n.a.createElement("hr"),placeholder:"My ".concat(e.name),autoFocus:i},...cb(r.properties,r.order,t.options)];return s},updateTargetWithValues:function(e,t){e.name=t.name,Object.keys(t).forEach(r=>{"name"!==r&&(e.options[r]=t[r])})},getBase64:function(e){return new Promise((t,r)=>{var a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result.substr(a.result.indexOf(",")+1)),a.onerror=e=>r(e)})},hasFilledExtraField:function(e,t){var r=Object(c.get)(e,"configuration_schema.extra_options",[]);return Object(c.some)(r,r=>{var a=Object(c.get)(e,["configuration_schema","properties",r,"default"]),n=Object(c.get)(t,["options",r]);return!Object(c.isNil)(n)&&n!==a})}};function pb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fb(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fb(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var hb=se.a.shape({name:se.a.string.isRequired,callback:se.a.func.isRequired,type:se.a.string,pullRight:se.a.bool,disabledWhenDirty:se.a.bool}),bb=se.a.shape({validateFieldsAndScroll:se.a.func}),gb=e=>{var t=e.type,r=e.required,a=e.minLength;return[r&&{required:r,message:"This field is required."},a&&Object(c.includes)(["text","email","password"],t)&&{min:a,message:"This field is too short."},"email"===t&&{type:"email",message:"This field must be a valid email."}].filter(e=>e)};function yb(e){var t=e.fields,r=e.feedbackIcons,a=e.form;return t.map(e=>{var t=e.name,i=e.type,s=e.initialValue,o=e.contentAfter,l=kh(e),u={name:t,className:"m-b-10",hasFeedback:"checkbox"!==i&&"file"!==i&&r,label:"checkbox"===i?"":l,rules:gb(e),valuePropName:"checkbox"===i?"checked":"value",initialValue:s};return"file"===i&&(u.valuePropName="data-value",u.getValueFromEvent=e=>{e&&e.fileList[0]&&mb.getBase64(e.file).then(e=>{a.setFieldsValue({[t]:e})})}),n.a.createElement(n.a.Fragment,{key:t},n.a.createElement(Co.a.Item,u,n.a.createElement(lb,{field:e,form:a})),Object(c.isFunction)(o)?o(a.getFieldValue(t)):o)})}yb.propTypes={fields:se.a.arrayOf(sb),feedbackIcons:se.a.bool,form:bb.isRequired},yb.defaultProps={fields:[],feedbackIcons:!1};var vb=(e,t)=>(t.inProgress?e.add(t.actionName):e.delete(t.actionName),new Set(e));function Ob(e){var t=e.actions,r=e.isFormDirty,i=pb(Object(a.useReducer)(vb,new Set),2),s=i[0],o=i[1],l=Object(a.useCallback)(e=>{var t=e.name;Object(c.isFunction)(e.callback)&&(o({actionName:t,inProgress:!0}),e.callback(()=>{o({actionName:t,inProgress:!1})}))},[]);return t.map(e=>n.a.createElement(h.a,{key:e.name,htmlType:"button",className:ge()("m-t-10",{"pull-right":e.pullRight}),type:e.type,disabled:r&&e.disableWhenDirty,loading:s.has(e.name),onClick:()=>l(e)},e.name))}function Eb(e){var t=e.id,r=e.fields,i=e.actions,s=e.feedbackIcons,o=e.hideSubmitButton,l=e.defaultShowExtraFields,u=e.saveText,d=e.onSubmit,m=pb(Object(a.useState)(!1),2),p=m[0],f=m[1],b=pb(Object(a.useState)(!1),2),g=b[0],y=b[1],v=pb(Object(a.useState)(l),2),O=v[0],E=v[1],j=pb(Co.a.useForm(),1)[0],w=Object(c.filter)(r,{extra:!0}),S=Object(c.difference)(r,w),P=Object(a.useCallback)(e=>{f(!0),e=function(e,t){return Object(c.mapValues)(t,(t,r)=>{var a=(Object(c.find)(e,{name:r})||{}).initialValue;return null!=a&&""!==a||""!==t?t:null})}(r,e),d(e,e=>{f(!1),y(!1),un.success(e)},e=>{f(!1),un.error(e)})},[r,d]),C=Object(a.useCallback)(e=>{var t=e.errorFields;j.scrollToField(t[0].name)},[j]);return n.a.createElement(Co.a,{form:j,onFieldsChange:()=>{y(!0)},id:t,className:"dynamic-form",layout:"vertical",onFinish:P,onFinishFailed:C},n.a.createElement(yb,{fields:S,feedbackIcons:s,form:j}),!Object(c.isEmpty)(w)&&n.a.createElement("div",{className:"extra-options"},n.a.createElement(h.a,{type:"dashed",block:!0,className:"extra-options-button",onClick:()=>E(e=>!e)},"Additional Settings",n.a.createElement("i",{className:ge()("fa m-l-5",{"fa-caret-up":O,"fa-caret-down":!O}),"aria-hidden":"true"})),n.a.createElement(Nh,{collapsed:!O,className:"extra-options-content"},n.a.createElement(yb,{fields:w,feedbackIcons:s,form:j}))),!o&&n.a.createElement(h.a,{className:"w-100 m-t-20",type:"primary",htmlType:"submit",disabled:p},u),n.a.createElement(Ob,{actions:i,isFormDirty:g}))}function jb(){return(jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function wb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ob.propTypes={actions:se.a.arrayOf(hb),isFormDirty:se.a.bool},Ob.defaultProps={actions:[],isFormDirty:!1},Eb.propTypes={id:se.a.string,fields:se.a.arrayOf(sb),actions:se.a.arrayOf(hb),feedbackIcons:se.a.bool,hideSubmitButton:se.a.bool,defaultShowExtraFields:se.a.bool,saveText:se.a.string,onSubmit:se.a.func},Eb.defaultProps={id:null,fields:[],actions:[],feedbackIcons:!1,hideSubmitButton:!1,defaultShowExtraFields:!1,saveText:"Save",onSubmit:()=>{}};var Sb=Eh.a.Step,Pb=He.a.Search,Cb=0,Nb=1,kb=2;class _b extends n.a.Component{constructor(){super(...arguments),wb(this,"state",{searchText:"",selectedType:null,savingSource:!1,currentStep:Cb}),wb(this,"formId",Object(c.uniqueId)("sourceForm")),wb(this,"selectType",e=>{this.setState({selectedType:e,currentStep:Nb})}),wb(this,"resetType",()=>{this.state.currentStep===Nb&&this.setState({searchText:"",selectedType:null,currentStep:Cb})}),wb(this,"createSource",(e,t,r)=>{var a=this.state,n=a.selectedType;a.savingSource||(this.setState({savingSource:!0,currentStep:kb}),this.props.onCreate(n,e).then(e=>{t("Saved."),this.props.dialog.close({success:!0,data:e})}).catch(e=>{this.setState({savingSource:!1,currentStep:Nb}),r(Object(c.get)(e,"response.data.message","Failed saving."))}))})}renderTypeSelector(){var e=this.props.types,t=this.state.searchText,r=e.filter(e=>Object(c.isEmpty)(t)||Object(c.includes)(e.name.toLowerCase(),t.toLowerCase()));return n.a.createElement("div",{className:"m-t-10"},n.a.createElement(Pb,{placeholder:"Search...","aria-label":"Search",onChange:e=>this.setState({searchText:e.target.value}),autoFocus:!0,"data-test":"SearchSource"}),n.a.createElement("div",{className:"scrollbox p-5 m-t-10",style:{minHeight:"30vh",maxHeight:"40vh"}},Object(c.isEmpty)(r)?n.a.createElement(fh,{className:""}):n.a.createElement(to.a,{size:"small",dataSource:r,renderItem:e=>this.renderItem(e)})))}renderForm(){var e=this.props,t=e.imageFolder,r=e.helpTriggerPrefix,a=this.state.selectedType,i=mb.getFields(a),s="".concat(r).concat(Object(c.toUpper)(a.type));return n.a.createElement("div",null,n.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},n.a.createElement("img",{className:"p-5",src:"".concat(t,"/").concat(a.type,".png"),alt:a.name,width:"48"}),n.a.createElement("h4",{className:"m-0"},a.name)),n.a.createElement("div",{className:"text-right"},Ue[s]&&n.a.createElement(Qe,{className:"f-13",type:s},"Setup Instructions ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(help)"))),n.a.createElement(Eb,{id:this.formId,fields:i,onSubmit:this.createSource,feedbackIcons:!0,hideSubmitButton:!0}),"databricks"===a.type&&n.a.createElement("small",null,"By using the Databricks Data Source you agree to the Databricks JDBC/ODBC"," ",n.a.createElement(S,{href:"https://databricks.com/spark/odbc-driver-download",target:"_blank",rel:"noopener noreferrer"},"Driver Download Terms and Conditions"),"."))}renderItem(e){var t=this.props.imageFolder;return n.a.createElement(to.a.Item,{className:"p-l-10 p-r-10 clickable",onClick:()=>this.selectType(e)},n.a.createElement(Mp,{title:e.name,imageUrl:"".concat(t,"/").concat(e.type,".png"),roundedImage:!1,"data-test":"PreviewItem","data-test-type":e.type},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})))}render(){var e=this.state,t=e.currentStep,r=e.savingSource,a=this.props,i=a.dialog,s=a.sourceType;return n.a.createElement(V.a,jb({},i.props,{title:"Create a New ".concat(s),footer:t===Cb?[n.a.createElement(h.a,{key:"cancel",onClick:()=>i.dismiss(),"data-test":"CreateSourceCancelButton"},"Cancel"),n.a.createElement(h.a,{key:"submit",type:"primary",disabled:!0},"Create")]:[n.a.createElement(h.a,{key:"previous",onClick:this.resetType},"Previous"),n.a.createElement(h.a,{key:"submit",htmlType:"submit",form:this.formId,type:"primary",loading:r,"data-test":"CreateSourceSaveButton"},"Create")]}),n.a.createElement("div",{"data-test":"CreateSourceDialog"},n.a.createElement(Eh.a,{className:"hidden-xs m-b-10",size:"small",current:t,progressDot:!0},t===Nb?n.a.createElement(Sb,{title:n.a.createElement("a",null,"Type Selection"),className:"clickable",onClick:this.resetType}):n.a.createElement(Sb,{title:"Type Selection"}),n.a.createElement(Sb,{title:"Configuration"}),n.a.createElement(Sb,{title:"Done"})),t===Cb&&this.renderTypeSelector(),t!==Cb&&this.renderForm()))}}wb(_b,"propTypes",{dialog:Je.isRequired,types:se.a.arrayOf(se.a.object),sourceType:se.a.string.isRequired,imageFolder:se.a.string.isRequired,helpTriggerPrefix:se.a.string,onCreate:se.a.func.isRequired}),wb(_b,"defaultProps",{types:[],helpTriggerPrefix:null});var Ab=Xe(_b);var xb=function(e,t,r){return ua.add(e,t),function(e){var t=ua.getActiveItem(R.path);return n.a.createElement("div",{className:"settings-screen"},n.a.createElement("div",{className:"container"},n.a.createElement(Dn,{title:"Settings"}),n.a.createElement("div",{className:"bg-white tiled"},n.a.createElement(he.a,{selectedKeys:[t&&t.title],selectable:!1,mode:"horizontal"},ua.getAvailableItems().map(e=>n.a.createElement(he.a.Item,{key:e.title},n.a.createElement(S,{href:e.path,"data-test":"SettingsScreenItem"},e.title)))),n.a.createElement("div",{className:"p-15"},n.a.createElement("div",null,n.a.createElement(r,e))))))}};function qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Tb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qb(Object(r),!0).forEach((function(t){Ib(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qb(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ib(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Db(e){return Object(c.map)(e,e=>Object(c.isObject)(e)?e:{name:e})}var Rb={query:()=>K.get("api/data_sources"),get:e=>{var t=e.id;return K.get("api/data_sources/".concat(t))},types:()=>K.get("api/data_sources/types"),create:e=>K.post("api/data_sources",e),save:e=>K.post("api/data_sources/".concat(e.id),e),test:e=>K.post("api/data_sources/".concat(e.id,"/test")),delete:e=>{var t=e.id;return K.delete("api/data_sources/".concat(t))},fetchSchema:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={};return t&&(r.refresh=!0),K.get("api/data_sources/".concat(e.id,"/schema"),{params:r}).then(e=>Object(c.has)(e,"job")?Yt(e.job.id).catch(t=>1===t.code?[]:Promise.reject(new Error(e.job.error))):Object(c.has)(e,"schema")?e.schema:Promise.reject()).then(e=>Object(c.map)(e,e=>Tb(Tb({},e),{},{columns:Db(e.columns)})))}};function Mb(){return(Mb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function zb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}me("DataSourcesListComponent",(function(e){var t=e.dataSources,r=e.onClickCreate,a=t.map(e=>({title:e.name,imgSrc:"".concat("static/images/db-logos","/").concat(e.type,".png"),href:"data_sources/".concat(e.id)}));return Object(c.isEmpty)(t)?n.a.createElement("div",{className:"text-center"},"There are no data sources yet.",ae.isCreateDataSourceEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(Ee,{type:"link",onClick:r,"data-test":"CreateDataSourceLink"},"Click here")," ","to add one.")):n.a.createElement(vh,{items:a})}));class Fb extends n.a.Component{constructor(){var e;super(...arguments),e=this,zb(this,"state",{dataSourceTypes:[],dataSources:[],loading:!0}),zb(this,"newDataSourceDialog",null),zb(this,"createDataSource",(e,t)=>{var r={options:{},type:e.type};return mb.updateTargetWithValues(r,t),Rb.create(r).then(e=>(this.setState({loading:!0}),Rb.query().then(e=>this.setState({dataSources:e,loading:!1})),e))}),zb(this,"showCreateSourceDialog",()=>{vt("view","page","data_sources/new"),this.newDataSourceDialog=Ab.showModal({types:Object(c.reject)(this.state.dataSourceTypes,"deprecated"),sourceType:"Data Source",imageFolder:"static/images/db-logos",helpTriggerPrefix:"DS_",onCreate:this.createDataSource}),this.newDataSourceDialog.onClose((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.newDataSourceDialog=null,t.success&&bt("data_sources/".concat(t.data.id))})).onDismiss(()=>{this.newDataSourceDialog=null,bt("data_sources",!0)})})}componentDidMount(){Promise.all([Rb.query(),Rb.types()]).then(e=>this.setState({dataSources:e[0],dataSourceTypes:e[1],loading:!1},()=>{this.props.isNewDataSourcePage&&(ae.canCreateDataSource()?this.showCreateSourceDialog():bt("data_sources",!0))})).catch(e=>this.props.onError(e))}componentWillUnmount(){this.newDataSourceDialog&&this.newDataSourceDialog.dismiss()}render(){var e={type:"primary",onClick:ae.isCreateDataSourceEnabled()?this.showCreateSourceDialog:null,disabled:!ae.isCreateDataSourceEnabled(),"data-test":"CreateDataSourceButton"};return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(h.a,e,n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Data Source"),n.a.createElement(pe,{name:"DataSourcesListExtra"})),this.state.loading?n.a.createElement(Ys,{className:""}):n.a.createElement(pe,{name:"DataSourcesListComponent",dataSources:this.state.dataSources,onClickCreate:this.showCreateSourceDialog}))}}zb(Fb,"propTypes",{isNewDataSourcePage:se.a.bool,onError:se.a.func}),zb(Fb,"defaultProps",{isNewDataSourcePage:!1,onError:()=>{}});var Lb=xb("DataSources.List",{permission:"admin",title:"Data Sources",path:"data_sources",order:1},Fb);function Ub(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jn.register("DataSources.List",Ga({path:"/data_sources",title:"Data Sources",render:e=>n.a.createElement(Lb,e)})),jn.register("DataSources.New",Ga({path:"/data_sources/new",title:"Data Sources",render:e=>n.a.createElement(Lb,Mb({},e,{isNewDataSourcePage:!0}))}));class Vb extends n.a.Component{constructor(){super(...arguments),Ub(this,"state",{dataSource:null,type:null,loading:!0}),Ub(this,"saveDataSource",(e,t,r)=>{var a=this.state.dataSource;mb.updateTargetWithValues(a,e),Rb.save(a).then(()=>t("Saved.")).catch(e=>{var t=Object(c.get)(e,"response.data.message","Failed saving.");r(t)})}),Ub(this,"deleteDataSource",e=>{var t=this.state.dataSource;V.a.confirm({title:"Delete Data Source",content:"Are you sure you want to delete this data source?",okText:"Delete",okType:"danger",onOk:()=>{Rb.delete(t).then(()=>{un.success("Data source deleted successfully."),bt("data_sources")}).catch(()=>{e()})},onCancel:e,maskClosable:!0,autoFocusButton:null})}),Ub(this,"testConnection",e=>{var t=this.state.dataSource;Rb.test({id:t.id}).then(t=>{t.ok?un.success("Success"):un.error("Connection Test Failed:",t.message,{duration:10}),e()}).catch(()=>{un.error("Connection Test Failed:","Unknown error occurred while performing connection test. Please try again later.",{duration:10}),e()})})}componentDidMount(){Rb.get({id:this.props.dataSourceId}).then(e=>{var t=e.type;this.setState({dataSource:e}),Rb.types().then(e=>this.setState({type:Object(c.find)(e,{type:t}),loading:!1}))}).catch(e=>this.props.onError(e))}renderForm(){var e=this.state,t=e.dataSource,r=e.type,a=mb.getFields(r,t),i="DS_".concat(Object(c.toUpper)(r.type)),s={fields:a,type:r,actions:[{name:"Delete",type:"danger",callback:this.deleteDataSource},{name:"Test Connection",pullRight:!0,callback:this.testConnection,disableWhenDirty:!0}],onSubmit:this.saveDataSource,feedbackIcons:!0,defaultShowExtraFields:mb.hasFilledExtraField(r,t)};return n.a.createElement("div",{className:"row","data-test":"DataSource"},n.a.createElement("div",{className:"text-right m-r-10"},Ue[i]&&n.a.createElement(Qe,{className:"f-13",type:i},"Setup Instructions ",n.a.createElement("i",{className:"fa fa-question-circle","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(help)"))),n.a.createElement("div",{className:"text-center m-b-10"},n.a.createElement("img",{className:"p-5",src:"".concat("static/images/db-logos","/").concat(r.type,".png"),alt:r.name,width:"64"}),n.a.createElement("h3",{className:"m-0"},r.name)),n.a.createElement("div",{className:"col-md-4 col-md-offset-4 m-b-10"},n.a.createElement(Eb,s)))}render(){return this.state.loading?n.a.createElement(Ys,{className:""}):this.renderForm()}}Ub(Vb,"propTypes",{dataSourceId:se.a.string.isRequired,onError:se.a.func}),Ub(Vb,"defaultProps",{onError:()=>{}});var Bb=xb("DataSources.Edit",null,Vb);function Qb(){return(Qb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Wb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jn.register("DataSources.Edit",Ga({path:"/data_sources/:dataSourceId",title:"Data Sources",render:e=>n.a.createElement(Bb,e)}));class Hb extends n.a.Component{constructor(){super(...arguments),Wb(this,"state",{destinationTypes:[],destinations:[],loading:!0}),Wb(this,"createDestination",(e,t)=>{var r={options:{},type:e.type};return mb.updateTargetWithValues(r,t),ml.create(r).then(e=>(this.setState({loading:!0}),ml.query().then(e=>this.setState({destinations:e,loading:!1})),e))}),Wb(this,"showCreateSourceDialog",()=>{Ab.showModal({types:Object(c.reject)(this.state.destinationTypes,"deprecated"),sourceType:"Alert Destination",imageFolder:dl,onCreate:this.createDestination}).onClose((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.success&&bt("destinations/".concat(e.data.id))})).onDismiss(()=>{bt("destinations",!0)})})}componentDidMount(){Promise.all([ml.query(),ml.types()]).then(e=>this.setState({destinations:e[0],destinationTypes:e[1],loading:!1},()=>{this.props.isNewDestinationPage&&(ae.canCreateDestination()?this.showCreateSourceDialog():bt("destinations",!0))})).catch(e=>this.props.onError(e))}renderDestinations(){var e=this.state.destinations,t=e.map(e=>({title:e.name,imgSrc:"".concat(dl,"/").concat(e.type,".png"),href:"destinations/".concat(e.id)}));return Object(c.isEmpty)(e)?n.a.createElement("div",{className:"text-center"},"There are no alert destinations yet.",ae.isCreateDestinationEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(Ee,{type:"link",onClick:this.showCreateSourceDialog},"Click here")," ","to add one.")):n.a.createElement(vh,{items:t})}render(){var e={type:"primary",onClick:ae.isCreateDestinationEnabled()?this.showCreateSourceDialog:null,disabled:!ae.isCreateDestinationEnabled()};return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(h.a,e,n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Alert Destination")),this.state.loading?n.a.createElement(Ys,{className:""}):this.renderDestinations())}}Wb(Hb,"propTypes",{isNewDestinationPage:se.a.bool,onError:se.a.func}),Wb(Hb,"defaultProps",{isNewDestinationPage:!1,onError:()=>{}});var Gb=xb("AlertDestinations.List",{permission:"admin",title:"Alert Destinations",path:"destinations",order:4},Hb);function Kb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jn.register("AlertDestinations.List",Ga({path:"/destinations",title:"Alert Destinations",render:e=>n.a.createElement(Gb,e)})),jn.register("AlertDestinations.New",Ga({path:"/destinations/new",title:"Alert Destinations",render:e=>n.a.createElement(Gb,Qb({},e,{isNewDestinationPage:!0}))}));class Yb extends n.a.Component{constructor(){super(...arguments),Kb(this,"state",{destination:null,type:null,loading:!0}),Kb(this,"saveDestination",(e,t,r)=>{var a=this.state.destination;mb.updateTargetWithValues(a,e),ml.save(a).then(()=>t("Saved.")).catch(e=>{var t=Object(c.get)(e,"response.data.message","Failed saving.");r(t)})}),Kb(this,"deleteDestination",e=>{var t=this.state.destination;V.a.confirm({title:"Delete Alert Destination",content:"Are you sure you want to delete this alert destination?",okText:"Delete",okType:"danger",onOk:()=>{ml.delete(t).then(()=>{un.success("Alert destination deleted successfully."),bt("destinations")}).catch(()=>{e()})},onCancel:e,maskClosable:!0,autoFocusButton:null})})}componentDidMount(){ml.get({id:this.props.destinationId}).then(e=>{var t=e.type;this.setState({destination:e}),ml.types().then(e=>this.setState({type:Object(c.find)(e,{type:t}),loading:!1}))}).catch(e=>this.props.onError(e))}renderForm(){var e=this.state,t=e.destination,r=e.type,a={fields:mb.getFields(r,t),type:r,actions:[{name:"Delete",type:"danger",callback:this.deleteDestination}],onSubmit:this.saveDestination,defaultShowExtraFields:mb.hasFilledExtraField(r,t),feedbackIcons:!0};return n.a.createElement("div",{className:"row","data-test":"Destination"},n.a.createElement("div",{className:"text-center m-b-10"},n.a.createElement("img",{className:"p-5",src:"".concat(dl,"/").concat(r.type,".png"),alt:r.name,width:"64"}),n.a.createElement("h3",{className:"m-0"},r.name)),n.a.createElement("div",{className:"col-md-4 col-md-offset-4 m-b-10"},n.a.createElement(Eb,a)))}render(){return this.state.loading?n.a.createElement(Ys,{className:""}):this.renderForm()}}Kb(Yb,"propTypes",{destinationId:se.a.string.isRequired,onError:se.a.func}),Kb(Yb,"defaultProps",{onError:()=>{}});var $b=xb("AlertDestinations.Edit",null,Yb);function Jb(){return(Jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Xb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jn.register("AlertDestinations.Edit",Ga({path:"/destinations/:destinationId",title:"Alert Destinations",render:e=>n.a.createElement($b,e)}));class Zb extends n.a.Component{constructor(){super(...arguments),Xb(this,"state",{name:""}),Xb(this,"save",()=>{this.props.dialog.close({name:this.state.name})})}render(){var e=this.props.dialog;return n.a.createElement(V.a,Jb({},e.props,{title:"Create a New Group",okText:"Create",onOk:()=>this.save()}),n.a.createElement(He.a,{className:"form-control",defaultValue:this.state.name,onChange:e=>this.setState({name:e.target.value}),onPressEnter:()=>this.save(),placeholder:"Group Name","aria-label":"Group name",autoFocus:!0}))}}Xb(Zb,"propTypes",{dialog:Je.isRequired});var eg=Xe(Zb),tg={query:()=>K.get("api/groups"),get:e=>{var t=e.id;return K.get("api/groups/".concat(t))},create:e=>K.post("api/groups",e),save:e=>K.post("api/groups/".concat(e.id),e),delete:e=>K.delete("api/groups/".concat(e.id)),members:e=>{var t=e.id;return K.get("api/groups/".concat(t,"/members"))},addMember:(e,t)=>{var r=e.id;return K.post("api/groups/".concat(r,"/members"),t)},removeMember:e=>{var t=e.id,r=e.userId;return K.delete("api/groups/".concat(t,"/members/").concat(r))},dataSources:e=>{var t=e.id;return K.get("api/groups/".concat(t,"/data_sources"))},addDataSource:(e,t)=>{var r=e.id;return K.post("api/groups/".concat(r,"/data_sources"),t)},removeDataSource:e=>{var t=e.id,r=e.dataSourceId;return K.delete("api/groups/".concat(t,"/data_sources/").concat(r))},updateDataSource:(e,t)=>{var r=e.id,a=e.dataSourceId;return K.post("api/groups/".concat(r,"/data_sources/").concat(a),t)}},rg=["group","title","onClick","children"];function ag(){return(ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ng(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ig(e){var t=e.group,r=e.title,a=e.onClick,i=e.children,s=ng(e,rg);if(!t)return null;var o=n.a.createElement(h.a,ag({},s,{type:"danger",onClick:e=>function(e,t,r){V.a.confirm({title:"Delete Group",content:"Are you sure you want to delete this group?",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>{tg.delete(t).then(()=>{un.success("Group deleted successfully."),r()})}})}(0,t,a)}),i);return Object(c.isString)(r)&&""!==r?n.a.createElement(Ne,{placement:"top",title:r,mouseLeaveDelay:0},o):o}function sg(){return(sg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function og(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ig.propTypes={group:se.a.object,title:se.a.string,onClick:se.a.func,children:se.a.node},ig.defaultProps={group:null,title:null,onClick:()=>{},children:null};class lg extends n.a.Component{constructor(){super(...arguments),og(this,"listColumns",[Ci.custom((e,t)=>n.a.createElement("div",null,n.a.createElement(S,{href:"groups/"+t.id},t.name),"builtin"===t.type&&n.a.createElement("span",{className:"label label-default m-l-10"},"built-in")),{field:"name",width:null}),Ci.custom((e,t)=>n.a.createElement(h.a.Group,null,n.a.createElement(S.Button,{href:"groups/".concat(t.id)},"Members"),Y.isAdmin&&n.a.createElement(S.Button,{href:"groups/".concat(t.id,"/data_sources")},"Data Sources")),{width:"1%",className:"text-nowrap"}),Ci.custom((e,t)=>{var r="builtin"!==t.type;return n.a.createElement(ig,{className:"w-100",disabled:!r,group:t,title:r?null:"Cannot delete built-in group",onClick:()=>this.onGroupDeleted()},"Delete")},{width:"1%",className:"text-nowrap p-l-0",isAvailable:()=>Y.isAdmin})]),og(this,"createGroup",()=>{eg.showModal().onClose(e=>tg.create(e).then(e=>bt("groups/".concat(e.id))))}),og(this,"onGroupDeleted",()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"GroupList"},Y.isAdmin&&n.a.createElement("div",{className:"m-b-15"},n.a.createElement(h.a,{type:"primary",onClick:this.createGroup},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Group")),!e.isLoaded&&n.a.createElement(Ys,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement(fh,{className:""}),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}og(lg,"propTypes",{controller:Ss.isRequired});var cg=xb("Groups.List",{permission:"list_users",title:"Groups",path:"groups",order:3},Ps(lg,()=>new Bs({isPlainList:!0,getRequest:()=>({}),getResource:()=>tg.query.bind(tg)}),()=>new Hs({orderByField:"name",itemsPerPage:10})));jn.register("Groups.List",Ga({path:"/groups",title:"Groups",render:e=>n.a.createElement(cg,sg({},e,{currentPage:"groups"}))}));var ug=r(243),dg=r.n(ug),mg=["group","onChange"];function pg(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function fg(e){var t=e.group,r=e.onChange,a=pg(e,mg);if(!t)return null;var i=Y.isAdmin&&"builtin"!==t.type;return n.a.createElement("h3",a,n.a.createElement(Mf,{className:"edit-in-place",isEditable:i,ignoreBlanks:!0,onDone:e=>function(e,t,r){e.name=t,tg.save(e),r()}(t,e,r),value:t.name}))}function hg(e){var t=e.controller,r=e.group,a=e.items,i=e.canAddMembers,s=e.onAddMembersClick,o=e.canAddDataSources,l=e.onAddDataSourcesClick,c=e.onGroupDeleted,u=r&&Y.isAdmin&&"builtin"!==r.type;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ec,{items:a,selected:t.params.currentPage}),i&&n.a.createElement(h.a,{className:"w-100 m-t-5",type:"primary",onClick:s},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"Add Members"),o&&n.a.createElement(h.a,{className:"w-100 m-t-5",type:"primary",onClick:l},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"Add Data Sources"),u&&n.a.createElement(n.a.Fragment,null,n.a.createElement(xo.a,{dashed:!0,className:"m-t-10 m-b-10"}),n.a.createElement(ig,{className:"w-100",group:r,onClick:c},"Delete Group")))}function bg(){return(bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function gg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}fg.propTypes={group:se.a.shape({name:se.a.string.isRequired}),onChange:se.a.func},fg.defaultProps={group:null,onChange:()=>{}},hg.propTypes={controller:Ss.isRequired,group:se.a.object,items:se.a.array.isRequired,canAddMembers:se.a.bool,onAddMembersClick:se.a.func,canAddDataSources:se.a.bool,onAddDataSourcesClick:se.a.func,onGroupDeleted:se.a.func},hg.defaultProps={group:null,canAddMembers:!1,onAddMembersClick:null,canAddDataSources:!1,onAddDataSourcesClick:null,onGroupDeleted:null};class yg extends n.a.Component{constructor(){super(...arguments),gg(this,"groupId",parseInt(this.props.controller.params.groupId,10)),gg(this,"group",null),gg(this,"sidebarMenu",[{key:"users",href:"groups/".concat(this.groupId),title:"Members"},{key:"datasources",href:"groups/".concat(this.groupId,"/data_sources"),title:"Data Sources",isAvailable:()=>Y.isAdmin}]),gg(this,"listColumns",[Ci.custom((e,t)=>n.a.createElement(Fp,{dataSource:t,withLink:!0}),{title:"Name",field:"name",width:null}),Ci.custom((e,t)=>{var r=n.a.createElement(he.a,{selectedKeys:[t.view_only?"viewonly":"full"],onClick:e=>this.setDataSourcePermissions(t,e.key)},n.a.createElement(he.a.Item,{key:"full"},"Full Access"),n.a.createElement(he.a.Item,{key:"viewonly"},"View Only"));return n.a.createElement(Da.a,{trigger:["click"],overlay:r},n.a.createElement(h.a,{className:"w-100","aria-label":"Permissions"},t.view_only?"View Only":"Full Access",n.a.createElement(dg.a,{"aria-hidden":"true"})))},{width:"1%",className:"p-r-0",isAvailable:()=>Y.isAdmin}),Ci.custom((e,t)=>n.a.createElement(h.a,{className:"w-100",type:"danger",onClick:()=>this.removeGroupDataSource(t)},"Remove"),{width:"1%",isAvailable:()=>Y.isAdmin})]),gg(this,"removeGroupDataSource",e=>{tg.removeDataSource({id:this.groupId,dataSourceId:e.id}).then(()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()}).catch(()=>{un.error("Failed to remove data source from group.")})}),gg(this,"setDataSourcePermissions",(e,t)=>{var r="full"!==t;tg.updateDataSource({id:this.groupId,dataSourceId:e.id},{view_only:r}).then(()=>{e.view_only=r,this.forceUpdate()}).catch(()=>{un.error("Failed change data source permissions.")})}),gg(this,"addDataSources",()=>{var e=Rb.query(),t=Object(c.map)(this.props.controller.allItems,e=>e.id);ul.showModal({dialogTitle:"Add Data Sources",inputPlaceholder:"Search data sources...",selectedItemsTitle:"New Data Sources",searchItems:t=>(t=Object(c.toLower)(t),e.then(e=>Object(c.filter)(e,e=>Object(c.includes)(Object(c.toLower)(e.name),t)))),renderItem:(e,r)=>{var a=r.isSelected,i=Object(c.includes)(t,e.id);return{content:n.a.createElement(Fp,{dataSource:e},n.a.createElement(fl,{isSelected:a,alreadyInGroup:i})),isDisabled:i,className:a||i?"selected":""}},renderStagedItem:(e,t)=>{var r=t.isSelected;return{content:n.a.createElement(Fp,{dataSource:e},n.a.createElement(fl,{isSelected:r,isStaged:!0}))}}}).onClose(e=>{var t=Object(c.map)(e,e=>tg.addDataSource({id:this.groupId},{data_source_id:e.id}));return Promise.all(t).then(()=>this.props.controller.update())})})}componentDidMount(){tg.get({id:this.groupId}).then(e=>{this.group=e,this.forceUpdate()}).catch(e=>{this.props.controller.handleError(e)})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"Group"},n.a.createElement(fg,{className:"d-block m-t-0 m-b-15",group:this.group,onChange:()=>this.forceUpdate()}),n.a.createElement(vc,null,n.a.createElement(vc.Sidebar,null,n.a.createElement(hg,{controller:e,group:this.group,items:this.sidebarMenu,canAddDataSources:Y.isAdmin,onAddDataSourcesClick:this.addDataSources,onGroupDeleted:()=>bt("groups")})),n.a.createElement(vc.Content,null,!e.isLoaded&&n.a.createElement(Ys,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},n.a.createElement("p",null,"There are no data sources in this group yet."),Y.isAdmin&&n.a.createElement(h.a,{type:"primary",onClick:this.addDataSources},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"Add Data Sources")),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}gg(yg,"propTypes",{controller:Ss.isRequired});var vg=xb("Groups.DataSources",null,Ps(yg,()=>new Bs({isPlainList:!0,getRequest:(e,t)=>({id:t.params.groupId}),getResource:()=>tg.dataSources.bind(tg)}),()=>new Hs({orderByField:"name"})));function Og(){return(Og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Eg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}jn.register("Groups.DataSources",Ga({path:"/groups/:groupId/data_sources",title:"Group Data Sources",render:e=>n.a.createElement(vg,bg({},e,{currentPage:"datasources"}))}));class jg extends n.a.Component{constructor(){super(...arguments),Eg(this,"groupId",parseInt(this.props.controller.params.groupId,10)),Eg(this,"group",null),Eg(this,"sidebarMenu",[{key:"users",href:"groups/".concat(this.groupId),title:"Members"},{key:"datasources",href:"groups/".concat(this.groupId,"/data_sources"),title:"Data Sources",isAvailable:()=>Y.isAdmin}]),Eg(this,"listColumns",[Ci.custom((e,t)=>n.a.createElement(zp,{user:t,withLink:!0}),{title:"Name",field:"name",width:null}),Ci.custom((e,t)=>this.group?"builtin"===this.group.type&&Y.id===t.id?null:n.a.createElement(h.a,{className:"w-100",type:"danger",onClick:e=>this.removeGroupMember(e,t)},"Remove"):null,{width:"1%",isAvailable:()=>Y.isAdmin})]),Eg(this,"removeGroupMember",(e,t)=>tg.removeMember({id:this.groupId,userId:t.id}).then(()=>{this.props.controller.updatePagination({page:1}),this.props.controller.update()}).catch(()=>{un.error("Failed to remove member from group.")})),Eg(this,"addMembers",()=>{var e=Object(c.map)(this.props.controller.allItems,e=>e.id);ul.showModal({dialogTitle:"Add Members",inputPlaceholder:"Search users...",selectedItemsTitle:"New Members",searchItems:e=>Wp.query({q:e}).then(e=>e.results),renderItem:(t,r)=>{var a=r.isSelected,i=Object(c.includes)(e,t.id);return{content:n.a.createElement(zp,{user:t},n.a.createElement(fl,{isSelected:a,alreadyInGroup:i})),isDisabled:i,className:a||i?"selected":""}},renderStagedItem:(e,t)=>{var r=t.isSelected;return{content:n.a.createElement(zp,{user:e},n.a.createElement(fl,{isSelected:r,isStaged:!0}))}}}).onClose(e=>{var t=Object(c.map)(e,e=>tg.addMember({id:this.groupId},{user_id:e.id}));return Promise.all(t).then(()=>this.props.controller.update())})})}componentDidMount(){tg.get({id:this.groupId}).then(e=>{this.group=e,this.forceUpdate()}).catch(e=>{this.props.controller.handleError(e)})}render(){var e=this.props.controller;return n.a.createElement("div",{"data-test":"Group"},n.a.createElement(fg,{className:"d-block m-t-0 m-b-15",group:this.group,onChange:()=>this.forceUpdate()}),n.a.createElement(vc,null,n.a.createElement(vc.Sidebar,null,n.a.createElement(hg,{controller:e,group:this.group,items:this.sidebarMenu,canAddMembers:Y.isAdmin,onAddMembersClick:this.addMembers,onGroupDeleted:()=>bt("groups")})),n.a.createElement(vc.Content,null,!e.isLoaded&&n.a.createElement(Ys,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},n.a.createElement("p",null,"There are no members in this group yet."),Y.isAdmin&&n.a.createElement(h.a,{type:"primary",onClick:this.addMembers},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"Add Members")),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,showHeader:!1,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}Eg(jg,"propTypes",{controller:Ss.isRequired});var wg=xb("Groups.Members",null,Ps(jg,()=>new Bs({isPlainList:!0,getRequest:(e,t)=>({id:t.params.groupId}),getResource:()=>tg.members.bind(tg)}),()=>new Hs({orderByField:"name"})));function Sg(e){var t=e.page,r=e.searchTerm,a=e.selectedTags;if(""!==r)return n.a.createElement(Ie,{message:"Sorry, we couldn't find anything.",icon:"fa-search"});if(a.length>0)return n.a.createElement(Oc,{objectType:"queries",tags:a});switch(t){case"favorites":return n.a.createElement(Ie,{message:"Mark queries as Favorite to list them here.",icon:"fa-star"});case"archive":return n.a.createElement(Ie,{message:"Archived queries will be listed here.",icon:"fa-archive"});case"my":var i=Y.hasPermission("create_query")?n.a.createElement("span",null,n.a.createElement(S.Button,{href:"queries/new",type:"primary",size:"small"},"Create your first query!")," ",n.a.createElement(Qe,{className:"f-13",type:"QUERIES",showTooltip:!1},"Need help?")):n.a.createElement("span",null,"Sorry, we couldn't find anything.");return n.a.createElement(Ie,{icon:"fa-search"},i);default:return n.a.createElement(pe,{name:"QueriesList.EmptyState"},n.a.createElement(Xa,{icon:"fa fa-code",illustration:"query",description:"Getting the data from your datasources.",helpMessage:n.a.createElement($a,{helpTriggerType:"QUERIES"})}))}}function Pg(){return(Pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}jn.register("Groups.Members",Ga({path:"/groups/:groupId",title:"Group Members",render:e=>n.a.createElement(wg,Og({},e,{currentPage:"users"}))})),Sg.propTypes={page:se.a.string.isRequired,searchTerm:se.a.string.isRequired,selectedTags:se.a.array.isRequired};var Cg=[{key:"all",href:"queries",title:"All Queries",icon:()=>n.a.createElement(tc,{icon:"fa fa-code"})},{key:"my",href:"queries/my",title:"My Queries",icon:()=>n.a.createElement(rc,{user:Y})},{key:"favorites",href:"queries/favorites",title:"Favorites",icon:()=>n.a.createElement(tc,{icon:"fa fa-star"})},{key:"archive",href:"queries/archive",title:"Archived",icon:()=>n.a.createElement(tc,{icon:"fa fa-archive"})}],Ng=[Ci.favorites({className:"p-r-0"}),Ci.custom.sortable((e,t)=>n.a.createElement(n.a.Fragment,null,n.a.createElement(S,{className:"table-main-title",href:"queries/"+t.id},t.name),n.a.createElement(cs,{className:"d-block",tags:t.tags,isDraft:t.is_draft,isArchived:t.is_archived})),{title:"Name",field:"name",width:null}),Ci.custom((e,t)=>t.user.name,{title:"Created By",width:"1%"}),Ci.dateTime.sortable({title:"Created At",field:"created_at",width:"1%"}),Ci.dateTime.sortable({title:"Last Executed At",field:"retrieved_at",orderByField:"executed_at",width:"1%"}),Ci.custom.sortable((e,t)=>n.a.createElement(fs,{schedule:t.schedule,isNew:t.isNew()}),{title:"Refresh Schedule",field:"schedule",width:"1%"})];function kg(e){return n.a.createElement(pe,Pg({name:"QueriesList.Actions"},e))}function _g(e){var t=e.controller,r=Object(a.useRef)();r.current=t,Object(a.useEffect)(()=>{var e=R.listen((e,t)=>{var a=R.search.q||"";"PUSH"===t&&a!==r.current.searchTerm&&r.current.updateSearch(a)});return()=>{e()}},[]);var i=cc(t,Ng,kg),s=i.areExtraActionsAvailable,o=i.listColumns,l=i.Component,c=i.selectedItems;return n.a.createElement("div",{className:"page-queries-list"},n.a.createElement("div",{className:"container"},n.a.createElement(Dn,{title:t.params.pageTitle,actions:Y.hasPermission("create_query")?n.a.createElement(S.Button,{block:!0,type:"primary",href:"queries/new"},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Query"):null}),n.a.createElement(vc,null,n.a.createElement(vc.Sidebar,{className:"m-b-0"},n.a.createElement(Zl,{placeholder:"Search Queries...",label:"Search queries",value:t.searchTerm,onChange:t.updateSearch}),n.a.createElement(ec,{items:Cg,selected:t.params.currentPage}),n.a.createElement(ac,{url:"api/queries/tags",onChange:t.updateSelectedTags,showUnselectAll:!0})),n.a.createElement(vc.Content,null,t.isLoaded&&t.isEmpty?n.a.createElement(Sg,{page:t.params.currentPage,searchTerm:t.searchTerm,selectedTags:t.selectedTags}):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:ge()({"m-b-10":s})},n.a.createElement(l,{selectedItems:c})),n.a.createElement("div",{className:"bg-white tiled table-responsive"},n.a.createElement(Ni,{items:t.pageItems,loading:!t.isLoaded,columns:o,orderByField:t.orderByField,orderByReverse:t.orderByReverse,toggleSorting:t.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:t.totalItemsCount,pageSize:t.itemsPerPage,onPageSizeChange:e=>t.updatePagination({itemsPerPage:e}),page:t.page,onChange:e=>t.updatePagination({page:e})})))))))}_g.propTypes={controller:Ss.isRequired};var Ag=Ps(_g,()=>new Bs({getResource(e){var t=e.params.currentPage;return{all:ir.query.bind(ir),my:ir.myQueries.bind(ir),favorites:ir.favorites.bind(ir),archive:ir.archive.bind(ir)}[t]},getItemProcessor:()=>e=>new ir(e)}),()=>new Gs({orderByField:"created_at",orderByReverse:!0}));jn.register("Queries.List",Ga({path:"/queries",title:"Queries",render:e=>n.a.createElement(Ag,Pg({},e,{currentPage:"all"}))})),jn.register("Queries.Favorites",Ga({path:"/queries/favorites",title:"Favorite Queries",render:e=>n.a.createElement(Ag,Pg({},e,{currentPage:"favorites"}))})),jn.register("Queries.Archived",Ga({path:"/queries/archive",title:"Archived Queries",render:e=>n.a.createElement(Ag,Pg({},e,{currentPage:"archive"}))})),jn.register("Queries.My",Ga({path:"/queries/my",title:"My Queries",render:e=>n.a.createElement(Ag,Pg({},e,{currentPage:"my"}))}));var xg=r(145),qg=r.n(xg),Tg=r(444),Ig=r.n(Tg),Dg=r(436);function Rg(){return(Rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Mg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function zg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mg(Object(r),!0).forEach((function(t){Fg(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Fg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ug(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ug(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ug(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Vg(e){var t=e.toggleShortcut,r=e.direction,i=e.sizeAttribute,s=e.children,o=Lg(Object(a.useState)(0),2),l=o[0],c=o[1],u=Object(a.useRef)(),d=Object(a.useRef)(!1),m=Object(a.useRef)(!1),p="horizontal"===r?"width":"height";i=i||p;var f=Object(a.useCallback)(()=>u.current?Math.floor(u.current.getBoundingClientRect()[p]):0,[p]),h=Object(a.useRef)(null),b=Object(a.useCallback)(()=>{if(u.current){var e,t=Ig.a.select(u.current);null===h.current?(e="0px",h.current="".concat(f(),"px")):(e=h.current,h.current=null),t.style(i,h.current||"0px").transition().duration(200).ease("swing").style(i,e),c(parseInt(e)||0)}},[f,i]),g=Object(a.useMemo)(()=>n.a.createElement("span",{className:"react-resizable-handle react-resizable-handle-".concat(r),role:"separator",onClick:()=>{!d.current&&m.current||b(),d.current=!1,m.current=!1}}),[r,b]);Object(a.useEffect)(()=>{if(t){var e={[t]:b};return Fc.bind(e),()=>{Fc.unbind(e)}}},[t,b]);var y=Object(a.useMemo)(()=>({onResizeStart:()=>{c(f())},onResize:(e,t)=>{Ig.a.select(u.current).style(i,"".concat(t.size[p],"px")),c(t.size[p]),m.current=!0},onResizeStop:()=>{m.current&&(h.current=null)}}),[p,f,i]),v=Object(a.useMemo)(()=>({onMouseDown:e=>{"touchstart"===e.type&&(d.current=!0),c(f())}}),[f]);return s?(s=n.a.createElement(s.type,zg(zg({},s.props),{},{ref:u})),n.a.createElement(Dg.Resizable,Rg({className:"resizable-component",axis:"horizontal"===r?"x":"y",resizeHandles:["horizontal"===r?"e":"s"],handle:g,width:"horizontal"===r?l:0,height:"vertical"===r?l:0,minConstraints:[0,0]},y,{draggableOpts:v}),s)):null}Vg.propTypes={direction:se.a.oneOf(["horizontal","vertical"]),sizeAttribute:se.a.string,toggleShortcut:se.a.string,children:se.a.element},Vg.defaultProps={direction:"horizontal",sizeAttribute:null,toggleShortcut:null,children:null};var Bg=r(708),Qg=r.n(Bg),Wg={sql:e=>Qg.a.format(Object(c.trim)(e)),json:e=>JSON.stringify(JSON.parse(e),null,4)};function Hg(e){return e in Wg}function Gg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=t||{view_only:!0},Object(a.useMemo)(()=>({isNew:Object(c.isNil)(e.id),isDraft:e.is_draft,isArchived:e.is_archived,canCreate:Y.hasPermission("create_query"),canView:Y.hasPermission("view_query"),canEdit:Y.hasPermission("edit_query")&&ae.canEdit(e),canViewSource:Y.hasPermission("view_source"),canExecute:!Object(c.isEmpty)(e.query)&&ae.canRun(e)&&(e.is_safe||Y.hasPermission("execute_query")&&!t.view_only),canFork:Y.hasPermission("edit_query")&&!t.view_only,canSchedule:Y.hasPermission("schedule_query")}),[e,t.view_only])}function Kg(e,t){var r=Dd(t);return Object(a.useCallback)(()=>{new Promise((e,t)=>{V.a.confirm({title:"Archive Query",content:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},"Are you sure you want to archive this query?"),n.a.createElement("div",null,"All alerts and dashboard widgets created with its visualizations will be deleted.")),okText:"Archive",okType:"danger",onOk:()=>{e()},onCancel:()=>{t()},maskClosable:!0,autoFocusButton:null})}).then(()=>function(e){return ir.delete({id:e.id}).then(()=>Object(c.extend)(e.clone(),{is_archived:!0,schedule:null})).catch(e=>(un.error("Query could not be archived."),Promise.reject(e)))}(e)).then(r)},[e,r])}function Yg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yg(Object(r),!0).forEach((function(t){Jg(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Xg extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error)){constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e),this.detailedMessage=t}}class Zg extends Xg{constructor(){super("Changes not saved",n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},"It seems like the query has been modified by another user."),n.a.createElement("div",null,"Please copy/backup your changes and reload this page.")))}}function ey(){return new Promise((e,t)=>{V.a.confirm({title:"Overwrite Query",content:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"m-b-5"},"It seems like the query has been modified by another user."),n.a.createElement("div",null,"Are you sure you want to overwrite the query with your version?")),okText:"Overwrite",okType:"danger",onOk:()=>{e()},onCancel:()=>{t()},maskClosable:!0,autoFocusButton:null})})}function ty(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.canOverwrite,a=void 0!==r&&r;return Object(c.isObject)(e.options)&&e.options.parameters&&(e.options=$g($g({},e.options),{},{parameters:Object(c.map)(e.options.parameters,e=>e.toSaveableObject())})),ir.save(e).catch(t=>409===Object(c.get)(t,"response.status")?a?ey().then(()=>ir.save(Object(c.omit)(e,["version"]))).catch(()=>Promise.reject(new Zg)):Promise.reject(new Zg):Promise.reject(new Xg("Query could not be saved")))}function ry(e,t){var r=Dd(t);return Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.successMessage,i=void 0===n?"Query saved":n;if(Object(c.isObject)(t)){if(e.isNew())return void r(Object(c.extend)(e.clone(),t));t=$g($g({},t),{},{id:e.id,version:e.version})}else t=Object(c.pick)(e,["id","version","schedule","query","description","name","data_source_id","options","latest_query_data_id","is_draft","tags"]);return ty(t,{canOverwrite:ae.canEdit(e)}).then(a=>{Object(c.isNil)(i)||un.success(i),r(Object(c.extend)(e.clone(),a.id!==e.id?a:Object(c.pick)(a,Object(c.uniq)(["id","version",...Object(c.keys)(t)]))))}).catch(e=>{var t={};e instanceof Zg&&(t.duration=null),un.error(e.message,e.detailedMessage,t)})}),[e,r])}function ay(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ny(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ny(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ny(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function iy(e){var t=ay(Object(a.useState)(!1),2),r=t[0],n=t[1],i=Object(a.useCallback)(()=>{var t="duplicatedQueryTab/".concat(Math.random().toString()),r=window.open("",t);n(!0),ir.fork({id:e.id}).then(e=>{r.location=function(e){var t=A.a.parse(window.location.search);e=Sf.a.parse(e);var r=A.a.parse(e.search);return Sf.a.format(Object(c.extend)(Object(c.pick)(e,["protocol","auth","host","pathname","hash"]),{search:A.a.stringify(Object(c.extend)(t,r))}))}(e.getUrl(!0))}).finally(()=>{n(!1)})},[e.id]);return[r,r?c.noop:i]}var sy=["copyable","children"];function oy(){return(oy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function ly(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cy(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class uy extends n.a.Component{constructor(e){super(e),cy(this,"state",{copied:null}),cy(this,"copy",()=>{window.getSelection().selectAllChildren(this.ref.current);try{if(!document.execCommand("copy"))throw new Error;this.setState({copied:"Copied!"})}catch(e){this.setState({copied:"Copy failed"})}window.getSelection().removeAllRanges(),this.resetCopyState=setTimeout(()=>this.setState({copied:null}),2e3)}),this.ref=n.a.createRef(),this.copyFeatureEnabled=e.copyable&&document.queryCommandSupported("copy"),this.resetCopyState=null}componentWillUnmount(){this.resetCopyState&&clearTimeout(this.resetCopyState)}render(){var e=this.props,t=(e.copyable,e.children),r=ly(e,sy),a=n.a.createElement(Ne,{title:this.state.copied||"Copy"},n.a.createElement(h.a,{icon:n.a.createElement(tf.a,null),type:"dashed",size:"small",onClick:this.copy}));return n.a.createElement("div",{className:"code-block"},n.a.createElement("code",oy({},r,{ref:this.ref}),t),this.copyFeatureEnabled&&a)}}cy(uy,"propTypes",{copyable:se.a.bool,children:se.a.node}),cy(uy,"defaultProps",{copyable:!1,children:null});var dy=["dialog"];function my(){return(my=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function py(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function hy(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function by(e){var t=e.dialog,r=hy(e,dy),i=py(Object(a.useState)(r.query),2),s=i[0],o=i[1],l=py(Object(a.useState)(!1),2),u=l[0],d=l[1],m=Object(a.useCallback)(()=>{d(!0),K.post("api/queries/".concat(s.id,"/regenerate_api_key")).then(e=>{d(!1),o(Object(c.extend)(s.clone(),{api_key:e.api_key}))}).catch(()=>{d(!1),un.error("Failed to update API key")})},[s]),p=Object(a.useMemo)(()=>({csvUrl:"".concat($.basePath,"api/queries/").concat(s.id,"/results.csv?api_key=").concat(s.api_key),jsonUrl:"".concat($.basePath,"api/queries/").concat(s.id,"/results.json?api_key=").concat(s.api_key)}),[s.id,s.api_key]),f=p.csvUrl,b=p.jsonUrl,g=qe("csv-results-label"),y=qe("json-results-label");return n.a.createElement(V.a,my({},t.props,{width:600,footer:n.a.createElement(h.a,{onClick:()=>t.close(s)},"Close")}),n.a.createElement("div",{className:"query-api-key-dialog-wrapper"},n.a.createElement("h5",null,"API Key"),n.a.createElement("div",{className:"m-b-20"},n.a.createElement(He.a.Group,{compact:!0},n.a.createElement(He.a,{readOnly:!0,value:s.api_key,"aria-label":"Query API Key"}),ae.canEdit(s)&&n.a.createElement(h.a,{disabled:u,loading:u,onClick:m},"Regenerate"))),n.a.createElement("h5",null,"Example API Calls:"),n.a.createElement("div",{className:"m-b-10"},n.a.createElement("span",{id:g},"Results in CSV format:"),n.a.createElement(uy,{"aria-labelledby":g,copyable:!0},f)),n.a.createElement("div",null,n.a.createElement("span",{id:y},"Results in JSON format:"),n.a.createElement(uy,{"aria-labelledby":y,copyable:!0},b))))}by.propTypes={dialog:Je.isRequired,query:se.a.shape({id:se.a.number.isRequired,api_key:se.a.string,can_edit:se.a.bool}).isRequired};var gy=Xe(by);function yy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Oy(){return Gl("api/queries/tags").then(e=>Object(c.map)(e,e=>e.name))}function Ey(e){var t=e.query,r=e.dataSource,i=e.sourceMode,s=e.selectedVisualization,o=e.headerExtra,l=e.tagsExtra,u=e.onChange,d=qg()({minWidth:768}),m=Gg(t,r),p=function(e,t){var r=ry(e,t);return Object(a.useCallback)(t=>{vt("edit_name","query",e.id);var a={name:t},n={};e.is_draft&&$.autoPublishNamedQueries&&"New Query"!==t&&(a.is_draft=!1,n.successMessage="Query saved and published"),r(a,n)},[e.id,e.is_draft,r])}(t,u),f=function(e,t){var r=ry(e,t);return Object(a.useCallback)(t=>{vt("edit_tags","query",e.id),r({tags:t})},[e.id,r])}(t,u),b=Kg(t,u),g=function(e,t){var r=ry(e,t);return Object(a.useCallback)(()=>{vt("toggle_published","query",e.id),r({is_draft:!1})},[e.id,r])}(t,u),y=function(e,t){var r=ry(e,t);return Object(a.useCallback)(()=>{vt("toggle_published","query",e.id),r({is_draft:!0})},[e.id,r])}(t,u),v=yy(iy(t),2),O=v[0],E=v[1],j=function(e,t){var r=Dd(t);return Object(a.useCallback)(()=>{gy.showModal({query:e}).onClose(r)},[e,r])}(t,u),w=function(e){return Object(a.useCallback)(()=>{Zp.showModal({aclUrl:"api/queries/".concat(e.id,"/acl"),context:"query",author:e.user})},[e.id,e.user])}(t),P=Object(a.useMemo)(()=>{return e=[{fork:{isEnabled:!m.isNew&&m.canFork&&!O,title:n.a.createElement(n.a.Fragment,null,"Fork ",n.a.createElement("i",{className:"fa fa-external-link m-l-5","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"(opens in a new tab)")),onClick:E}},{archive:{isAvailable:!m.isNew&&m.canEdit&&!m.isArchived,title:"Archive",onClick:b},managePermissions:{isAvailable:!m.isNew&&m.canEdit&&!m.isArchived&&$.showPermissionsControl,title:"Manage Permissions",onClick:w},publish:{isAvailable:!d&&m.isDraft&&!m.isArchived&&!m.isNew&&m.canEdit,title:"Publish",onClick:g},unpublish:{isAvailable:!$.disablePublish&&!m.isNew&&m.canEdit&&!m.isDraft,title:"Unpublish",onClick:y}},{showAPIKey:{isAvailable:!$.disablePublicUrls&&!m.isNew,title:"Show API Key",onClick:j}}],t={},r=Object(c.map)(e,e=>Object(c.filter)(Object(c.map)(e,(e,r)=>(e=Object(c.extend)({isAvailable:!0,isEnabled:!0,onClick:()=>{}},e)).isAvailable?(t[r]=e.onClick,n.a.createElement(he.a.Item,{key:r,disabled:!e.isEnabled},e.title)):null))),n.a.createElement(he.a,{onClick:e=>{var r=e.key;return t[r]()}},Object(c.reduce)(Object(c.filter)(r,e=>e.length>0),(e,t,r)=>{var a=e.length>0?n.a.createElement(he.a.Divider,{key:"divider".concat(r)}):null;return[...e,a,...t]},[]));var e,t,r},[m.isNew,m.canFork,m.canEdit,m.isArchived,m.isDraft,O,E,b,w,d,g,y,j]);return n.a.createElement("div",{className:"query-page-header"},n.a.createElement("div",{className:"title-with-tags"},n.a.createElement("div",{className:"page-title"},n.a.createElement("div",{className:"d-flex align-items-center"},!m.isNew&&n.a.createElement(Hn,{item:t}),n.a.createElement("h3",null,n.a.createElement(Mf,{isEditable:m.canEdit,onDone:p,ignoreBlanks:!0,value:t.name})))),n.a.createElement("div",{className:"query-tags"},n.a.createElement(cs,{tags:t.tags,isDraft:m.isDraft,isArchived:m.isArchived,canEdit:m.canEdit,getAvailableTags:Oy,onEdit:f,tagsExtra:l}))),n.a.createElement("div",{className:"header-actions"},o,d&&m.isDraft&&!m.isArchived&&!m.isNew&&m.canEdit&&n.a.createElement(h.a,{className:"m-r-5",onClick:g},n.a.createElement("i",{className:"fa fa-paper-plane m-r-5","aria-hidden":"true"})," Publish"),!m.isNew&&m.canViewSource&&n.a.createElement("span",null,!i&&n.a.createElement(S.Button,{className:"m-r-5",href:t.getUrl(!0,s)},n.a.createElement("i",{className:"fa fa-pencil-square-o","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5"},"Edit Source")),i&&n.a.createElement(S.Button,{className:"m-r-5",href:t.getUrl(!1,s),"data-test":"QueryPageShowResultOnly"},n.a.createElement("i",{className:"fa fa-table","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5"},"Show Results Only"))),!m.isNew&&n.a.createElement(Da.a,{overlay:P,trigger:["click"]},n.a.createElement(h.a,{"data-test":"QueryPageHeaderMoreButton","aria-label":"More actions"},n.a.createElement(Eo.a,{rotate:90,"aria-hidden":"true"})))))}function jy(e){var t=e.query,r=e.dataSource,a=e.layout,i=e.onEditSchedule;return n.a.createElement("div",{className:"query-metadata query-metadata-".concat(a)},n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("img",{className:"profile__image_thumb",src:t.user.profile_image_url,alt:"Avatar"}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("strong",{className:ge()("query-metadata-label",{"text-muted":t.user.is_disabled})},t.user.name),n.a.createElement("span",{className:"query-metadata-value"},"created"," ",n.a.createElement("strong",null,n.a.createElement(ii,{date:t.created_at}))))),n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("img",{className:"profile__image_thumb",src:t.last_modified_by.profile_image_url,alt:"Avatar"}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("strong",{className:ge()("query-metadata-label",{"text-muted":t.last_modified_by.is_disabled})},t.last_modified_by.name),n.a.createElement("span",{className:"query-metadata-value"},"updated"," ",n.a.createElement("strong",null,n.a.createElement(ii,{date:t.updated_at}))))),n.a.createElement("div",{className:"query-metadata-space"}),Object(c.has)(r,"name")&&Object(c.has)(r,"type")&&n.a.createElement("div",{className:"query-metadata-item"},"Data Source:",n.a.createElement("img",{src:"".concat("static/images/db-logos","/").concat(r.type,".png"),width:"20",alt:r.type}),n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("div",{className:"query-metadata-label"},r.name))),n.a.createElement("div",{className:"query-metadata-item"},n.a.createElement("div",{className:"query-metadata-property"},n.a.createElement("span",{className:"query-metadata-label"},n.a.createElement("span",{className:"zmdi zmdi-refresh m-r-5"}),"Refresh Schedule"),n.a.createElement("span",{className:"query-metadata-value"},n.a.createElement(fs,{isLink:Object(c.isFunction)(i),isNew:t.isNew(),schedule:t.schedule,onClick:i})))))}Ey.propTypes={query:se.a.shape({id:se.a.oneOfType([se.a.number,se.a.string]),name:se.a.string,tags:se.a.arrayOf(se.a.string)}).isRequired,dataSource:se.a.object,sourceMode:se.a.bool,selectedVisualization:se.a.number,headerExtra:se.a.node,tagsExtra:se.a.node,onChange:se.a.func},Ey.defaultProps={dataSource:null,sourceMode:!1,selectedVisualization:null,headerExtra:null,tagsExtra:null,onChange:()=>{}},jy.propTypes={layout:se.a.oneOf(["table","horizontal"]),query:se.a.shape({created_at:se.a.oneOfType([se.a.string,ri]).isRequired,updated_at:se.a.oneOfType([se.a.string,ri]).isRequired,user:se.a.shape({name:se.a.string.isRequired,profile_image_url:se.a.string.isRequired,is_disabled:se.a.bool}).isRequired,last_modified_by:se.a.shape({name:se.a.string.isRequired,profile_image_url:se.a.string.isRequired,is_disabled:se.a.bool}).isRequired,schedule:se.a.object}).isRequired,dataSource:se.a.shape({type:se.a.string,name:se.a.string}),onEditSchedule:se.a.func},jy.defaultProps={layout:"table",dataSource:null,onEditSchedule:null};var wy=["visualizationName","canDelete","onDelete"],Sy=["queryResult","selectedTab","showNewVisualizationButton","canDeleteVisualizations","onChangeTab","onAddVisualization","onDeleteVisualization","refreshButton","canRefresh"];function Py(){return(Py=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Cy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ny(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ny(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ny(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ky(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var _y=Tn.a.TabPane;function Ay(e){var t=e.title,r=e.message,a=e.refreshButton;return n.a.createElement("div",{className:"query-results-empty-state"},n.a.createElement("div",{className:"empty-state-content"},n.a.createElement("div",null,n.a.createElement("img",{src:"static/images/illustrations/no-query-results.svg",alt:"No Query Results Illustration"})),n.a.createElement("h3",null,t),n.a.createElement("div",{className:"m-b-20"},r),a))}function xy(e){var t=e.visualizationName,r=e.canDelete,i=e.onDelete,s=ky(e,wy),o=Object(a.useCallback)(e=>{e.stopPropagation(),V.a.confirm({title:"Delete Visualization",content:"Are you sure you want to delete this visualization?",okText:"Delete",okType:"danger",onOk:i,maskClosable:!0,autoFocusButton:null})},[i]);return n.a.createElement("span",s,t,r&&n.a.createElement(Ee,{className:"delete-visualization-button",onClick:o,"aria-label":"Close",title:"Close"},n.a.createElement("i",{className:"zmdi zmdi-close","aria-hidden":"true"})))}Ay.propTypes={title:se.a.string.isRequired,message:se.a.string.isRequired,refreshButton:se.a.node},Ay.defaultProps={refreshButton:null},xy.propTypes={visualizationName:se.a.string.isRequired,canDelete:se.a.bool,onDelete:se.a.func},xy.defaultProps={canDelete:!1,onDelete:()=>{}};var qy=[{type:"TABLE",name:"Table",id:null,options:{}}];function Ty(e){var t=e.queryResult,r=e.selectedTab,i=e.showNewVisualizationButton,s=e.canDeleteVisualizations,o=e.onChangeTab,l=e.onAddVisualization,u=e.onDeleteVisualization,d=e.refreshButton,m=e.canRefresh,p=ky(e,Sy),f=Object(a.useMemo)(()=>p.visualizations.length>0?p.visualizations:qy,[p.visualizations]),b={};Object(c.find)(f,{id:r})&&(b.activeKey="".concat(r)),i&&(b.tabBarExtraContent=n.a.createElement(h.a,{className:"add-visualization-button","data-test":"NewVisualization",type:"link",onClick:()=>l()},n.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}),n.a.createElement("span",{className:"m-l-5 hidden-xs"},"Add Visualization")));var g=Object(a.useMemo)(()=>Object(c.orderBy)(f,["id"]),[f]),y=Object(a.useCallback)(e=>e===g[0].id,[g]),v=qg()({maxWidth:768}),O=Cy(Object(a.useState)([]),2),E=O[0],j=O[1];return n.a.createElement(Tn.a,Py({},b,{type:"card",className:ge()("query-visualization-tabs card-style"),"data-test":"QueryPageVisualizationTabs",animated:!1,tabBarGutter:0,onChange:e=>o(+e),destroyInactiveTabPane:!0}),g.map(e=>n.a.createElement(_y,{key:"".concat(e.id),tab:n.a.createElement(xy,{"data-test":"QueryPageVisualizationTab".concat(e.id),canDelete:!v&&s&&!y(e.id),visualizationName:e.name,onDelete:()=>u(e.id)})},t?n.a.createElement($d,{visualization:e,queryResult:t,context:"query",filters:E,onFiltersChange:j}):n.a.createElement(Ay,{title:"Query has no result",message:m?"Execute/Refresh the query to show results.":"You do not have a permission to execute/refresh this query.",refreshButton:d}))))}function Iy(e){var t=e.status,r=e.updatedAt,a=e.error,i=e.isCancelling,s=e.onCancel,o="failed"===t?"error":"info",l="failed"!==t&&r,u=Object(c.includes)(["waiting","processing"],t),d=i?n.a.createElement(n.a.Fragment,null,"Cancelling…"):null;switch(t){case"waiting":i||(d=n.a.createElement(n.a.Fragment,null,"Query in queue…"));break;case"processing":i||(d=n.a.createElement(n.a.Fragment,null,"Executing query…"));break;case"loading-result":d=n.a.createElement(n.a.Fragment,null,"Loading results…");break;case"failed":d=n.a.createElement(n.a.Fragment,null,"Error running query: ",n.a.createElement("strong",null,a))}return n.a.createElement(p.a,{"data-test":"QueryExecutionStatus",type:o,message:n.a.createElement("div",{className:"d-flex align-items-center"},n.a.createElement("div",{className:"flex-fill p-t-5 p-b-5"},d," ",l&&n.a.createElement(vd,{from:r})),n.a.createElement("div",null,u&&n.a.createElement(h.a,{className:"m-l-10",type:"primary",size:"small",disabled:i,onClick:s},"Cancel")))})}function Dy(e){var t=e.query,r=e.dataSourcesAvailable,a=Gg(t),i=null;return a.isNew&&!a.canCreate?i=n.a.createElement(n.a.Fragment,null,n.a.createElement(rn.a.Title,{level:4},"You don't have permission to create new queries on any of the data sources available to you."),n.a.createElement("p",null,n.a.createElement(rn.a.Text,{type:"secondary"},"You can either ",n.a.createElement(S,{href:"queries"},"browse existing queries"),", or ask for additional permissions from your Redash admin."))):r||(i=Y.isAdmin?n.a.createElement(n.a.Fragment,null,n.a.createElement(rn.a.Title,{level:4},"Looks like no data sources were created yet or none of them available to the group(s) you're member of."),n.a.createElement("p",null,n.a.createElement(rn.a.Text,{type:"secondary"},"Please create one first, and then start querying.")),n.a.createElement("div",{className:"query-source-alerts-actions"},n.a.createElement(S.Button,{type:"primary",href:"data_sources/new"},"Create Data Source"),n.a.createElement(S.Button,{type:"default",href:"groups"},"Manage Group Permissions"))):n.a.createElement(n.a.Fragment,null,n.a.createElement(rn.a.Title,{level:4},"Looks like no data sources were created yet or none of them available to the group(s) you're member of."),n.a.createElement("p",null,n.a.createElement(rn.a.Text,{type:"secondary"},"Please ask your Redash admin to create one first.")))),i?n.a.createElement("div",{className:"query-source-alerts"},n.a.createElement(en.a,null,n.a.createElement(pe,{name:"QuerySource.Alerts",query:t,dataSourcesAvailable:r},n.a.createElement("div",{className:"query-source-alerts-icon"},n.a.createElement(_o.a,null)),i))):null}Ty.propTypes={queryResult:se.a.object,visualizations:se.a.arrayOf(se.a.object),selectedTab:se.a.number,showNewVisualizationButton:se.a.bool,canDeleteVisualizations:se.a.bool,onChangeTab:se.a.func,onAddVisualization:se.a.func,onDeleteVisualization:se.a.func,refreshButton:se.a.node,canRefresh:se.a.bool},Ty.defaultProps={queryResult:null,visualizations:[],selectedTab:null,showNewVisualizationButton:!1,canDeleteVisualizations:!1,onChangeTab:()=>{},onAddVisualization:()=>{},onDeleteVisualization:()=>{},refreshButton:null,canRefresh:!0},Iy.propTypes={status:se.a.string,updatedAt:se.a.any,error:se.a.string,isCancelling:se.a.bool,onCancel:se.a.func},Iy.defaultProps={status:"waiting",updatedAt:null,error:null,isCancelling:!0,onCancel:()=>{}},Dy.propTypes={query:se.a.object.isRequired,dataSourcesAvailable:se.a.bool},Dy.defaultProps={dataSourcesAvailable:!1};var Ry=["queryId","onError"];function My(){return(My=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function zy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Ly(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Uy(e){function t(t){var r=t.queryId,i=t.onError,s=Ly(t,Ry),o=zy(Object(a.useState)(null),2),l=o[0],c=o[1],u=Dd(i);return Object(a.useEffect)(()=>{var e=!1;return(r?ir.get({id:r}):Promise.resolve(ir.newQuery())).then(t=>{e||c(t)}).catch(u),()=>{e=!0}},[r,u]),l?n.a.createElement(e,My({query:l,onError:i},s)):n.a.createElement(Ys,{className:"flex-fill"})}return t.propTypes={queryId:se.a.oneOfType([se.a.number,se.a.string])},t.defaultProps={queryId:null},t}var Vy=r(712),By=r.n(Vy);function Qy(){return(Qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Wy(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Hy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hy(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hy(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Gy(e){var t=e.dialog,r=e.visualization,i=Wy(Object(a.useState)(""),2),s=i[0],o=i[1],l=Wy($o(e=>Object(c.isString)(e)&&""!==e?$r.query({q:e}).then(e=>e.results).catch(()=>[]):Promise.resolve([]),{initialResults:[]}),3),u=l[0],d=l[1],m=l[2],p=Wy(Object(a.useState)(null),2),f=p[0],h=p[1],b=Wy(Object(a.useState)(!1),2),g=b[0],y=b[1];Object(a.useEffect)(()=>{u(s)},[u,s]);var v=f?[f]:d;return n.a.createElement(V.a,Qy({},t.props,{title:"Add to Dashboard",okButtonProps:{disabled:!f||g,loading:g},cancelButtonProps:{disabled:g},onOk:function(){$r.get(f).then(e=>(e.addWidget(r),e)).then(e=>{t.close();var r="notification-".concat(Math.random().toString(36).substr(2,10));un.success("Widget added to dashboard",n.a.createElement(n.a.Fragment,null,n.a.createElement(S,{href:"".concat(e.url),onClick:()=>un.close(r)},e.name),n.a.createElement(cs,{isDraft:e.is_draft,tags:e.tags})),{key:r})}).catch(()=>{un.error("Widget not added.")}).finally(()=>{y(!1)})}}),n.a.createElement("label",{htmlFor:"add-to-dashboard-dialog-dashboard"},"Choose the dashboard to add this query to:"),!f&&n.a.createElement(He.a,{id:"add-to-dashboard-dialog-dashboard",className:"w-100",autoComplete:"off",autoFocus:!0,placeholder:"Search a dashboard by name",value:s,onChange:e=>o(e.target.value),suffix:n.a.createElement(Ee,{className:""===s?"hidden":null,onClick:()=>o("")},n.a.createElement(xe.a,null))}),(v.length>0||m)&&n.a.createElement(to.a,{className:f?"add-to-dashboard-dialog-selection":"add-to-dashboard-dialog-search-results",bordered:!0,itemLayout:"horizontal",loading:m,dataSource:v,renderItem:e=>n.a.createElement(to.a.Item,{key:"dashboard-".concat(e.id),actions:f?[n.a.createElement(Ee,{onClick:()=>h(null)},n.a.createElement(xe.a,null))]:[],onClick:f?null:()=>h(e)},n.a.createElement("div",{className:"add-to-dashboard-dialog-item-content"},e.name,n.a.createElement(cs,{isDraft:e.is_draft,tags:e.tags})))}))}Gy.propTypes={dialog:Je.isRequired,visualization:se.a.object.isRequired};var Ky=Xe(Gy);function Yy(){return(Yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function $y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Jy extends n.a.Component{constructor(e){super(e),$y(this,"state",{enableChangeIframeSize:!1,iframeWidth:720,iframeHeight:391}),$y(this,"urlEmbedLabelId",Object(c.uniqueId)("url-embed-label")),$y(this,"iframeEmbedLabelId",Object(c.uniqueId)("iframe-embed-label"));var t=e.query,r=e.visualization;this.embedUrl="".concat($.basePath,"embed/query/").concat(t.id,"/visualization/").concat(r.id,"?api_key=").concat(t.api_key,"&").concat(t.getParameters().toUrlParams()),window.snapshotUrlBuilder&&(this.snapshotUrl=window.snapshotUrlBuilder(t,r))}render(){var e=this.props,t=e.query,r=e.dialog,a=this.state,i=a.enableChangeIframeSize,s=a.iframeWidth,o=a.iframeHeight;return n.a.createElement(V.a,Yy({},r.props,{className:"embed-query-dialog",title:"Embed Query",footer:n.a.createElement(h.a,{onClick:r.dismiss},"Close")}),t.is_safe?n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",{id:this.urlEmbedLabelId,className:"m-t-0"},"Public URL"),n.a.createElement("div",{className:"m-b-30"},n.a.createElement(uy,{"aria-labelledby":this.urlEmbedLabelId,"data-test":"EmbedIframe",copyable:!0},this.embedUrl)),n.a.createElement("h5",{id:this.iframeEmbedLabelId,className:"m-t-0"},"IFrame Embed"),n.a.createElement("div",null,n.a.createElement(uy,{"aria-labelledby":this.iframeEmbedLabelId,copyable:!0},'<iframe src="'.concat(this.embedUrl,'" width="').concat(s,'" height="').concat(o,'"></iframe>')),n.a.createElement(Co.a,{className:"m-t-10",layout:"inline"},n.a.createElement(Co.a.Item,null,n.a.createElement(ic.a,{checked:i,onChange:e=>this.setState({enableChangeIframeSize:e.target.checked})})),n.a.createElement(Co.a.Item,{label:"Width"},n.a.createElement(Mo.a,{className:"size-input",value:s,onChange:e=>this.setState({iframeWidth:e}),size:"small",disabled:!i})),n.a.createElement(Co.a.Item,{label:"Height"},n.a.createElement(Mo.a,{className:"size-input",value:o,onChange:e=>this.setState({iframeHeight:e}),size:"small",disabled:!i})))),this.snapshotUrl&&n.a.createElement(n.a.Fragment,null,n.a.createElement("h5",null,"Image Embed"),n.a.createElement(uy,{copyable:!0},this.snapshotUrl))):n.a.createElement(p.a,{message:"Currently it is not possible to embed queries that contain text parameters.",type:"error","data-test":"EmbedErrorAlert"}))}}$y(Jy,"propTypes",{dialog:Je.isRequired,query:se.a.object.isRequired,visualization:se.a.object.isRequired});var Xy=Xe(Jy);var Zy=r(709),ev=r.n(Zy),tv=r(710),rv=r.n(tv),av=r(210),nv=r.n(av),iv=r(316),sv=r.n(iv);function ov(e){var t="",r=e.query,a=e.queryResult,i=e.fileType,s=a.getId&&a.getId(),o=a.getData&&a.getData();return s&&o&&r.name&&(t=r.id?"api/queries/".concat(r.id,"/results/").concat(s,".").concat(i).concat(e.embed?"?api_key=".concat(e.apiKey):""):"api/query_results/".concat(s,".").concat(i)),n.a.createElement(S,{target:"_blank",rel:"noopener noreferrer",disabled:e.disabled,href:t,download:!0},e.children)}function lv(e){var t=n.a.createElement(he.a,null,!e.query.isNew()&&(!e.query.is_draft||!e.query.is_archived)&&n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:()=>e.openAddToDashboardForm(e.selectedTab)},n.a.createElement(ev.a,null)," Add to Dashboard")),!$.disablePublicUrls&&!e.query.isNew()&&n.a.createElement(he.a.Item,null,n.a.createElement(Ee,{onClick:()=>e.showEmbedDialog(e.query,e.selectedTab),"data-test":"ShowEmbedDialogButton"},n.a.createElement(rv.a,null)," Embed Elsewhere")),n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"csv",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(nv.a,null)," Download as CSV File")),n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"tsv",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(nv.a,null)," Download as TSV File")),n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"xlsx",disabled:e.queryExecuting||!e.queryResult.getData||!e.queryResult.getData(),query:e.query,queryResult:e.queryResult,embed:e.embed,apiKey:e.apiKey},n.a.createElement(sv.a,null)," Download as Excel File")));return n.a.createElement(Da.a,{trigger:["click"],overlay:t,overlayClassName:"query-control-dropdown-overlay"},n.a.createElement(h.a,{"data-test":"QueryControlDropdownButton"},n.a.createElement(Eo.a,{rotate:90})))}ov.propTypes={query:se.a.object.isRequired,queryResult:se.a.object,fileType:se.a.string,disabled:se.a.bool.isRequired,embed:se.a.bool,apiKey:se.a.string,children:se.a.oneOfType([se.a.arrayOf(se.a.node),se.a.node]).isRequired},ov.defaultProps={queryResult:{},fileType:"csv",embed:!1,apiKey:""},lv.propTypes={query:se.a.object.isRequired,queryResult:se.a.object,queryExecuting:se.a.bool.isRequired,showEmbedDialog:se.a.func.isRequired,embed:se.a.bool,apiKey:se.a.string,selectedTab:se.a.oneOfType([se.a.string,se.a.number]),openAddToDashboardForm:se.a.func.isRequired},lv.defaultProps={queryResult:{},embed:!1,apiKey:"",selectedTab:""};var cv=r(711),uv=r.n(cv);function dv(e){return n.a.createElement(h.a,{"data-test":"EditVisualization",className:"edit-visualization",onClick:()=>e.openVisualizationEditor(e.selectedTab)},n.a.createElement(uv.a,null),n.a.createElement("span",{className:"hidden-xs hidden-s hidden-m"},"Edit Visualization"))}function mv(e){var t=e.query,r=e.queryResult,i=e.isQueryExecuting,s=e.selectedVisualization,o=e.showEditVisualizationButton,l=e.onEditVisualization,u=e.extraActions,d=Id(r),m=function(e){return Object(a.useCallback)(t=>{var r=Object(c.find)(e.visualizations,{id:t});Ky.showModal({visualization:r})},[e.visualizations])}(t),p=function(e){return Object(a.useCallback)((t,r)=>{var a=Object(c.find)(e.visualizations,{id:r});Xy.showModal({query:e,visualization:a})},[e])}(t);return n.a.createElement("div",{className:"query-execution-metadata"},n.a.createElement("span",{className:"m-r-5"},n.a.createElement(lv,{query:t,queryResult:r,queryExecuting:i,showEmbedDialog:p,embed:!1,apiKey:t.api_key,selectedTab:s,openAddToDashboardForm:m})),u,o&&n.a.createElement(dv,{openVisualizationEditor:l,selectedTab:s}),n.a.createElement("span",{className:"m-l-5 m-r-10"},n.a.createElement("span",null,!0===d.truncated&&n.a.createElement("span",{className:"m-r-5"},n.a.createElement(Ne,{title:"Result truncated to "+d.rows.length+" rows. Databricks may truncate query results that are unstably large."},n.a.createElement(By.a,{twoToneColor:"#FF9800"}))),n.a.createElement("strong",null,d.rows.length)," ",fi("row",d.rows.length)),n.a.createElement("span",{className:"m-l-5"},!i&&n.a.createElement(n.a.Fragment,null,n.a.createElement("strong",null,hi(d.runtime)),n.a.createElement("span",{className:"hidden-xs"}," runtime")),i&&n.a.createElement("span",null,"Running…")),d.metadata.data_scanned&&n.a.createElement("span",{className:"m-l-5"},"Data Scanned",n.a.createElement("strong",null,vi(d.metadata.data_scanned)))),n.a.createElement("div",null,n.a.createElement("span",{className:"m-r-10"},n.a.createElement("span",{className:"hidden-xs"},"Refreshed "),n.a.createElement("strong",null,n.a.createElement(ii,{date:d.retrievedAt,placeholder:"-"})))))}dv.propTypes={openVisualizationEditor:se.a.func.isRequired,selectedTab:se.a.oneOfType([se.a.string,se.a.number])},dv.defaultProps={selectedTab:""},mv.propTypes={query:se.a.object.isRequired,queryResult:se.a.object.isRequired,isQueryExecuting:se.a.bool,selectedVisualization:se.a.number,showEditVisualizationButton:se.a.bool,onEditVisualization:se.a.func,extraActions:se.a.node},mv.defaultProps={isQueryExecuting:!1,selectedVisualization:null,showEditVisualizationButton:!1,onEditVisualization:()=>{},extraActions:null};var pv=r(713),fv=r.n(pv),hv=r(714),bv=r.n(hv);function gv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yv(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yv(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e?Rb.fetchSchema(e,t).catch(()=>(un.error("Schema refresh failed.","Please try again later."),Promise.resolve([]))):Promise.resolve([])}var Ov=["item","expanded","onToggle","onSelect"],Ev=["dataSource","onSchemaUpdate","onItemSelect","options","onOptionsUpdate"];function jv(){return(jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function wv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Sv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wv(Object(r),!0).forEach((function(t){Pv(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Nv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nv(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nv(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function kv(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var _v=se.a.shape({name:se.a.string.isRequired,type:se.a.string}),Av=se.a.shape({name:se.a.string.isRequired,size:se.a.number,loading:se.a.bool,columns:se.a.arrayOf(_v).isRequired});function xv(e){var t=e.item,r=e.expanded,i=e.onToggle,s=e.onSelect,o=kv(e,Ov),l=Object(a.useCallback)((function(e){e.preventDefault(),e.stopPropagation();for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];s(...r)}),[s]);if(!t)return null;var u=t.displayName||t.name;return n.a.createElement("div",o,n.a.createElement("div",{className:"schema-list-item"},n.a.createElement(Ee,{className:"table-name",onClick:i},n.a.createElement("i",{className:"fa fa-table m-r-5","aria-hidden":"true"}),n.a.createElement("strong",null,n.a.createElement("span",{title:t.name},u),!Object(c.isNil)(t.size)&&n.a.createElement("span",null," (",t.size,")"))),n.a.createElement(Ne,{title:"Insert table name into query text",mouseEnterDelay:0,mouseLeaveDelay:0,placement:"topRight",arrowPointAtCenter:!0},n.a.createElement(Ee,{className:"copy-to-editor",onClick:e=>l(e,t.name)},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"})))),r&&n.a.createElement("div",{className:"table-open"},t.loading?n.a.createElement("div",{className:"table-open"},"Loading..."):Object(c.map)(t.columns,e=>{var t=Object(c.get)(e,"name"),r=Object(c.get)(e,"type");return n.a.createElement(Ne,{title:"Insert column name into query text",mouseEnterDelay:0,mouseLeaveDelay:0,placement:"rightTop"},n.a.createElement(Ee,{key:t,className:"table-open-item",onClick:e=>l(e,t)},n.a.createElement("div",null,t," ",r&&n.a.createElement("span",{className:"column-type"},r)),n.a.createElement("div",{className:"copy-to-editor"},n.a.createElement("i",{className:"fa fa-angle-double-right","aria-hidden":"true"}))))})))}function qv(){return n.a.createElement("div",{className:"schema-loading-state"},n.a.createElement(Ys,{className:""}))}function Tv(e){var t=e.loading,r=e.schema,i=e.expandedFlags,s=e.onTableExpand,o=e.onItemSelect,l=Cv(Object(a.useState)(null),2),c=l[0],u=l[1];return Object(a.useEffect)(()=>{c&&c.recomputeRowHeights()},[c,r,i]),n.a.createElement("div",{className:"schema-browser"},t&&n.a.createElement(qv,null),!t&&n.a.createElement(fv.a,null,e=>{var t=e.width,a=e.height;return n.a.createElement(bv.a,{ref:u,width:t,height:a,rowCount:r.length,rowHeight:e=>{var t=e.index,a=r[t],n=a.loading?1:a.columns.length;return 22+18*(i[a.name]?n:0)},rowRenderer:e=>{var t=e.key,a=e.index,l=e.style,c=r[a];return n.a.createElement(xv,{key:t,style:l,item:c,expanded:i[c.name],onToggle:()=>s(c.name),onSelect:o})}})}))}function Iv(e,t){var r=Object(c.filter)(t.toLowerCase().split(/\s+/),e=>e.length>0);if(0===r.length)return e;if(1===r.length){var a=r[0],n=r[0];return Object(c.filter)(e,e=>Object(c.includes)(e.name.toLowerCase(),a)||Object(c.some)(e.columns,e=>Object(c.includes)(Object(c.get)(e,"name").toLowerCase(),n)))}var i=r[0],s=r[1];return Object(c.filter)(Object(c.map)(e,e=>{if(Object(c.includes)(e.name.toLowerCase(),i))return(e=Sv(Sv({},e),{},{columns:Object(c.filter)(e.columns,e=>Object(c.includes)(Object(c.get)(e,"name").toLowerCase(),s))})).columns.length>0?e:null}))}function Dv(e){var t=e.dataSource,r=e.onSchemaUpdate,i=e.onItemSelect,s=(e.options,e.onOptionsUpdate,kv(e,Ev)),o=Cv(function(e){var t=gv(Object(a.useState)([]),2),r=t[0],n=t[1],i=gv(Object(a.useState)(!0),2),s=i[0],o=i[1],l=Object(a.useRef)(null),c=Object(a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;o(!0);var r=Math.random().toString(36).substr(2);l.current=r,vv(e,t).then(e=>{l.current===r&&n(e)}).finally(()=>{l.current===r&&o(!1)})}),[e]);return Object(a.useEffect)(()=>{c()},[c]),Object(a.useEffect)(()=>()=>{l.current=null},[]),Object(a.useMemo)(()=>[r,s,c],[r,s,c])}(t),3),l=o[0],c=o[1],u=o[2],d=Cv(Object(a.useState)(""),2),m=d[0],p=d[1],f=Object(a.useMemo)(()=>Iv(l,m),[l,m]),b=Cv(Object(Go.a)(p,500),1)[0],g=Cv(Object(a.useState)({}),2),y=g[0],v=g[1],O=Dd(r);if(Object(a.useEffect)(()=>{v({}),O(l)},[l,O]),0===l.length&&!c)return null;return n.a.createElement("div",jv({className:"schema-container"},s),n.a.createElement("div",{className:"schema-control"},n.a.createElement(He.a,{className:"m-r-5",placeholder:"Search schema...","aria-label":"Search schema",disabled:0===l.length,onChange:e=>b(e.target.value)}),n.a.createElement(Ne,{title:"Refresh Schema"},n.a.createElement(h.a,{onClick:()=>u(!0)},n.a.createElement("i",{className:ge()("zmdi zmdi-refresh",{"zmdi-hc-spin":c}),"aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},c?"Loading, please wait.":"Press to refresh.")))),n.a.createElement(Tv,{loading:c&&0===l.length,schema:f,expandedFlags:y,onTableExpand:function(e){v(Sv(Sv({},y),{},{[e]:!y[e]}))},onItemSelect:i}))}xv.propTypes={item:Av,expanded:se.a.bool,onToggle:se.a.func,onSelect:se.a.func},xv.defaultProps={item:null,expanded:!1,onToggle:()=>{},onSelect:()=>{}},Dv.propTypes={dataSource:se.a.object,onSchemaUpdate:se.a.func,onItemSelect:se.a.func},Dv.defaultProps={dataSource:null,onSchemaUpdate:()=>{},onItemSelect:()=>{}};var Rv=r(158),Mv=r.n(Rv),zv=(r(1667),r(1668),r(1669),r(1670),r(1671),r(1672),r(1673),Mv.a.acequire("ace/ext/language_tools")),Fv=Mv.a.acequire("ace/snippets");function Lv(e){Mv.a.define("ace/snippets/".concat(e),["require","exports","module"],(t,r)=>{r.snippetText="",r.scope=e})}function Uv(e){var t=[],r={},a={};return e.forEach(e=>{t.push({name:e.name,value:e.name,score:100,meta:"Table"}),a[e.name]=function(e){var t=[];return e.columns.forEach(r=>{var a=Object(c.get)(r,"name");t.push({name:"".concat(e.name,".").concat(a),value:"".concat(e.name,".").concat(a),score:100,meta:Object(c.capitalize)(Object(c.get)(r,"type","Column"))})}),t}(e),e.columns.forEach(e=>{var t=Object(c.get)(e,"name",e);r[t]=Object(c.capitalize)(Object(c.get)(e,"type","Column"))})}),{table:t,column:Object(c.map)(r,(e,t)=>({name:t,value:t,score:50,meta:e})),tableColumn:a}}Lv("python"),Lv("sql"),Lv("json"),Lv("yaml"),Mv.a.define("ace/mode/custom",[],()=>{});var Vv={};function Bv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Vv[e]=Object(c.isNil)(t)?null:Uv(t)}zv.setCompleters([zv.snippetCompleter,zv.keyWordCompleter,zv.textCompleter,{identifierRegexps:[/[a-zA-Z_0-9.\-\u00A2-\uFFFF]/],getCompletions:(e,t,r,a,n)=>{var i=Vv[e.id]||{table:[],column:[],tableColumn:[]},s=i.table,o=i.column,l=i.tableColumn;if(0!==a.length&&0!==s.length)if("."!==a[a.length-1])n(null,s.concat(o));else{var c=a.substring(0,a.length-1);n(null,s.concat(l[c]))}else n(null,[])}}]);class Qv{constructor(e){Object(c.extend)(this,e)}getSnippet(){var e=this.trigger;return""!==this.description&&(e="".concat(this.trigger,": ").concat(this.description)),{name:e,content:this.snippet,tabTrigger:this.trigger}}}var Wv=e=>new Qv(e),Hv={get:e=>K.get("api/query_snippets/".concat(e.id)).then(Wv),query:()=>K.get("api/query_snippets").then(e=>Object(c.map)(e,Wv)),create:e=>K.post("api/query_snippets",e).then(Wv),save:e=>K.post("api/query_snippets/".concat(e.id),e).then(Wv),delete:e=>K.delete("api/query_snippets/".concat(e.id))};function Gv(e){var t=e.available,r=e.enabled,i=e.onToggle,s="Live Autocomplete Enabled",o="icon-flash";r||(s="Live Autocomplete Disabled",o="icon-flash-off"),t||(s="Live Autocomplete Not Available (Use Ctrl+Space to Trigger)",o="icon-flash-off");var l=Object(a.useCallback)(()=>{vt("toggle_autocomplete","screen","query_editor",{state:!r}),i(!r)},[r,i]);return n.a.createElement(Ne,{placement:"top",title:s},n.a.createElement(h.a,{className:"query-editor-controls-button m-r-5",disabled:!t,onClick:l,"aria-label":r?"Disable live autocomplete":"Enable live autocomplete"},n.a.createElement("i",{className:"icon "+o,"aria-hidden":"true"})))}function Kv(e){var t=e.available,r=e.checked,i=e.onChange,s=Object(a.useCallback)(()=>{vt("checkbox_auto_limit","screen","query_editor",{state:!r}),i(!r)},[r,i]),o=null;return o=t?"Auto limit results to first 1000 rows.":"Auto limiting is not available for this Data Source type.",n.a.createElement(Ne,{placement:"top",title:o},n.a.createElement(ic.a,{className:"query-editor-controls-checkbox",disabled:!t,onClick:s,checked:t&&r},"LIMIT 1000"))}Gv.propTypes={available:se.a.bool.isRequired,enabled:se.a.bool.isRequired,onToggle:se.a.func.isRequired},Kv.propTypes={available:se.a.bool,checked:se.a.bool.isRequired,onChange:se.a.func.isRequired};var Yv=["title","shortcut"];function $v(){return($v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Jv(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xv(e){var t=e.title,r=e.shortcut,a=Jv(e,Yv);return r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r={mod:Object(c.upperFirst)(Dc),alt:Object(c.upperFirst)(Rc)};return e=Object(c.toLower)(Object(c.toString)(e)),e=Object(c.filter)(Object(c.map)(e.split(","),c.trim),e=>""!==e).slice(0,t),""!==(e=Object(c.map)(e,e=>(e=Object(c.filter)(Object(c.map)(e.split("+")),e=>""!==e),Object(c.map)(e,e=>r[e]||Object(c.upperFirst)(e)).join(" + "))).join(", "))?e:null}(r,1),t=t&&r?n.a.createElement(n.a.Fragment,null,t," (",n.a.createElement("i",null,r),")"):t||r,n.a.createElement(Ne,$v({placement:"top",title:t},a))}function Zv(e){var t=e.addParameterButtonProps,r=e.formatButtonProps,i=e.saveButtonProps,s=e.executeButtonProps,o=e.autocompleteToggleProps,l=e.autoLimitCheckboxProps,u=e.dataSourceSelectorProps;return Object(a.useEffect)(()=>{var e=Object(c.filter)([t,r,i,s],e=>e.shortcut&&Object(c.isFunction)(e.onClick));if(e.length>0){var a=Object(c.fromPairs)(Object(c.map)(e,e=>[e.shortcut,e.disabled?c.noop:e.onClick]));return Fc.bind(a),()=>{Fc.unbind(a)}}},[t,r,i,s]),n.a.createElement("div",{className:"query-editor-controls"},!1!==t&&n.a.createElement(Xv,{title:t.title,shortcut:t.shortcut},n.a.createElement(h.a,{className:"query-editor-controls-button m-r-5",disabled:t.disabled,onClick:t.onClick},"{{"," ","}}")),!1!==r&&n.a.createElement(Xv,{title:r.title,shortcut:r.shortcut},n.a.createElement(h.a,{className:"query-editor-controls-button m-r-5",disabled:r.disabled,onClick:r.onClick},n.a.createElement("span",{className:"zmdi zmdi-format-indent-increase"}),r.text)),!1!==o&&n.a.createElement(Gv,{available:o.available,enabled:o.enabled,onToggle:o.onToggle}),!1!==l&&n.a.createElement(Kv,l),!1===u&&n.a.createElement("span",{className:"query-editor-controls-spacer"}),!1!==u&&n.a.createElement(Xi.a,{className:"w-100 flex-fill datasource-small",disabled:u.disabled,value:u.value,onChange:u.onChange},Object(c.map)(u.options,e=>n.a.createElement(Xi.a.Option,{key:"option-".concat(e.value),value:e.value},e.label))),!1!==i&&n.a.createElement(Xv,{title:i.title,shortcut:i.shortcut},n.a.createElement(h.a,{className:"query-editor-controls-button m-l-5",disabled:i.disabled,loading:i.loading,onClick:i.onClick,"data-test":"SaveButton"},!i.loading&&n.a.createElement("span",{className:"fa fa-floppy-o"}),i.text)),!1!==s&&n.a.createElement(Xv,{title:s.title,shortcut:s.shortcut},n.a.createElement(h.a,{className:"query-editor-controls-button m-l-5",type:"primary",disabled:s.disabled,onClick:s.onClick,"data-test":"ExecuteButton"},n.a.createElement("span",{className:"zmdi zmdi-play"}),s.text)))}Xv.propTypes={title:se.a.node,shortcut:se.a.string},Xv.defaultProps={title:null,shortcut:null};var eO=se.a.oneOfType([se.a.bool,se.a.shape({title:se.a.node,disabled:se.a.bool,loading:se.a.bool,onClick:se.a.func,text:se.a.node,shortcut:se.a.string})]);Zv.propTypes={addParameterButtonProps:eO,formatButtonProps:eO,saveButtonProps:eO,executeButtonProps:eO,autocompleteToggleProps:se.a.oneOfType([se.a.bool,se.a.shape({available:se.a.bool,enabled:se.a.bool,onToggle:se.a.func})]),autoLimitCheckboxProps:se.a.oneOfType([se.a.bool,se.a.shape(Kv.propTypes)]),dataSourceSelectorProps:se.a.oneOfType([se.a.bool,se.a.shape({disabled:se.a.bool,value:se.a.oneOfType([se.a.string,se.a.number]),options:se.a.arrayOf(se.a.shape({value:se.a.oneOfType([se.a.string,se.a.number]),label:se.a.node})),onChange:se.a.func})])},Zv.defaultProps={addParameterButtonProps:!1,formatButtonProps:!1,saveButtonProps:!1,executeButtonProps:!1,autocompleteToggleProps:!1,autoLimitCheckboxProps:!1,dataSourceSelectorProps:!1};var tO=["className","syntax","value","autocompleteEnabled","schema","onChange","onSelectionChange"];function rO(){return(rO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function aO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function iO(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var sO={$blockScrolling:1/0},oO=n.a.forwardRef((function(e,t){var r=e.className,i=e.syntax,s=e.value,o=e.autocompleteEnabled,l=e.schema,c=e.onChange,u=e.onSelectionChange,d=iO(e,tO),m=aO(Object(a.useState)(null),2),p=m[0],f=m[1],h=aO(Object(a.useState)(null),2),b=h[0],g=h[1],y=aO(Object(a.useState)(s),2),v=y[0],O=y[1];Object(a.useEffect)(()=>{O(s)},[s]);var E=Object(a.useCallback)(e=>{O(e),c(e)},[c]),j=Object(a.useMemo)(()=>({behavioursEnabled:!0,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:o,autoScrollEditorIntoView:!0}),[o]);Object(a.useEffect)(()=>{if(b){var e=b.editor.id;return Bv(e,l),()=>{Bv(e,null)}}},[l,b]),Object(a.useEffect)(()=>{function e(){b&&b.editor.resize()}if(p)return e(),jp(p,e)},[p,b]);var w=Object(a.useCallback)(e=>{var t=b.editor.session.doc.getTextRange(e.getRange()),r=t.length>1?t:null;u(r)},[b,u]),S=Object(a.useCallback)(e=>{e.commands.bindKey({win:"Ctrl+L",mac:"Cmd+L"},null),e.commands.bindKey({win:"Ctrl+Shift+F",mac:"Cmd+Shift+F"},null),e.commands.bindKey({win:"Ctrl+P",mac:null},null),e.commands.bindKey({win:null,mac:"Ctrl+P"},"golineup"),e.commands.bindKey({win:"Esc",mac:"Esc"},()=>{e.blur()});var t=null;e.on("focus",()=>{t=function(e){var t=e.text,r=e.expiry,a=void 0===r?1e3:r,n=e.container,i=void 0===n?document.body:n,s=e.politeness,o=void 0===s?"polite":s,l=document.createElement("div"),c="speak-".concat(Date.now());l.id=c,l.className="sr-only",l.textContent=t,l.setAttribute("role","alert"),l.setAttribute("aria-live",o),i.appendChild(l);var u=null,d=!1,m=()=>{if(!d){d=!0;try{i.removeChild(l)}catch(e){console.error(e)}u&&window.clearTimeout(u)}};return u=window.setTimeout(m,a),m}({text:"You've entered the SQL editor. To exit press the ESC key.",politeness:"assertive"})}),e.on("blur",()=>{t&&t()}),e.commands.on("afterExec",t=>{"insertstring"===t.command.name&&"."===t.args&&e.completer&&e.completer.showPopup(e)}),Hv.query().then(e=>{var t=Fv.snippetManager,r={snippetText:""};r.snippets=t.parseSnippetFile(r.snippetText),e.forEach(e=>{r.snippets.push(e.getSnippet())}),t.register(r.snippets||[],r.scope)}),e.focus()},[]);return Object(a.useImperativeHandle)(t,()=>({paste:e=>{if(b){var t=b.editor;t.session.doc.replace(t.selection.getRange(),e);var r=t.selection.getRange();c(t.session.getValue()),t.selection.setRange(r)}},focus:()=>{b&&b.editor.focus()}}),[b,c]),n.a.createElement("div",rO({className:ge()("query-editor-container",r)},d,{ref:f}),n.a.createElement(Ah.a,{ref:g,theme:"textmate",mode:i||"sql",value:v,editorProps:sO,width:"100%",height:"100%",setOptions:j,showPrintMargin:!1,wrapEnabled:!1,onLoad:S,onChange:E,onSelectionChange:w}))}));oO.propTypes={className:se.a.string,syntax:se.a.string,value:se.a.string,autocompleteEnabled:se.a.bool,schema:se.a.arrayOf(Av),onChange:se.a.func,onSelectionChange:se.a.func},oO.defaultProps={className:null,syntax:null,value:null,autocompleteEnabled:!0,schema:[],onChange:()=>{},onSelectionChange:()=>{}},oO.Controls=Zv;var lO=oO,cO=r(715),uO=r.n(cO);function dO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function mO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dO(Object(r),!0).forEach((function(t){pO(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fO(e){return Object(c.has)(e,"job.id")?Yt(e.job.id,1e3):e}function hO(e){return Object(c.has)(e,"error")?Promise.reject(new Error(e.error.message)):e}var bO=mO(mO({},Rb),{},{getDatabases:function(e){var t=e.id,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};return r&&(a.refresh=!0),K.get("api/databricks/databases/".concat(t),{params:a}).then(fO).then(hO)},getDatabaseTables:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={};return r&&(a.refresh=!0),K.get("api/databricks/databases/".concat(e.id,"/").concat(t,"/tables"),{params:a}).then(fO).then(hO)},getTableColumns:(e,t,r)=>K.get("api/databricks/databases/".concat(e.id,"/").concat(t,"/columns/").concat(r)).then(fO).then(hO)});function gO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function OO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vO(Object(r),!0).forEach((function(t){EO(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function EO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jO(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?bO.getDatabases(e,t).catch(()=>(un.error("Failed to load Database list.","Please try again later."),Promise.reject())):Promise.resolve([])}function wO(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e&&t?bO.getDatabaseTables(e,t,r).catch(()=>(un.error("Failed to load tables for ".concat(t,"."),"Please try again later."),Promise.reject())):Promise.resolve([])}function SO(e,t){return t?Object(c.map)(e,e=>{var r=t+".",a=e.name;return Object(c.startsWith)(e.name,r)&&(a=e.name.slice(r.length)),OO(OO({},e),{},{displayName:a})}):e}var PO=["dataSource","options","onOptionsUpdate","onSchemaUpdate","onItemSelect"];function CO(){return(CO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function NO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function kO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?NO(Object(r),!0).forEach((function(t){_O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _O(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return xO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function qO(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function TO(e){var t=e.dataSource,r=e.options,i=e.onOptionsUpdate,s=e.onSchemaUpdate,o=e.onItemSelect,l=qO(e,PO),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=Object(a.useState)([]),i=gO(n,2),s=i[0],o=i[1],l=Object(a.useState)(!0),u=gO(l,2),d=u[0],m=u[1],p=Object(a.useState)(),f=gO(p,2),h=f[0],b=f[1],g=Object(a.useState)({}),y=gO(g,2),v=y[0],O=y[1],E=Object(a.useState)(!1),j=gO(E,2),w=j[0],S=j[1],P=Object(a.useState)(!1),C=gO(P,2),N=C[0],k=C[1],_=Object(a.useCallback)(e=>O(t=>OO(OO({},t),{},{[h]:e})),[h]),A=Object(a.useRef)();A.current=h;var x=Object(a.useCallback)(t=>{bO.getTableColumns(e,h,t.substring(h.length+1)).then(e=>{A.current===h&&O(r=>{var a=Object(c.get)(r,h,[]),n=Object(c.map)(a,r=>r.name===t?OO(OO({},r),{},{columns:e,loading:!1}):r);return OO(OO({},r),{},{[h]:n})})})},[e,h]),q=Object(a.useMemo)(()=>SO(Object(c.get)(v,h,[]),h),[v,h]),T=Object(a.useCallback)(()=>{if(!N){k(!0);var t=jO(e,!0).then(o),r=wO(e,h,!0).then(e=>{var t=e.schema;return _(t)});Promise.all([r.catch(()=>{}),t.catch(()=>{})]).then(()=>k(!1))}},[e,h,_,N]),I=Object(a.useRef)();I.current=v,Object(a.useEffect)(()=>{var t=!1;return h&&!Object(c.has)(I.current,h)&&(S(!0),wO(e,h).catch(()=>Promise.resolve({schema:[],has_columns:!0})).then(r=>{var a=r.schema,n=r.has_columns;t||(n||Object(c.isEmpty)(a)||(a=Object(c.map)(a,e=>OO(OO({},e),{},{loading:!0})),wO(e,h,!0).then(e=>{var r=e.schema;t||_(r)})),_(a))}).finally(()=>{t||S(!1)})),()=>{t=!0}},[e,h,_]);var D=Object(a.useRef)();D.current=Object(c.get)(t,"selectedDatabase",null),Object(a.useEffect)(()=>{var t=!1;return m(!0),b(void 0),O({}),jO(e).catch(()=>Promise.resolve([])).then(r=>{if(!t){o(r);var a=D.current||localStorage.getItem("lastSelectedDatabricksDatabase_".concat(e.id));a||(a=Object(c.includes)(r,"default")?"default":Object(c.first)(r)||null),b(a)}}).finally(()=>{t||m(!1)}),()=>{t=!0}},[e]);var R=Object(a.useCallback)(a=>{if(a)try{localStorage.setItem("lastSelectedDatabricksDatabase_".concat(e.id),a)}catch(e){}b(a),Object(c.isFunction)(r)&&a!==D.current&&r(OO(OO({},t),{},{selectedDatabase:a}))},[e.id,t,r]);return{databases:s,loadingDatabases:d,schema:q,loadingSchema:w,currentDatabaseName:h,setCurrentDatabase:R,loadTableColumns:x,refreshAll:T,refreshing:N}}(t,r,i),d=u.databases,m=u.loadingDatabases,p=u.schema,f=u.loadingSchema,b=u.loadTableColumns,g=u.currentDatabaseName,y=u.setCurrentDatabase,v=u.refreshAll,O=u.refreshing,E=AO(Object(a.useState)(""),2),j=E[0],w=E[1],S=AO(Object(a.useState)(""),2),P=S[0],C=S[1],N=Object(a.useMemo)(()=>Iv(p,j),[p,j]),k=AO(Object(a.useState)(!1),2),_=k[0],A=k[1],x=AO(Object(a.useState)({}),2),q=x[0],T=x[1],I=AO(Object(Go.a)(w,500),1)[0],D=AO(Object(Go.a)(C,500),2),R=D[0],M=D[1],z=Object(a.useCallback)(e=>{y(e),M(),C("")},[M,y]),F=Object(a.useMemo)(()=>Object(c.filter)(d,e=>Object(c.includes)(e.toLowerCase(),P.toLowerCase())),[d,P]),L=Dd(s);return Object(a.useEffect)(()=>{L(p)},[p,L]),Object(a.useEffect)(()=>{T({})},[g]),n.a.createElement("div",CO({className:"databricks-schema-browser schema-container"},l),n.a.createElement("div",{className:"schema-control"},n.a.createElement(He.a,{className:_?"database-select-open":"",placeholder:"Filter tables & columns...","aria-label":"Search schema",disabled:m||f,onChange:e=>I(e.target.value),addonBefore:n.a.createElement(Xi.a,{dropdownClassName:"databricks-schema-browser-db-dropdown",loading:m,disabled:m,onChange:z,value:g,showSearch:!0,onSearch:R,onDropdownVisibleChange:A,placeholder:n.a.createElement(n.a.Fragment,null,n.a.createElement("i",{className:"fa fa-database m-r-5","aria-hidden":"true"})," Database")},F.map(e=>n.a.createElement(Xi.a.Option,{key:e},n.a.createElement("i",{className:"fa fa-database m-r-5","aria-hidden":"true"}),e)))})),n.a.createElement("div",{className:"schema-list-wrapper"},n.a.createElement(Tv,{loading:m||f,schema:N,expandedFlags:q,onTableExpand:function(e){var t=Object(c.find)(p,{name:e});!q[e]&&Object(c.get)(t,"loading",!1)&&b(e),T(kO(kO({},q),{},{[e]:!q[e]}))},onItemSelect:o}),!(f||m)&&n.a.createElement("div",{className:"load-button"},n.a.createElement(Ne,{title:O?null:"Refresh Databases and Current Schema"},n.a.createElement(h.a,{type:"link",onClick:v,disabled:O},n.a.createElement(uO.a,{spin:O}))))))}function IO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function DO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?IO(Object(r),!0).forEach((function(t){RO(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function RO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}TO.propTypes={dataSource:se.a.object,options:se.a.object,onOptionsUpdate:se.a.func,onSchemaUpdate:se.a.func,onItemSelect:se.a.func},TO.defaultProps={dataSource:null,options:null,onOptionsUpdate:()=>{},onSchemaUpdate:()=>{},onItemSelect:()=>{}};var MO=new Map,zO="SchemaBrowser",FO="QueryEditor";function LO(e,t,r){Object(c.isNil)(r)&&(r=[null]),Object(c.isArray)(r)||(r=[r]),Object(c.each)(r,r=>{MO.set(r,DO(DO({},MO.get(r)),{},{[e]:t}))})}function UO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function BO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return QO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function QO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function WO(e){var t=Object(a.useMemo)(()=>Object(c.first)(Object(c.orderBy)(e,["id"]))||{},[e]),r=BO(Object(a.useState)(+R.hash||t.id),2),n=r[0],i=r[1];return Object(a.useEffect)(()=>{var e=n!==t.id?"".concat(n):null;return R.hash!==e&&R.setHash(e),R.listen(()=>{R.hash!==e&&i(+R.hash||t.id)})},[t.id,n]),Object(a.useEffect)(()=>{Object(c.find)(e,{id:n})||i(t.id)},[t.id,n,e]),Object(a.useMemo)(()=>[n,i],[n])}function HO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return GO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function KO(e){var t=Object(a.useMemo)(()=>function(e){return Object(c.reduce)(e,(e,t)=>e+t.columns.length,0)}(e)<=5e3,[e]),r=HO(Object(a.useState)(Zt.get("liveAutocomplete",!0)),2),n=r[0],i=r[1],s=Object(a.useCallback)(e=>{i(e),Zt.set("liveAutocomplete",e)},[]);return Object(a.useMemo)(()=>[t,n,s],[t,n,s])}function YO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function $O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?YO(Object(r),!0).forEach((function(t){JO(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function JO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XO(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ZO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZO(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ZO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function eE(e,t,r){var n=function(e){return Object(c.get)(e,"supports_auto_limit",!1)}(e),i=XO(Object(a.useState)(t.options.apply_auto_limit),2),s=i[0],o=i[1];return t.options.apply_auto_limit=s,[n,s,Object(a.useCallback)(e=>{o(e),Zt.set("applyAutoLimit",e),r(Object(c.extend)(t.clone(),{options:$O($O({},t.options),{},{apply_auto_limit:e})}))},[t,r])]}LO(zO,Dv),LO(FO,lO),LO(zO,TO,["databricks","databricks_internal"]);var tE=k()("redash:notifications"),rE=window.Notification||null;rE||tE("HTML5 notifications are not supported.");var aE=Object(c.find)(["hidden","webkitHidden","mozHidden","msHidden"],e=>e in document);var nE={getPermissions:function(){rE&&"default"===rE.permission&&rE.requestPermission()},showNotification:function(e,t){rE&&document[aE]&&"granted"===rE.permission&&(new rE(e,{tag:e+t,body:t,icon:da.default}).onclick=function(){window.focus(),this.close(),vt("click","notification")})}};function iE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function oE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function lE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oE(Object(r),!0).forEach((function(t){cE(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oE(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function cE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var uE=(e,t)=>lE(lE({},e),t);function dE(e){var t=iE(Object(a.useReducer)(uE,{queryResult:null,isExecuting:!1,loadedInitialResults:!1,executionStatus:null,isCancelling:!1,cancelCallback:null,error:null}),2),r=t[0],n=t[1],i=Object(a.useRef)(null);Object(a.useEffect)(()=>()=>{i.current=null},[]);var s=Dd((function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1?arguments[1]:void 0;t=s?s():e.getQueryResult(a),vt("execute","query",e.id),nE.getPermissions(),i.current=t,n({updatedAt:t.getUpdatedAt(),executionStatus:t.getStatus(),isExecuting:!0,cancelCallback:()=>{vt("cancel_execute","query",e.id),n({isCancelling:!0}),t.cancelExecution()}});var o=e=>{i.current===t&&n({updatedAt:t.getUpdatedAt(),executionStatus:e})};t.toPromise(o).then(a=>{i.current===t&&(a&&a.query_result.query===e.query&&(e.latest_query_data_id=a.getId(),e.queryResult=a),r.loadedInitialResults&&nE.showNotification("Redash","".concat(e.name," updated.")),n({queryResult:a,loadedInitialResults:!0,error:null,isExecuting:!1,isCancelling:!1,executionStatus:null}))}).catch(a=>{i.current===t&&(r.loadedInitialResults&&nE.showNotification("Redash","".concat(e.name," failed to run: ").concat(a.getError())),n({queryResult:a,loadedInitialResults:!0,error:a.getError(),isExecuting:!1,isCancelling:!1,executionStatus:Qt}))})})),o=Object(a.useRef)(e);return o.current=e,Object(a.useEffect)(()=>{var e;o.current.hasResult()||o.current.paramsRequired()?s(void 0!==(e=R.search.maxAge)?e:-1):n({loadedInitialResults:!0})},[s]),lE(lE({},r),{executeQuery:s})}function mE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function fE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return hE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function bE(e){var t=Object(a.useMemo)(()=>e.getParametersDefs(),[e]),r=fE(Object(a.useState)(e.getParameters().hasPendingValues()),2),n=r[0],i=r[1],s=Object(a.useCallback)(t=>{t=Object(c.isUndefined)(t)?e.getParameters().hasPendingValues():t,i(t)},[e]);return Object(a.useEffect)(()=>{var t=e.getParameters().hasPendingValues();t!==n&&i(t)},[e,t,n]),Object(a.useMemo)(()=>[t,n,s],[t,n,s])}var gE=r(716),yE=r.n(gE);function vE(){return(vE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function OE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var wE=l.a.weekdaysShort(),SE=l.a.weekdays(),PE=Xi.a.Option,CE=Xi.a.OptGroup;function NE(e){var t=EE(Object(a.useState)(e.defaultValue),2),r=t[0],i=t[1],s=r&&!r.isUTC();return n.a.createElement(n.a.Fragment,null,n.a.createElement(yE.a,{allowClear:!1,value:r,format:"HH:mm",minuteStep:5,onChange:function(t){i(t),e.onChange(t)}}),s&&n.a.createElement("span",{className:"utc","data-testid":"utc"},"(",l.a.utc(r).format("HH:mm")," UTC)"))}NE.propTypes={defaultValue:ri,onChange:se.a.func.isRequired},NE.defaultProps={defaultValue:null};class kE extends n.a.Component{constructor(){super(...arguments),OE(this,"state",this.getState()),OE(this,"setTime",e=>{this.newSchedule={time:l()(e).utc().format("HH:mm")}}),OE(this,"setInterval",e=>{var t=this.state.newSchedule,r=pi(e).interval;r===li.NEVER&&(t.until=null),-1!==[li.NEVER,li.MINUTES,li.HOURS].indexOf(r)&&(t.time=null),r!==li.WEEKS&&(t.day_of_week=null),r!==li.DAYS&&r!==li.WEEKS||this.state.minute&&this.state.hour||(t.time=l()().hour("00").minute("15").utc().format("HH:mm")),r!==li.WEEKS||this.state.dayOfWeek||(t.day_of_week=SE[0]),t.interval=e;var a=EE(t.time?mi(t.time).split(":"):[null,null],2),n=a[0],i=a[1];this.setState({interval:r,seconds:e,hour:n,minute:i,dayOfWeek:t.day_of_week?wE[SE.indexOf(t.day_of_week)]:null}),this.newSchedule=t}),OE(this,"setScheduleUntil",(e,t)=>{this.newSchedule={until:t}}),OE(this,"setWeekday",e=>{var t=e.target.value;this.setState({dayOfWeek:t}),this.newSchedule={day_of_week:t?SE[wE.indexOf(t)]:null}}),OE(this,"setUntilToggle",e=>{var t=e.target.value?l()().format("YYYY-MM-DD"):null;this.setScheduleUntil(null,t)})}getState(){var e=Object(c.clone)(this.props.schedule||kE.defaultProps.schedule),t=e.time,r=e.interval,a=e.day_of_week,n=pi(r).interval,i=EE(t?mi(t).split(":"):[null,null],2);return{hour:i[0],minute:i[1],seconds:r,interval:n,dayOfWeek:a?wE[SE.indexOf(a)]:null,newSchedule:e}}get intervals(){var e={[li.NEVER]:[]};return this.props.refreshOptions.forEach(t=>{var r=pi(t),a=r.count,n=r.interval;n in e||(e[n]=[]),e[n].push([a,t])}),Object.defineProperty(this,"intervals",{value:e}),e}set newSchedule(e){this.setState(t=>({newSchedule:vE(t.newSchedule,e)}))}save(){var e=this.state.newSchedule;(()=>{var t=Object(c.omitBy)(e,c.isNil),r=Object(c.omitBy)(this.props.schedule,c.isNil);return!Object(c.isEqual)(t,r)})()&&(e.interval?this.props.dialog.close(Object(c.clone)(e)):this.props.dialog.close(null)),this.props.dialog.dismiss()}render(){var e=this.props.dialog,t=this.state,r=t.interval,a=t.minute,i=t.hour,s=t.seconds,o=t.newSchedule.until;return n.a.createElement(V.a,vE({},e.props,{title:"Refresh Schedule",className:"schedule",onOk:()=>this.save()}),n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,"Refresh every"),n.a.createElement("div",{"data-testid":"interval"},n.a.createElement(Xi.a,{className:"input",value:s,onChange:this.setInterval,dropdownMatchSelectWidth:!1},n.a.createElement(PE,{value:null,key:"never"},"Never"),Object.keys(this.intervals).filter(e=>!Object(c.isEmpty)(this.intervals[e])).map(e=>n.a.createElement(CE,{label:Object(c.capitalize)(fi(e)),key:e},this.intervals[e].map(t=>{var r=EE(t,2),a=r[0],i=r[1];return n.a.createElement(PE,{value:i,key:"".concat(e,"-").concat(a)},hi(i))})))))),-1!==[li.DAYS,li.WEEKS].indexOf(r)?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,"On time"),n.a.createElement("div",{"data-testid":"time"},n.a.createElement(NE,{defaultValue:i?l()().hour(i).minute(a):null,onChange:this.setTime}))):null,li.WEEKS===r?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,"On day"),n.a.createElement("div",{"data-testid":"weekday"},n.a.createElement(im.a.Group,{size:"medium",defaultValue:this.state.dayOfWeek,onChange:this.setWeekday},wE.map(e=>n.a.createElement(im.a.Button,{value:e,key:e,className:"input"},e[0]))))):null,r!==li.NEVER?n.a.createElement("div",{className:"schedule-component"},n.a.createElement("h5",null,"Ends"),n.a.createElement("div",{className:"ends","data-testid":"ends"},n.a.createElement(im.a.Group,{size:"medium",value:!!o,onChange:this.setUntilToggle},n.a.createElement(im.a,{value:!1},"Never"),n.a.createElement(im.a,{value:!0},"On")),o?n.a.createElement(Kc.a,{size:"small",className:"datepicker",value:l()(o),allowClear:!1,format:"YYYY-MM-DD",onChange:this.setScheduleUntil}):null)):null)}}OE(kE,"propTypes",{schedule:Kn,refreshOptions:se.a.arrayOf(se.a.number).isRequired,dialog:Je.isRequired}),OE(kE,"defaultProps",{schedule:Yn});var _E=Xe(kE);function AE(e,t){var r=Gg(e),n=ry(e,t);return Object(a.useCallback)(()=>{if(r.canEdit&&r.canSchedule){var t=$.queryRefreshIntervals,a=ae.getQueryRefreshIntervals(),i=Object(c.isArray)(a)?Object(c.intersection)(t,a):t;_E.showModal({schedule:e.schedule,refreshOptions:i}).onClose(t=>{vt("edit_schedule","query",e.id),n({schedule:t})})}},[e.id,e.schedule,r.canEdit,r.canSchedule,n])}var xE={save:e=>K.post((e=>e.id?"api/visualizations/".concat(e.id):"api/visualizations")(e),e),delete:e=>K.delete("api/visualizations/".concat(e.id))};function qE(){return(qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function TE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return IE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function DE(e){var t=e.dialog,r=e.visualization,i=e.query,s=e.queryResult,o=Object(a.useRef)(),l=!r,u=Id(s),m=TE(Object(a.useState)(u.filters),2),p=m[0],f=m[1],h=Object(a.useMemo)(()=>({columns:u.columns,rows:xd(u.rows,p)}),[u,p]),b=Object(a.useMemo)(()=>{var e=r?d.registeredVisualizations[r.type]:Object(d.getDefaultVisualization)(),t=e.getOptions(l?{}:r.options,u);return{type:e.type,name:l?e.name:r.name,options:t,originalOptions:t}},[u,l,r]),g=TE(Object(a.useState)(b.type),2),y=g[0],v=g[1],O=TE(Object(a.useState)(b.name),2),E=O[0],j=O[1],w=TE(Object(a.useState)(!1),2),S=w[0],P=w[1],C=TE(Object(a.useState)(b.options),2),N=C[0],k=C[1],_=TE(Object(a.useState)(!1),2),A=_[0],x=_[1];function q(e){var t=d.registeredVisualizations[y];k(t.getOptions(e,u))}Object(a.useEffect)(()=>{o.current&&o.current.reset()},[u,N]);var T=l?Object(c.filter)(Object(c.sortBy)(d.registeredVisualizations,["name"]),e=>!e.isDeprecated):Object(c.pick)(d.registeredVisualizations,[y]),I=qe("visualization-type"),D=qe("visualization-name");return n.a.createElement(V.a,qE({},t.props,{wrapClassName:"ant-modal-fullscreen",title:"Visualization Editor",okText:"Save",okButtonProps:{loading:A,disabled:A},onOk:function(){x(!0);var e=N;"TABLE"===y&&(e=Object(c.omit)(e,["paginationSize"])),function(e){return e.id?vt("update","visualization",e.id,{type:e.type}):vt("create","visualization",null,{type:e.type}),xE.save(e).then(e=>(un.success("Visualization saved"),e)).catch(e=>(un.error("Visualization could not be saved"),Promise.reject(e)))}(Object(c.extend)(Object(d.newVisualization)(y),r,{name:E,options:e,query_id:i.id})).then(e=>{!function(e,t){var r=Object(c.findIndex)(e.visualizations,e=>e.id===t.id);r>-1?e.visualizations[r]=t:e.visualizations.push(t),e.visualizations=[...e.visualizations]}(i,e),t.close(e)})},onCancel:function(){var e,r=!Object(c.isEqual)(N,b.originalOptions);(e=S||r,new Promise((t,r)=>{e?V.a.confirm({title:"Visualization Editor",content:"Are you sure you want to close the editor without saving?",okText:"Yes",cancelText:"No",onOk:()=>t(),onCancel:()=>r()}):t()})).then(t.dismiss)},wrapProps:{"data-test":"EditVisualizationDialog"}}),n.a.createElement("div",{className:"edit-visualization-dialog"},n.a.createElement("div",{className:"visualization-settings"},n.a.createElement("div",{className:"m-b-15"},n.a.createElement("label",{htmlFor:I},"Visualization Type"),n.a.createElement(Xi.a,{"data-test":"VisualizationType",id:I,className:"w-100",disabled:!l,value:y,onChange:function(e){v(e);var t=d.registeredVisualizations[e];S||j(t.name),k(t.getOptions(l?{}:r.options,u))}},Object(c.map)(T,e=>n.a.createElement(Xi.a.Option,{key:e.type,"data-test":"VisualizationType."+e.type},e.name)))),n.a.createElement("div",{className:"m-b-15"},n.a.createElement("label",{htmlFor:D},"Visualization Name"),n.a.createElement(He.a,{"data-test":"VisualizationName",id:D,className:"w-100",value:E,onChange:e=>{return t=e.target.value,j(t),void P(t!==E);var t}})),n.a.createElement("div",{"data-test":"VisualizationEditor"},n.a.createElement(Bd,{type:y,data:u,options:N,visualizationName:E,onOptionsChange:q}))),n.a.createElement("div",{className:"visualization-preview"},n.a.createElement("label",{htmlFor:"visualization-preview",className:"invisible hidden-xs"},"Preview"),n.a.createElement(Td,{filters:p,onChange:f}),n.a.createElement("div",{className:"scrollbox","data-test":"VisualizationPreview"},n.a.createElement(Vd,{type:y,data:h,options:N,visualizationName:E,onOptionsChange:q})))))}DE.propTypes={dialog:Je.isRequired,query:se.a.object.isRequired,visualization:d.VisualizationType,queryResult:se.a.object.isRequired},DE.defaultProps={visualization:null};var RE=Xe(DE);function ME(e,t,r){var n=Dd(r);return Object(a.useCallback)((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=Object(c.find)(e.visualizations,{id:r})||null;RE.showModal({query:e,visualization:a,queryResult:t}).onClose(t=>{var r=Object(c.filter)(e.visualizations,e=>e.id!==t.id);n(Object(c.extend)(e.clone(),{visualizations:[...r,t]}),t)})}),[e,t,n])}function zE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return FE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function LE(e,t){var r=Dd(t);return Object(a.useCallback)(t=>xE.delete({id:t}).then(()=>{var a=Object(c.filter)(e.visualizations,e=>e.id!==t);r(Object(c.extend)(e.clone(),{visualizations:a}))}).catch(()=>{un.error("Error deleting visualization.","Maybe it's used in a dashboard?")}),[e,r])}function UE(e,t){var r=ry(e,t);return Object(a.useCallback)(t=>{vt("edit_description","query",e.id),r({description:t})},[e.id,r])}function VE(e){return n.a.createElement("img",{src:"static/images/db-logos/".concat(e.type,".png"),width:"20",alt:e.alt})}function BE(e){var t=e.dataSource,r=e.children;return n.a.createElement(n.a.Fragment,null,n.a.createElement(VE,{type:t.type,"aria-label":t.name,title:t.name}),r||n.a.createElement("span",null,t.name))}function QE(e){return n.a.createElement(Xi.a,{className:"w-100","data-test":"SelectDataSource",placeholder:"Choose data source...",value:e.value,disabled:e.disabled,loading:e.loading,optionFilterProp:"data-name",showSearch:!0,onChange:e.onChange},Object(c.map)(e.dataSources,e=>n.a.createElement(Xi.a.Option,{key:"ds-".concat(e.id),value:e.id,"data-name":e.name,"data-test":"SelectDataSource".concat(e.id)},n.a.createElement(pe,{name:"QuerySourceDropdownItem",dataSource:e}))))}function WE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function HE(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?WE(Object(r),!0).forEach((function(t){GE(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WE(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function GE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return YE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YE(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function YE(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function $E(e){var t,r=function(e){var t=UO(Object(a.useState)(e),2),r=t[0],n=t[1],i=UO(Object(a.useState)(e.query),2),s=i[0],o=i[1],l=UO(Object(a.useState)(r.options.apply_auto_limit),2),u=l[0],d=l[1],m=ry(r,e=>{e.id!==r.id&&bt(e.getUrl(!0),!0),n(e),o(e.query),d(e.options.apply_auto_limit)});return Object(a.useMemo)(()=>({query:r,setQuery:n,isDirty:r.query!==s||!Object(c.isEmpty)(r.query)&&r.options.apply_auto_limit!==u,saveQuery:()=>m()}),[r,s,m,u])}(e.query),i=r.query,s=r.setQuery,o=r.isDirty,l=r.saveQuery,u=function(e){var t=mE(Object(a.useState)([]),2),r=t[0],n=t[1],i=mE(Object(a.useState)(!1),2),s=i[0],o=i[1],l=Object(a.useMemo)(()=>Object(c.filter)(r,t=>!t.view_only||t.id===e.data_source_id),[r,e.data_source_id]),u=Object(a.useMemo)(()=>Object(c.find)(l,t=>Object(c.toString)(t.id)===Object(c.toString)(e.data_source_id))||null,[e.data_source_id,l]);return Object(a.useEffect)(()=>{var e=!1;return Rb.query().then(t=>{e||(o(!0),n(t))}),()=>{e=!0}},[]),Object(a.useMemo)(()=>({dataSourcesLoaded:s,dataSources:l,dataSource:u}),[s,l,u])}(i),d=u.dataSourcesLoaded,m=u.dataSources,p=u.dataSource,f=KE(Object(a.useState)([]),2),b=f[0],g=f[1],y=Gg(i,p),v=KE(bE(i),3),O=v[0],E=v[1],j=v[2],w=KE(WO(i.visualizations),2),S=w[0],P=w[1],C=(t=p&&p.type,DO(DO({},MO.get(null)),MO.get(t))),N=C.QueryEditor,k=C.SchemaBrowser,_=!qg()({minWidth:768});!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useRef)();t.current=e,Object(a.useEffect)(()=>{var e="".concat("You will lose your changes if you leave","\n\nAre you sure you want to leave this page?"),r=window.onbeforeunload;window.onbeforeunload=function(){return t.current?"You will lose your changes if you leave":void 0};var a=R.confirmChange((r,a)=>{if(t.current&&r.path!==a.path)return e});return()=>{window.onbeforeunload=r,a()}},[])}(o);var A=dE(i),x=A.queryResult,q=A.isExecuting,T=A.executionStatus,I=A.executeQuery,D=A.error,M=A.cancelCallback,z=A.isCancelling,F=A.updatedAt,L=A.loadedInitialResults,U=Id(x),V=Object(a.useRef)(null),B=KE(KO(b),3),Q=B[0],W=B[1],H=B[2],G=KE(eE(p,i,s),3),K=G[0],Y=G[1],$=G[2],J=KE(Object(Go.a)(e=>{s(Object(c.extend)(i.clone(),{query:e}))},100),1)[0];Object(a.useEffect)(()=>{vt("view_source","query",i.id)},[i.id]),Object(a.useEffect)(()=>{document.title=i.name},[i.name]);var X=ry(i,s),Z=UE(i,s),ee=p?p.syntax||"sql":null,te=Hg(ee),re=Object(a.useCallback)(e=>{if(e)try{localStorage.setItem("lastSelectedDataSourceId",e)}catch(e){}if(i.data_source_id!==e){vt("update_data_source","query",i.id,{dataSourceId:e});var t={data_source_id:e,latest_query_data_id:null,latest_query_data:null};s(Object(c.extend)(i.clone(),t)),X(t,{successMessage:null})}},[i,s,X]);Object(a.useEffect)(()=>{if(d&&y.isNew){var e=m.length>0?m[0].id:null,t=parseInt(localStorage.getItem("lastSelectedDataSourceId"))||null;re((r=[i.data_source_id,t,e],a=m,a=Object(c.map)(a,e=>e.id),Object(c.find)(r,e=>Object(c.includes)(a,e))||null))}var r,a},[i.data_source_id,y.isNew,d,m,re]);var ae=AE(i,s),ne=function(e,t){var r=Dd(t);return Object(a.useCallback)(()=>{pd.showModal({parameter:{title:null,name:"",type:"text",value:null},existingParams:Object(c.map)(e.getParameters().get(),e=>e.name)}).onClose(t=>{var a=e.clone();t=a.getParameters().add(t),r(a,t)})},[e,r])}(i,(e,t)=>{V.current&&(V.current.paste(t.toQueryTextFragment()),V.current.focus()),s(e)}),ie=Object(a.useCallback)(e=>{V.current&&V.current.paste(e)},[]),se=KE(Object(a.useState)(null),2),oe=se[0],le=se[1],ce=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y.canExecute&&(e||!E&&!q)&&(o||!Object(c.isEmpty)(oe)?I(null,()=>i.getQueryResultByText(0,oe)):I())}),[i,y.canExecute,E,q,o,oe,I]),ue=KE(Object(a.useState)(!1),2),de=ue[0],me=ue[1],fe=Object(a.useCallback)(()=>{de||(me(!0),l().finally(()=>me(!1)))},[de,l]),he=function(e,t,r,n){var i=Gg(e),s=ME(e,t,n),o=zE(Object(a.useState)(!1),2),l=o[0],c=o[1];return Object(a.useEffect)(()=>{!i.isNew&&l&&(c(!1),s())},[i.isNew,l,s]),Object(a.useCallback)(()=>{i.isNew?(c(!0),r()):s()},[i.isNew,r,s])}(i,x,fe,(e,t)=>{s(e),P(t.id)}),be=ME(i,x,e=>s(e)),ye=LE(i,s);return n.a.createElement("div",{className:ge()("query-page-wrapper",{"query-fixed-layout":!_})},n.a.createElement(Dy,{query:i,dataSourcesAvailable:!d||m.length>0}),n.a.createElement("div",{className:"container w-100 p-b-10"},n.a.createElement(Ey,{query:i,dataSource:p,sourceMode:!0,selectedVisualization:S,headerExtra:n.a.createElement(pe,{name:"QuerySource.HeaderExtra",query:i}),onChange:s})),n.a.createElement("main",{className:"query-fullscreen"},n.a.createElement(Vg,{direction:"horizontal",sizeAttribute:"flex-basis",toggleShortcut:"Alt+Shift+D, Alt+D"},n.a.createElement("nav",null,d&&n.a.createElement("div",{className:"editor__left__data-source"},n.a.createElement(pe,{name:"QuerySourceDropdown",dataSources:m,value:p?p.id:void 0,disabled:!y.canEdit||!d||0===m.length,loading:!d,onChange:re})),n.a.createElement("div",{className:"editor__left__schema"},n.a.createElement(k,{dataSource:p,options:i.options.schemaOptions,onOptionsUpdate:e=>s(Object(c.extend)(i.clone(),{options:HE(HE({},i.options),{},{schemaOptions:e})})),onSchemaUpdate:g,onItemSelect:ie})),!i.isNew()&&n.a.createElement("div",{className:"query-page-query-description"},n.a.createElement(Mf,{isEditable:y.canEdit,markdown:!0,ignoreBlanks:!1,placeholder:"Add description",value:i.description,onDone:Z,multiline:!0})),!i.isNew()&&n.a.createElement(jy,{layout:"table",query:i,onEditSchedule:ae}))),n.a.createElement("div",{className:"content"},n.a.createElement("div",{className:"flex-fill p-relative"},n.a.createElement("div",{className:"p-absolute d-flex flex-column p-l-15 p-r-15",style:{left:0,top:0,right:0,bottom:0,overflow:"auto"}},n.a.createElement(Vg,{direction:"vertical",sizeAttribute:"flex-basis"},n.a.createElement("div",{className:"row editor"},n.a.createElement("section",{className:"query-editor-wrapper","data-test":"QueryEditor"},n.a.createElement(N,{ref:V,"data-executing":q?"true":null,syntax:p?p.syntax:null,value:i.query,schema:b,autocompleteEnabled:Q&&W,onChange:J,onSelectionChange:le}),n.a.createElement(N.Controls,{addParameterButtonProps:{title:"Add New Parameter",shortcut:"mod+p",onClick:ne},formatButtonProps:{title:te?"Format Query":"Query formatting is not supported for your Data Source syntax",disabled:!p||!te,shortcut:te?"mod+shift+f":null,onClick:()=>{try{var e=(t=i.query,Hg(r=ee)?(0,Wg[r])(t):t);s(Object(c.extend)(i.clone(),{query:e}))}catch(e){un.error(String(e))}var t,r}},saveButtonProps:y.canEdit&&{text:n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"hidden-xs"},"Save"),o&&!de?"*":null),shortcut:"mod+s",onClick:fe,loading:de},executeButtonProps:{disabled:!y.canExecute||q||E,shortcut:"mod+enter, alt+enter, ctrl+enter, shift+enter",onClick:ce,text:n.a.createElement("span",{className:"hidden-xs"},null===oe?"Execute":"Execute Selected")},autocompleteToggleProps:{available:Q,enabled:W,onToggle:H},autoLimitCheckboxProps:{available:K,checked:Y,onChange:$},dataSourceSelectorProps:!!p&&{disabled:!y.canEdit,value:p.id,onChange:re,options:Object(c.map)(m,e=>({value:e.id,label:e.name}))}})))),!y.isNew&&n.a.createElement(jy,{layout:"horizontal",query:i,onEditSchedule:ae}),n.a.createElement("section",{className:"query-results-wrapper"},i.hasParameters()&&n.a.createElement("div",{className:"query-parameters-wrapper"},n.a.createElement(bd,{editable:y.canEdit,sortable:y.canEdit,disableUrlUpdate:y.isNew,parameters:O,onPendingValuesChange:()=>j(),onValuesChange:()=>{j(!1),ce(!0)},onParametersEdit:()=>{o||l()}})),(D||q)&&n.a.createElement("div",{className:"query-alerts"},n.a.createElement(Iy,{status:T,updatedAt:F,error:D,isCancelling:z,onCancel:M})),n.a.createElement(n.a.Fragment,null,U.log.length>0&&n.a.createElement("div",{className:"query-results-log"},n.a.createElement("p",null,"Log Information:"),Object(c.map)(U.log,(e,t)=>n.a.createElement("p",{key:"log-line-".concat(t),className:"query-log-line"},e))),L&&!(y.isNew&&!x)&&n.a.createElement(Ty,{queryResult:x,visualizations:i.visualizations,showNewVisualizationButton:y.canEdit&&U.status===Bt,canDeleteVisualizations:y.canEdit,selectedTab:S,onChangeTab:P,onAddVisualization:he,onDeleteVisualization:ye,refreshButton:n.a.createElement(h.a,{type:"primary",disabled:!y.canExecute||E,loading:q,onClick:ce},!q&&n.a.createElement("i",{className:"zmdi zmdi-refresh m-r-5","aria-hidden":"true"}),"Refresh Now")}))))),x&&!x.getError()&&n.a.createElement("div",{className:"bottom-controller-container"},n.a.createElement(mv,{query:i,queryResult:x,selectedVisualization:S,isQueryExecuting:q,showEditVisualizationButton:!y.isNew&&y.canEdit,onEditVisualization:be})))))}VE.propTypes={type:se.a.string,alt:se.a.string},BE.propTypes={dataSource:se.a.shape({name:se.a.string,id:se.a.oneOfType([se.a.string,se.a.number]),type:se.a.string}).isRequired,children:se.a.element},me("QuerySourceDropdownItem",BE),QE.propTypes={dataSources:se.a.any,value:se.a.oneOfType([se.a.string,se.a.number]),disabled:se.a.bool,loading:se.a.bool,onChange:se.a.func},me("QuerySourceDropdown",QE),$E.propTypes={query:se.a.object.isRequired};var JE=Uy($E);jn.register("Queries.New",Ga({path:"/queries/new",render:e=>n.a.createElement(JE,e),bodyClass:"fixed-layout"})),jn.register("Queries.Edit",Ga({path:"/queries/:queryId/source",render:e=>n.a.createElement(JE,e),bodyClass:"fixed-layout"}));var XE=r(718),ZE=r.n(XE),ej=r(717),tj=r.n(ej),rj=["title","shortcut","disabled","children","onClick"];function aj(){return(aj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function nj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ij(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ij(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ij(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function sj(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oj(e){var t=e.title,r=e.shortcut,i=e.disabled,s=e.children,o=e.onClick,l=sj(e,rj),c=nj(Object(a.useState)(!1),2),u=c[0],d=c[1],m=Object(a.useMemo)(()=>({onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)}),[]);return Object(a.useEffect)(()=>{i&&d(!1)},[i]),Object(a.useEffect)(()=>{if(r){var e={[r]:o};return Fc.bind(e),()=>{Fc.unbind(e)}}},[r,o]),n.a.createElement(Xv,{title:t,shortcut:r,visible:u},n.a.createElement("span",m,n.a.createElement(h.a,aj({"data-test":"ExecuteButton",disabled:i,onClick:o,style:i?{pointerEvents:"none"}:{}},l),s)))}function lj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return cj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cj(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function uj(e){var t=lj(Object(a.useState)(e.query),2),r=t[0],i=t[1],s=lj(Object(a.useState)(),2),o=s[0],l=s[1],c=Gg(r,o),u=lj(bE(r),3),d=u[0],m=u[1],p=u[2],f=lj(WO(r.visualizations),2),b=f[0],g=f[1],y=qg()({minWidth:768}),v=qg()({minHeight:500})&&y,O=lj(mf(),2),E=O[0],j=O[1],w=lj(Object(a.useState)(!1),2),S=w[0],P=w[1],C=dE(r),N=C.queryResult,k=C.loadedInitialResults,_=C.isExecuting,A=C.executionStatus,x=C.executeQuery,q=C.error,T=C.cancelCallback,I=C.isCancelling,D=C.updatedAt,R=Id(N),M=UE(r,i),z=AE(r,i),F=ME(r,N,(e,t)=>{i(e),g(t.id)}),L=ME(r,N,e=>i(e)),U=LE(r,i),V=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c.canExecute&&(e||!m&&!_)&&x()}),[m,x,_,c.canExecute]);return Object(a.useEffect)(()=>{document.title=r.name},[r.name]),Object(a.useEffect)(()=>{Rb.get({id:r.data_source_id}).then(l)},[r.data_source_id]),n.a.createElement("div",{className:ge()("query-page-wrapper",{"query-view-fullscreen":E,"query-fixed-layout":v})},n.a.createElement("div",{className:"container w-100"},n.a.createElement(Ey,{query:r,dataSource:o,onChange:i,selectedVisualization:b,headerExtra:n.a.createElement(pe,{name:"QueryView.HeaderExtra",query:r},ae.canRun(r)&&n.a.createElement(oj,{className:"m-r-5",type:"primary",shortcut:"mod+enter, alt+enter, ctrl+enter",disabled:!c.canExecute||_||m,onClick:V},"Refresh")),tagsExtra:!r.description&&c.canEdit&&!S&&!E&&n.a.createElement(Ee,{className:"label label-tag hidden-xs",role:"none",onClick:()=>P(!0)},n.a.createElement("i",{className:"zmdi zmdi-plus m-r-5","aria-hidden":"true"}),"Add description")}),(r.description||S)&&n.a.createElement("div",{className:ge()("m-t-5",{hidden:E})},n.a.createElement(Mf,{className:"w-100",value:r.description,isEditable:c.canEdit,onDone:M,onStopEditing:()=>P(!1),placeholder:"Add description",ignoreBlanks:!1,editorProps:{autoSize:{minRows:2,maxRows:4}},defaultEditing:S,multiline:!0}))),n.a.createElement("div",{className:"query-view-content"},r.hasParameters()&&n.a.createElement("div",{className:ge()("bg-white tiled p-15 m-t-15 m-l-15 m-r-15",{hidden:E})},n.a.createElement(bd,{parameters:d,onValuesChange:()=>{p(!1),V(!0)},onPendingValuesChange:()=>p()})),n.a.createElement("div",{className:"query-results m-t-15"},k&&n.a.createElement(Ty,{queryResult:N,visualizations:r.visualizations,showNewVisualizationButton:c.canEdit&&R.status===Bt,canDeleteVisualizations:c.canEdit,selectedTab:b,onChangeTab:g,onAddVisualization:F,onDeleteVisualization:U,refreshButton:ae.canRun(r)&&n.a.createElement(h.a,{type:"primary",disabled:!c.canExecute||m,loading:_,onClick:V},!_&&n.a.createElement("i",{className:"zmdi zmdi-refresh m-r-5","aria-hidden":"true"}),"Refresh Now"),canRefresh:ae.canRun(r)}),n.a.createElement("div",{className:"query-results-footer"},N&&!N.getError()&&n.a.createElement(mv,{query:r,queryResult:N,selectedVisualization:b,isQueryExecuting:_,showEditVisualizationButton:c.canEdit,onEditVisualization:L,extraActions:n.a.createElement(oj,{className:"icon-button m-r-5 hidden-xs",title:"Toggle Fullscreen",type:"default",shortcut:"alt+f",onClick:j},E?n.a.createElement(tj.a,null):n.a.createElement(ZE.a,null))}),(q||_)&&n.a.createElement("div",{className:"query-execution-status"},n.a.createElement(Iy,{status:A,error:q,isCancelling:I,onCancel:T,updatedAt:D})))),n.a.createElement("div",{className:ge()("p-t-15 p-r-15 p-l-15",{hidden:E})},n.a.createElement(jy,{layout:"horizontal",query:r,dataSource:o,onEditSchedule:z}))))}oj.propTypes={className:se.a.string,shortcut:se.a.string,disabled:se.a.bool,children:se.a.node,onClick:se.a.func},oj.defaultProps={className:null,shortcut:null,disabled:!1,children:null,onClick:()=>{}},uj.propTypes={query:se.a.object.isRequired};var dj=Uy(uj);function mj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pj(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function fj(e){var t=e.queryName,r=e.queryDescription,a=e.visualization;return n.a.createElement("div",{className:"embed-heading p-b-10 p-r-15 p-l-15"},n.a.createElement("h3",null,n.a.createElement("img",{src:da.default,alt:"Redash Logo",style:{height:"24px",verticalAlign:"text-bottom"}}),n.a.createElement(Ed,{visualization:a})," ",t,r&&n.a.createElement("small",null,n.a.createElement(xc.a,{className:"markdown text-muted"},_c.markdown.toHTML(r||"")))))}function hj(e){var t=e.query,r=e.queryResults,a=e.updatedAt,i=e.refreshStartedAt,s=e.queryUrl,o=e.hideTimestamp,l=e.apiKey,c=n.a.createElement(he.a,null,n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"csv",query:t,queryResult:r,apiKey:l,disabled:!r||!r.getData||!r.getData(),embed:!0},n.a.createElement(nv.a,null)," Download as CSV File")),n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"tsv",query:t,queryResult:r,apiKey:l,disabled:!r||!r.getData||!r.getData(),embed:!0},n.a.createElement(nv.a,null)," Download as TSV File")),n.a.createElement(he.a.Item,null,n.a.createElement(ov,{fileType:"xlsx",query:t,queryResult:r,apiKey:l,disabled:!r||!r.getData||!r.getData(),embed:!0},n.a.createElement(sv.a,null)," Download as Excel File")));return n.a.createElement("div",{className:"tile__bottom-control"},!o&&n.a.createElement("span",null,n.a.createElement("span",{className:"small hidden-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",i?n.a.createElement(vd,{from:i}):n.a.createElement(ii,{date:a})),n.a.createElement("span",{className:"small visible-print"},n.a.createElement("i",{className:"zmdi zmdi-time-restore","aria-hidden":"true"})," ",ui(a))),s&&n.a.createElement("span",{className:"hidden-print"},n.a.createElement(Ne,{title:"Open in Redash"},n.a.createElement(S.Button,{className:"icon-button",href:s,target:"_blank"},n.a.createElement("i",{className:"fa fa-external-link","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Open in Redash"))),!t.hasParameters()&&n.a.createElement(Da.a,{overlay:c,disabled:!r,trigger:["click"],placement:"topLeft"},n.a.createElement(h.a,{loading:!r&&!!i,className:"m-l-5"},"Download Dataset",n.a.createElement("i",{className:"fa fa-caret-up m-l-5","aria-hidden":"true"})))))}function bj(e){var t=e.queryId,r=e.visualizationId,i=e.apiKey,s=e.onError,o=mj(Object(a.useState)(null),2),u=o[0],d=o[1],m=mj(Object(a.useState)(null),2),p=m[0],f=m[1],h=mj(Object(a.useState)(null),2),b=h[0],g=h[1],y=mj(Object(a.useState)(null),2),v=y[0],O=y[1],E=Dd(s);Object(a.useEffect)(()=>{var e=!1;return ir.get({id:t}).then(t=>{e||d(t)}).catch(E),()=>{e=!0}},[t,E]);var j=Object(a.useCallback)(()=>{u&&(f(null),g(l()()),u.getQueryResultPromise().then(e=>{O(e)}).catch(e=>{f(e.getError())}).finally(()=>g(null)))},[u]);if(Object(a.useEffect)(()=>{document.querySelector("body").classList.add("headless"),j()},[j]),!u)return null;var w=Object(c.has)(R.search,"hide_header"),S=Object(c.has)(R.search,"hide_parameters"),P=Object(c.has)(R.search,"hide_link"),C=Object(c.has)(R.search,"hide_timestamp"),N=Object(c.has)(R.search,"showDescription");r=parseInt(r,10);var k=Object(c.find)(u.visualizations,e=>e.id===r);return k?n.a.createElement("div",{className:"tile m-t-10 m-l-10 m-r-10 p-t-10 embed__vis","data-test":"VisualizationEmbed"},!w&&n.a.createElement(fj,{queryName:u.name,queryDescription:N?u.description:null,visualization:k}),n.a.createElement("div",{className:"col-md-12 query__vis"},!S&&u.hasParameters()&&n.a.createElement("div",{className:"p-t-15 p-b-10"},n.a.createElement(bd,{parameters:u.getParametersDefs(),onValuesChange:j})),p&&n.a.createElement("div",{className:"alert alert-danger","data-test":"ErrorMessage"},"Error: ".concat(p)),!p&&v&&n.a.createElement($d,{visualization:k,queryResult:v,context:"widget"}),!v&&b&&n.a.createElement("div",{className:"d-flex justify-content-center"},n.a.createElement("div",{className:"spinner"},n.a.createElement("i",{className:"zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Refreshing...")))),n.a.createElement(hj,{query:u,queryResults:v,updatedAt:v?v.getUpdatedAt():void 0,refreshStartedAt:b,queryUrl:P?null:u.getUrl(),hideTimestamp:C,apiKey:i})):(setTimeout(()=>{s(new Error("Visualization does not exist"))},10),null)}function gj(){return(gj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function yj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function vj(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yj(Object(r),!0).forEach((function(t){Oj(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yj(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Oj(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ej(e){var t=e.querySnippet,r=e.dialog,i=e.readOnly,s=Object(a.useCallback)((e,a,n)=>{var i=Object(c.get)(t,"id");Object(c.isNil)(e.description)&&(e.description=""),r.close(i?vj({id:i},e):e).then(()=>a("Saved.")).catch(()=>n("Failed saving snippet."))},[r,t]),o=!!Object(c.get)(t,"id"),l=[{name:"trigger",title:"Trigger",type:"text",required:!0,autoFocus:!o},{name:"description",title:"Description",type:"text"},{name:"snippet",title:"Snippet",type:"ace",required:!0}].map(e=>vj(vj({},e),{},{readOnly:i,initialValue:Object(c.get)(t,e.name,"")})),u=qe("querySnippetForm");return n.a.createElement(V.a,gj({},r.props,{title:o?t.trigger:"Create Query Snippet",footer:[n.a.createElement(h.a,gj({key:"cancel"},r.props.cancelButtonProps,{onClick:r.dismiss}),i?"Close":"Cancel"),!i&&n.a.createElement(h.a,gj({key:"submit"},r.props.okButtonProps,{disabled:i||r.props.okButtonProps.disabled,htmlType:"submit",type:"primary",form:u,"data-test":"SaveQuerySnippetButton"}),o?"Save":"Create")],wrapProps:{"data-test":"QuerySnippetDialog"}}),n.a.createElement(Eb,{id:u,fields:l,onSubmit:s,hideSubmitButton:!0,feedbackIcons:!0}))}jn.register("Queries.View",Ga({path:"/queries/:queryId",render:e=>n.a.createElement(dj,e)})),fj.propTypes={queryName:se.a.string.isRequired,queryDescription:se.a.string,visualization:d.VisualizationType.isRequired},fj.defaultProps={queryDescription:""},hj.propTypes={query:se.a.object.isRequired,queryResults:se.a.object,updatedAt:se.a.string,refreshStartedAt:ri,queryUrl:se.a.string,hideTimestamp:se.a.bool,apiKey:se.a.string},hj.defaultProps={queryResults:null,updatedAt:null,refreshStartedAt:null,queryUrl:null,hideTimestamp:!1,apiKey:null},bj.propTypes={queryId:se.a.string.isRequired,visualizationId:se.a.string,apiKey:se.a.string.isRequired,onError:se.a.func},bj.defaultProps={onError:()=>{}},jn.register("Visualizations.ViewShared",ch({path:"/embed/query/:queryId/visualization/:visualizationId",render:e=>n.a.createElement(bj,e),getApiKey:()=>R.search.api_key})),Ej.propTypes={dialog:Je.isRequired,querySnippet:se.a.object,readOnly:se.a.bool},Ej.defaultProps={querySnippet:null,readOnly:!1};var jj=Xe(Ej);function wj(){return(wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Sj(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pj=e=>Y.isAdmin||Y.id===Object(c.get)(e,"user.id");class Cj extends n.a.Component{constructor(){var e;super(...arguments),e=this,Sj(this,"listColumns",[Ci.custom.sortable((e,t)=>n.a.createElement(Ee,{type:"link",className:"table-main-title",onClick:()=>this.showSnippetDialog(t)},t.trigger),{title:"Trigger",field:"trigger",className:"text-nowrap"}),Ci.custom.sortable(e=>e,{title:"Description",field:"description",className:"text-nowrap"}),Ci.custom(e=>n.a.createElement("code",{className:"snippet-content"},e),{title:"Snippet",field:"snippet"}),Ci.avatar({field:"user",className:"p-l-0 p-r-0"},e=>"Created by ".concat(e)),Ci.date.sortable({title:"Created At",field:"created_at",className:"text-nowrap",width:"1%"}),Ci.custom((e,t)=>Pj(t)&&n.a.createElement(h.a,{type:"danger",className:"w-100",onClick:e=>this.deleteQuerySnippet(e,t)},"Delete"),{width:"1%"})]),Sj(this,"saveQuerySnippet",e=>(e.id?Hv.save:Hv.create)(e)),Sj(this,"deleteQuerySnippet",(e,t)=>{V.a.confirm({title:"Delete Query Snippet",content:"Are you sure you want to delete this query snippet?",okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>{Hv.delete(t).then(()=>{un.success("Query snippet deleted successfully."),this.props.controller.update()}).catch(()=>{un.error("Failed deleting query snippet.")})}})}),Sj(this,"showSnippetDialog",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=!t||Pj(t);bt("query_snippets/"+Object(c.get)(t,"id","new"),!0);var a=()=>bt("query_snippets",!0);jj.showModal({querySnippet:t,readOnly:!r}).onClose(t=>e.saveQuerySnippet(t).then(()=>{e.props.controller.update(),a()})).onDismiss(a)}))}componentDidMount(){var e=this.props.controller.params,t=e.isNewOrEditPage,r=e.querySnippetId;t&&("new"===r?ae.isCreateQuerySnippetEnabled()?this.showSnippetDialog():bt("query_snippets",!0):Hv.get({id:r}).then(this.showSnippetDialog).catch(e=>{this.props.controller.handleError(e)}))}render(){var e=this.props.controller;return n.a.createElement("div",null,n.a.createElement("div",{className:"m-b-15"},n.a.createElement(h.a,{type:"primary",onClick:()=>this.showSnippetDialog(),disabled:!ae.isCreateQuerySnippetEnabled()},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New Query Snippet")),!e.isLoaded&&n.a.createElement(Ys,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement("div",{className:"text-center"},"There are no query snippets yet.",ae.isCreateQuerySnippetEnabled()&&n.a.createElement("div",{className:"m-t-5"},n.a.createElement(Ee,{type:"link",onClick:()=>this.showSnippetDialog()},"Click here")," ","to add one.")),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive query-snippets-table"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))}}Sj(Cj,"propTypes",{controller:Ss.isRequired});var Nj=xb("QuerySnippets.List",{permission:"create_query",title:"Query Snippets",path:"query_snippets",order:5},Ps(Cj,()=>new Bs({isPlainList:!0,getRequest:()=>({}),getResource:()=>Hv.query.bind(Hv)}),()=>new Hs({orderByField:"trigger",itemsPerPage:10})));function kj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kj(Object(r),!0).forEach((function(t){Aj(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kj(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Aj(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xj(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qj(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qj(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qj(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Tj(e){var t=e.onError,r=xj(Object(a.useState)({}),2),n=r[0],i=r[1],s=xj(Object(a.useState)({}),2),o=s[0],l=s[1],u=xj(Object(a.useState)(!0),2),d=u[0],m=u[1],p=xj(Object(a.useState)(!1),2),f=p[0],h=p[1],b=Dd(t);Object(a.useEffect)(()=>{vt("view","page","org_settings");var e=!1;return dn().then(t=>{if(!e){var r=Object(c.get)(t,"settings");i(r),l(_j({},r)),m(!1)}}).catch(t=>{e||b(t)}),()=>{e=!0}},[b]);var g=Object(a.useCallback)(e=>{l(t=>_j(_j({},t),e))},[]),y=Object(a.useCallback)(()=>{f||(h(!0),mn(o).then(e=>{var t,r=Object(c.get)(e,"settings");i(r),l(_j({},r)),t={dateFormat:o.date_format,timeFormat:o.time_format,dateTimeFormat:"".concat(o.date_format," ").concat(o.time_format)},Object(c.extend)($,t)}).catch(b).finally(()=>h(!1)))},[f,o,b]);return{settings:n,currentValues:o,isLoading:d,isSaving:f,handleSubmit:y,handleChange:g}}jn.register("QuerySnippets.List",Ga({path:"/query_snippets",title:"Query Snippets",render:e=>n.a.createElement(Nj,wj({},e,{currentPage:"query_snippets"}))})),jn.register("QuerySnippets.NewOrEdit",Ga({path:"/query_snippets/:querySnippetId",title:"Query Snippets",render:e=>n.a.createElement(Nj,wj({},e,{currentPage:"query_snippets",isNewOrEditPage:!0}))}));var Ij={settings:se.a.object,values:se.a.object,onChange:se.a.func,loading:se.a.bool},Dj={settings:{},values:{},onChange:()=>{},loading:!1};function Rj(){return(Rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Mj(e){var t=e.values,r=e.onChange,a=e.loading;return n.a.createElement(pe,Rj({name:"OrganizationSettings.FormatSettings"},e),n.a.createElement(Co.a.Item,{label:"Date Format"},a?n.a.createElement(Qn.a.Input,{style:{width:300},active:!0}):n.a.createElement(Xi.a,{value:t.date_format,onChange:e=>r({date_format:e}),"data-test":"DateFormatSelect"},$.dateFormatList.map(e=>n.a.createElement(Xi.a.Option,{key:e,"data-test":"DateFormatSelect:".concat(e)},e)))),n.a.createElement(Co.a.Item,{label:"Time Format"},a?n.a.createElement(Qn.a.Input,{style:{width:300},active:!0}):n.a.createElement(Xi.a,{value:t.time_format,onChange:e=>r({time_format:e}),"data-test":"TimeFormatSelect"},$.timeFormatList.map(e=>n.a.createElement(Xi.a.Option,{key:e},e)))))}function zj(){return(zj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Fj(e){var t=e.values,r=e.onChange,a=e.loading;return n.a.createElement(pe,zj({name:"OrganizationSettings.PlotlySettings"},e),n.a.createElement(Co.a.Item,{label:"Chart Visualization"},a?n.a.createElement(Qn.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement(ic.a,{name:"hide_plotly_mode_bar",checked:t.hide_plotly_mode_bar,onChange:e=>r({hide_plotly_mode_bar:e.target.checked})},"Hide Plotly mode bar")))}Mj.propTypes=Ij,Mj.defaultProps=Dj,Fj.propTypes=Ij,Fj.defaultProps=Dj;var Lj=r(208),Uj=r.n(Lj);function Vj(){return(Vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Bj(e){var t=e.values,r=e.onChange,a=e.loading;return n.a.createElement(pe,Vj({name:"OrganizationSettings.FeatureFlagsSettings"},e),n.a.createElement(Co.a.Item,{label:"Feature Flags"},a?n.a.createElement(n.a.Fragment,null,n.a.createElement(Uj.a,null,n.a.createElement(Qn.a,{title:!1,paragraph:{width:[300,300,300],rows:3},active:!0}))):n.a.createElement(n.a.Fragment,null,n.a.createElement(pe,Vj({name:"OrganizationSettings.FeatureFlagsSettings.PermissionsControl"},e),n.a.createElement(Uj.a,null,n.a.createElement(ic.a,{name:"feature_show_permissions_control",checked:t.feature_show_permissions_control,onChange:e=>r({feature_show_permissions_control:e.target.checked})},"Enable experimental multiple owners support"))),n.a.createElement(Uj.a,null,n.a.createElement(ic.a,{name:"send_email_on_failed_scheduled_queries",checked:t.send_email_on_failed_scheduled_queries,onChange:e=>r({send_email_on_failed_scheduled_queries:e.target.checked})},"Email query owners when scheduled queries fail")),n.a.createElement(Uj.a,null,n.a.createElement(ic.a,{name:"multi_byte_search_enabled",checked:t.multi_byte_search_enabled,onChange:e=>r({multi_byte_search_enabled:e.target.checked})},"Enable multi-byte (Chinese, Japanese, and Korean) search for query names and descriptions (slower)")))))}function Qj(){return(Qj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Wj(e){var t=e.values,r=e.onChange,a=e.loading;return n.a.createElement(pe,Qj({name:"OrganizationSettings.BeaconConsentSettings"},e),n.a.createElement(Co.a.Item,{label:n.a.createElement("span",null,"Anonymous Usage Data Sharing",n.a.createElement(Qe,{className:"m-l-5 m-r-5",type:"USAGE_DATA_SHARING"}))},a?n.a.createElement(Qn.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement(ic.a,{name:"beacon_consent",checked:t.beacon_consent,onChange:e=>r({beacon_consent:e.target.checked})},"Help Redash improve by automatically sending anonymous usage data")))}function Hj(){return(Hj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Gj(e){return n.a.createElement(pe,Hj({name:"OrganizationSettings.GeneralSettings"},e),n.a.createElement("h3",{className:"m-t-0"},"General"),n.a.createElement("hr",null),n.a.createElement(Mj,e),n.a.createElement(Fj,e),n.a.createElement(Bj,e),n.a.createElement(Wj,e))}function Kj(){return(Kj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Yj(e){var t=e.settings,r=e.values,a=e.onChange,i=e.loading,s=!$.googleLoginEnabled&&!$.ldapLoginEnabled&&!r.auth_saml_enabled;return n.a.createElement(pe,Kj({name:"OrganizationSettings.PasswordLoginSettings"},e),!i&&!t.auth_password_login_enabled&&n.a.createElement(p.a,{message:"Password based login is currently disabled and users will be able to login only with the enabled SSO options.",type:"warning",className:"m-t-15 m-b-15"}),n.a.createElement(Co.a.Item,{label:"Password Login"},i?n.a.createElement(Qn.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement(ic.a,{checked:r.auth_password_login_enabled,disabled:s,onChange:e=>a({auth_password_login_enabled:e.target.checked})},n.a.createElement(Ne,{title:s?"Password login can be disabled only if another login method is enabled.":null,placement:"right"},"Password Login Enabled"))))}function $j(){return($j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Jj(e){var t=e.values,r=e.onChange;return $.googleLoginEnabled?n.a.createElement(pe,$j({name:"OrganizationSettings.GoogleLoginSettings"},e),n.a.createElement("h4",null,"Google Login"),n.a.createElement(Co.a.Item,{label:"Allowed Google Apps Domains"},n.a.createElement(Xi.a,{mode:"tags",value:t.auth_google_apps_domains,onChange:e=>r({auth_google_apps_domains:e})}),!Object(c.isEmpty)(t.auth_google_apps_domains)&&n.a.createElement(p.a,{message:n.a.createElement("p",null,"Any user registered with a ",n.a.createElement("strong",null,Object(c.join)(t.auth_google_apps_domains,", "))," Google Apps account will be able to login. If they don't have an existing user, a new user will be created and join the ",n.a.createElement("strong",null,"Default")," group."),className:"m-t-15"}))):null}function Xj(){return(Xj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Zj(e){var t=e.values,r=e.onChange,a=e.loading;return n.a.createElement(pe,Xj({name:"OrganizationSettings.SAMLSettings"},e),n.a.createElement("h4",null,"SAML"),n.a.createElement(Co.a.Item,{label:"SAML Enabled"},a?n.a.createElement(Qn.a,{title:{width:300},paragraph:!1,active:!0}):n.a.createElement(im.a.Group,{onChange:e=>{var t={auth_saml_enabled:!!e.target.value};e.target.value&&(t.auth_saml_type=e.target.value),r(t)},value:t.auth_saml_enabled&&(t.auth_saml_type||"dynamic")},n.a.createElement(im.a,{value:!1},"Disabled"),n.a.createElement(im.a,{value:"static"},"Enabled (Static)"),n.a.createElement(im.a,{value:"dynamic"},"Enabled (Dynamic)"))),t.auth_saml_enabled&&n.a.createElement(n.a.Fragment,null,"static"===t.auth_saml_type&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Co.a.Item,{label:"SAML Single Sign-on URL"},n.a.createElement(He.a,{value:t.auth_saml_sso_url,onChange:e=>r({auth_saml_sso_url:e.target.value})})),n.a.createElement(Co.a.Item,{label:"SAML Entity ID"},n.a.createElement(He.a,{value:t.auth_saml_entity_id,onChange:e=>r({auth_saml_entity_id:e.target.value})})),n.a.createElement(Co.a.Item,{label:"SAML x509 cert"},n.a.createElement(He.a,{value:t.auth_saml_x509_cert,onChange:e=>r({auth_saml_x509_cert:e.target.value})}))),"dynamic"===t.auth_saml_type&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Co.a.Item,{label:"SAML Metadata URL"},n.a.createElement(He.a,{value:t.auth_saml_metadata_url,onChange:e=>r({auth_saml_metadata_url:e.target.value})})),n.a.createElement(Co.a.Item,{label:"SAML Entity ID"},n.a.createElement(He.a,{value:t.auth_saml_entity_id,onChange:e=>r({auth_saml_entity_id:e.target.value})})),n.a.createElement(Co.a.Item,{label:"SAML NameID Format"},n.a.createElement(He.a,{value:t.auth_saml_nameid_format,onChange:e=>r({auth_saml_nameid_format:e.target.value})})))))}function ew(){return(ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function rw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tw(Object(r),!0).forEach((function(t){aw(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function aw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nw(e){var t=e.values,r=e.onChange,i=Object(a.useCallback)(e=>{var a=rw(rw({},t),e);!$.googleLoginEnabled&&!$.ldapLoginEnabled&&!a.auth_saml_enabled&&(e=rw(rw({},e),{},{auth_password_login_enabled:!0})),r(e)},[t,r]);return n.a.createElement(pe,ew({name:"OrganizationSettings.AuthSettings"},e),n.a.createElement("h3",{className:"m-t-0"},"Authentication ",n.a.createElement(Qe,{type:"AUTHENTICATION_OPTIONS"})),n.a.createElement("hr",null),n.a.createElement(Yj,ew({},e,{onChange:i})),n.a.createElement(Jj,ew({},e,{onChange:i})),n.a.createElement(Zj,ew({},e,{onChange:i})))}function iw(){return(iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function sw(e){var t=Tj(e.onError),r=t.settings,a=t.currentValues,i=t.isLoading,s=t.isSaving,o=t.handleSubmit,l=t.handleChange;return n.a.createElement("div",{className:"row","data-test":"OrganizationSettings"},n.a.createElement("div",{className:"m-r-20 m-l-20"},n.a.createElement(Co.a,iw({},{labelCol:{xs:{span:24},sm:{span:6},lg:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12},lg:{span:10}},layout:"horizontal",className:"ant-form-horizontal--labels-left"},{onFinish:o}),n.a.createElement(Gj,{loading:i,settings:r,values:a,onChange:l}),n.a.createElement(nw,{loading:i,settings:r,values:a,onChange:l}),n.a.createElement(Co.a.Item,{wrapperCol:{xs:{span:24},sm:{span:12,offset:6},lg:{span:12,offset:4}}},i?n.a.createElement(Qn.a.Button,{active:!0}):n.a.createElement(h.a,{type:"primary",htmlType:"submit",loading:s,"data-test":"OrganizationSettingsSaveButton"},"Save")))))}Bj.propTypes=Ij,Bj.defaultProps=Dj,Wj.propTypes=Ij,Wj.defaultProps=Dj,Yj.propTypes=Ij,Yj.defaultProps=Dj,Jj.propTypes=Ij,Jj.defaultProps=Dj,Zj.propTypes=Ij,Zj.defaultProps=Dj,nw.propTypes=Ij,nw.defaultProps=Dj,sw.propTypes={onError:se.a.func},sw.defaultProps={onError:()=>{}};var ow=xb("Settings.Organization",{permission:"admin",title:"General",path:"settings/general",order:6},sw);function lw(e){var t=new URL(e,window.location);return t.protocol=window.location.protocol,t.host=window.location.host,t.toString()}function cw(){return(cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function uw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}jn.register("Settings.Organization",Ga({path:"/settings/general",title:"General Settings",render:e=>n.a.createElement(ow,e)}));var mw=[{required:!0,name:"name",title:"Name",type:"text",autoFocus:!0},{required:!0,name:"email",title:"Email",type:"email"}];function pw(e){var t=e.dialog,r=uw(Object(a.useState)(null),2),i=r[0],s=r[1];Object(a.useEffect)(()=>{vt("view","page","users/new")},[]);var o=Object(a.useCallback)(e=>t.close(e).catch(s),[t]),l=qe("userForm");return n.a.createElement(V.a,cw({},t.props,{title:"Create a New User",footer:[n.a.createElement(h.a,cw({key:"cancel"},t.props.cancelButtonProps,{onClick:t.dismiss}),"Cancel"),n.a.createElement(h.a,cw({key:"submit"},t.props.okButtonProps,{htmlType:"submit",type:"primary",form:l,"data-test":"SaveUserButton"}),"Create")],wrapProps:{"data-test":"CreateUserDialog"}}),n.a.createElement(Eb,{id:l,fields:mw,onSubmit:o,hideSubmitButton:!0}),i&&n.a.createElement(p.a,{message:i.message,type:"error",showIcon:!0,"data-test":"CreateUserErrorAlert"}))}pw.propTypes={dialog:Je.isRequired};var fw=Xe(pw);function hw(){return(hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function bw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gw(e){var t=e.user,r=e.enableUser,a=e.disableUser,i=e.deleteUser;return t.id===Y.id?null:t.is_invitation_pending?n.a.createElement(h.a,{type:"danger",className:"w-100",onClick:e=>i(e,t)},"Delete"):t.is_disabled?n.a.createElement(h.a,{type:"primary",className:"w-100",onClick:e=>r(e,t)},"Enable"):n.a.createElement(h.a,{className:"w-100",onClick:e=>a(e,t)},"Disable")}gw.propTypes={user:se.a.shape({id:se.a.number,is_invitation_pending:se.a.bool,is_disabled:se.a.bool}).isRequired,enableUser:se.a.func.isRequired,disableUser:se.a.func.isRequired,deleteUser:se.a.func.isRequired};class yw extends n.a.Component{constructor(){super(...arguments),bw(this,"sidebarMenu",[{key:"active",href:"users",title:"Active Users"},{key:"pending",href:"users/pending",title:"Pending Invitations"},{key:"disabled",href:"users/disabled",title:"Disabled Users",isAvailable:()=>ae.canCreateUser()}]),bw(this,"listColumns",[Ci.custom.sortable((e,t)=>n.a.createElement(zp,{user:t,withLink:!0}),{title:"Name",field:"name",width:null}),Ci.custom.sortable((e,t)=>Object(c.map)(t.groups,e=>n.a.createElement(S,{key:"group"+e.id,className:"label label-tag",href:"groups/"+e.id},e.name)),{title:"Groups",field:"groups"}),Ci.timeAgo.sortable({title:"Joined",field:"created_at",className:"text-nowrap",width:"1%"}),Ci.timeAgo.sortable({title:"Last Active At",field:"active_at",className:"text-nowrap",width:"1%"}),Ci.custom((e,t)=>n.a.createElement(gw,{user:t,enableUser:this.enableUser,disableUser:this.disableUser,deleteUser:this.deleteUser}),{width:"1%",isAvailable:()=>ae.canCreateUser()})]),bw(this,"createUser",e=>Wp.create(e).then(e=>{un.success("Saved."),e.invite_link&&V.a.warning({title:"Email not sent!",content:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"The mail server is not configured, please send the following link to ",n.a.createElement("b",null,e.name),":"),n.a.createElement(nf,{value:lw(e.invite_link),"aria-label":"Invite link",readOnly:!0}))})}).catch(e=>{var t=Object(c.find)([Object(c.get)(e,"response.data.message"),Object(c.get)(e,"message"),"Failed saving."],c.isString);return Promise.reject(new Error(t))})),bw(this,"showCreateUserDialog",()=>{if(ae.isCreateUserEnabled()){var e=()=>{this.props.controller.params.isNewUserPage&&bt("users")};fw.showModal().onClose(t=>this.createUser(t).then(()=>{this.props.controller.update(),e()})).onDismiss(e)}}),bw(this,"enableUser",(e,t)=>Wp.enableUser(t).then(()=>this.props.controller.update())),bw(this,"disableUser",(e,t)=>Wp.disableUser(t).then(()=>this.props.controller.update())),bw(this,"deleteUser",(e,t)=>Wp.deleteUser(t).then(()=>this.props.controller.update()))}componentDidMount(){this.props.controller.params.isNewUserPage&&this.showCreateUserDialog()}renderPageHeader(){return ae.canCreateUser()?n.a.createElement("div",{className:"m-b-15"},n.a.createElement(h.a,{type:"primary",disabled:!ae.isCreateUserEnabled(),onClick:this.showCreateUserDialog},n.a.createElement("i",{className:"fa fa-plus m-r-5","aria-hidden":"true"}),"New User"),n.a.createElement(pe,{name:"UsersListExtra"})):null}render(){var e=this.props.controller;return n.a.createElement(n.a.Fragment,null,this.renderPageHeader(),n.a.createElement(vc,null,n.a.createElement(vc.Sidebar,{className:"m-b-0"},n.a.createElement(Zl,{value:e.searchTerm,onChange:e.updateSearch,label:"Search users"}),n.a.createElement(ec,{items:this.sidebarMenu,selected:e.params.currentPage})),n.a.createElement(vc.Content,null,!e.isLoaded&&n.a.createElement(Ys,{className:""}),e.isLoaded&&e.isEmpty&&n.a.createElement(fh,{className:""}),e.isLoaded&&!e.isEmpty&&n.a.createElement("div",{className:"table-responsive","data-test":"UserList"},n.a.createElement(Ni,{items:e.pageItems,columns:this.listColumns,context:this.actions,orderByField:e.orderByField,orderByReverse:e.orderByReverse,toggleSorting:e.toggleSorting}),n.a.createElement($i,{showPageSizeSelect:!0,totalCount:e.totalItemsCount,pageSize:e.itemsPerPage,onPageSizeChange:t=>e.updatePagination({itemsPerPage:t}),page:e.page,onChange:t=>e.updatePagination({page:t})})))))}}bw(yw,"propTypes",{controller:Ss.isRequired});var vw=xb("Users.List",{permission:"list_users",title:"Users",path:"users",isActive:e=>e.startsWith("/users")&&"/users/me"!==e,order:2},Ps(yw,()=>new Bs({getRequest(e,t){switch(t.params.currentPage){case"active":e.pending=!1;break;case"pending":e.pending=!0;break;case"disabled":e.disabled=!0}return e},getResource:()=>Wp.query.bind(Wp)}),()=>new Gs({orderByField:"created_at",orderByReverse:!0})));jn.register("Users.New",Ga({path:"/users/new",title:"Users",render:e=>n.a.createElement(vw,hw({},e,{currentPage:"active",isNewUserPage:!0}))})),jn.register("Users.List",Ga({path:"/users",title:"Users",render:e=>n.a.createElement(vw,hw({},e,{currentPage:"active"}))})),jn.register("Users.Pending",Ga({path:"/users/pending",title:"Pending Invitations",render:e=>n.a.createElement(vw,hw({},e,{currentPage:"pending"}))})),jn.register("Users.Disabled",Ga({path:"/users/disabled",title:"Disabled Users",render:e=>n.a.createElement(vw,hw({},e,{currentPage:"disabled"}))}));var Ow=["groups","linkGroups"];function Ew(){return(Ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function jw(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ww(e){var t=e.groups,r=e.linkGroups,a=jw(e,Ow);return n.a.createElement("div",Ew({className:"user-groups"},a),Object(c.map)(t,e=>n.a.createElement(am.a,{key:e.id},r?n.a.createElement(S,{href:"groups/".concat(e.id)},e.name):e.name)))}function Sw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Cw(e){var t=Sw(Object(a.useState)([]),2),r=t[0],n=t[1],i=Sw(Object(a.useState)(!0),2),s=i[0],o=i[1],l=Object(a.useMemo)(()=>Object(c.filter)(r,t=>Object(c.includes)(e.groupIds,t.id)),[r,e]);return Object(a.useEffect)(()=>{tg.query().then(e=>{n(Object(c.isArray)(e)?e:[]),o(!1)})},[]),Object(a.useMemo)(()=>({groups:l,allGroups:r,isLoading:s}),[l,r,s])}function Nw(){return(Nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function kw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kw(Object(r),!0).forEach((function(t){Aw(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kw(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Aw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xw(e){var t=e.user,r=e.onChange,i=Cw(t),s=i.groups,o=i.allGroups,l=i.isLoading,u=Dd(r),d=Object(a.useCallback)((e,r,a)=>{var n=_w(_w({},e),{},{id:t.id});Wp.save(n).then(e=>{r("Saved."),u(Wp.convertUserInfo(e))}).catch(e=>{a(Object(c.get)(e,"response.data.message","Failed saving."))})},[t,u]),m=Object(a.useMemo)(()=>Object(c.map)([{name:"name",title:"Name",type:"text",initialValue:t.name},{name:"email",title:"Email",type:"email",initialValue:t.email},t.isDisabled||Y.id===t.id?{name:"group_ids",title:"Groups",type:"content",required:!1,content:l?"Loading...":n.a.createElement(ww,{"data-test":"Groups",groups:s})}:{name:"group_ids",title:"Groups",type:"select",mode:"multiple",options:Object(c.map)(o,e=>({name:e.name,value:e.id})),initialValue:t.groupIds,loading:l,placeholder:l?"Loading...":""}],e=>_w({readOnly:t.isDisabled,required:!0},e)),[t,s,o,l]);return n.a.createElement(pe,Nw({name:"UserProfile.UserInfoForm"},e),n.a.createElement(Eb,{fields:m,onSubmit:d,hideSubmitButton:t.isDisabled}))}function qw(){return(qw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Iw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tw(Object(r),!0).forEach((function(t){Dw(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tw(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Dw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Mw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function zw(e){var t=e.user,r=e.onChange,i=Rw(Object(a.useState)(!1),2),s=i[0],o=i[1],l=Dd(r),c=qe("apiKey"),u=Object(a.useCallback)(()=>{V.a.confirm({title:"Regenerate API Key",content:"Are you sure you want to regenerate?",okText:"Regenerate",onOk:()=>{o(!0),Wp.regenerateApiKey(t).then(e=>{e&&l(Iw(Iw({},t),{},{apiKey:e}))}).finally(()=>{o(!1)})},maskClosable:!0,autoFocusButton:null})},[t,l]);return n.a.createElement(pe,qw({name:"UserProfile.ApiKeyForm"},e),n.a.createElement(Co.a,{layout:"vertical"},n.a.createElement("hr",null),n.a.createElement(Co.a.Item,{label:"API Key",className:"m-b-10"},n.a.createElement(nf,{id:c,className:"hide-in-percy",value:t.apiKey,"data-test":"ApiKey",readOnly:!0})),n.a.createElement(h.a,{className:"w-100",onClick:u,loading:s,"data-test":"RegenerateApiKey"},"Regenerate")))}function Fw(){return(Fw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Lw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lw(Object(r),!0).forEach((function(t){Vw(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lw(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ww.propTypes={groups:se.a.arrayOf(se.a.shape({id:se.a.oneOfType([se.a.number,se.a.string]).isRequired,name:se.a.string})),linkGroups:se.a.bool},ww.defaultProps={groups:[],linkGroups:!0},xw.propTypes={user:$n.isRequired,onChange:se.a.func},xw.defaultProps={onChange:()=>{}},zw.propTypes={user:$n.isRequired,onChange:se.a.func},zw.defaultProps={onChange:()=>{}};class Bw extends n.a.Component{constructor(e){super(e),Vw(this,"fieldError",(e,t)=>0===t.length?"This field is required.":"currentPassword"!==e&&t.length<6?"This field is too short.":"repeatPassword"===e&&t!==this.state.newPassword.value?"Passwords don't match":null),Vw(this,"validateFields",e=>{var t=this.state,r=t.currentPassword,a=t.newPassword,n=t.repeatPassword,i={currentPassword:this.fieldError("currentPassword",r.value),newPassword:this.fieldError("newPassword",a.value),repeatPassword:this.fieldError("repeatPassword",n.value)};this.setState({currentPassword:Uw(Uw({},r),{},{error:i.currentPassword}),newPassword:Uw(Uw({},a),{},{error:i.newPassword}),repeatPassword:Uw(Uw({},n),{},{error:i.repeatPassword})}),Object(c.isFunction)(e)&&e(i.currentPassword||i.newPassword||i.repeatPassword?i:null)}),Vw(this,"updatePassword",()=>{var e=this.state,t=e.currentPassword,r=e.newPassword;e.updatingPassword||this.validateFields(e=>{if(e)this.setState(e=>({currentPassword:Uw(Uw({},e.currentPassword),{},{touched:!0}),newPassword:Uw(Uw({},e.newPassword),{},{touched:!0}),repeatPassword:Uw(Uw({},e.repeatPassword),{},{touched:!0})}));else{var a={id:this.props.user.id,old_password:t.value,password:r.value};this.setState({updatingPassword:!0}),Wp.save(a).then(()=>{un.success("Saved."),this.props.dialog.close({success:!0})}).catch(e=>{un.error(Object(c.get)(e,"response.data.message","Failed saving.")),this.setState({updatingPassword:!1})})}})}),Vw(this,"handleChange",e=>{var t=e.target,r=t.name,a=t.value,n=this.state[r].error;this.setState({[r]:{value:a,error:n,touched:!0}},()=>{this.validateFields()})}),this.state={currentPassword:{value:"",error:null,touched:!1},newPassword:{value:"",error:null,touched:!1},repeatPassword:{value:"",error:null,touched:!1},updatingPassword:!1}}render(){var e=this.props.dialog,t=this.state,r=t.currentPassword,a=t.newPassword,i=t.repeatPassword,s=t.updatingPassword,o={className:"m-b-10",required:!0},l={onChange:this.handleChange,onPressEnter:this.updatePassword};return n.a.createElement(V.a,Fw({},e.props,{okButtonProps:{loading:s},onOk:this.updatePassword,title:"Change Password"}),n.a.createElement(Co.a,{layout:"vertical"},n.a.createElement(Co.a.Item,Fw({},o,{validateStatus:r.touched&&r.error?"error":null,help:r.touched?r.error:null,label:"Current Password"}),n.a.createElement(He.a.Password,Fw({},l,{name:"currentPassword","data-test":"CurrentPassword",autoFocus:!0}))),n.a.createElement(Co.a.Item,Fw({},o,{validateStatus:a.touched&&a.error?"error":null,help:a.touched?a.error:null,label:"New Password"}),n.a.createElement(He.a.Password,Fw({},l,{name:"newPassword","data-test":"NewPassword"}))),n.a.createElement(Co.a.Item,Fw({},o,{validateStatus:i.touched&&i.error?"error":null,help:i.touched?i.error:null,label:"Repeat New Password"}),n.a.createElement(He.a.Password,Fw({},l,{name:"repeatPassword","data-test":"RepeatPassword"})))))}}Vw(Bw,"propTypes",{user:$n.isRequired,dialog:Je.isRequired});var Qw=Xe(Bw),Ww=["user","passwordLink"];function Hw(){return(Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function Gw(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Kw(e){var t=e.user,r=e.passwordLink,a=Gw(e,Ww);return Object(c.isString)(r)?n.a.createElement(pe,Hw({name:"UserProfile.PasswordLinkAlert"},e),n.a.createElement(p.a,Hw({message:"Email not sent!",description:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,"The mail server is not configured, please send the following link to ",n.a.createElement("b",null,t.name),":"),n.a.createElement(nf,{value:lw(r),"aria-label":"Password link",readOnly:!0})),type:"warning",className:"m-t-20",closable:!0},a))):null}function Yw(){return(Yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function $w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Jw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jw(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jw(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Xw(e){var t=e.user,r=$w(Object(a.useState)(!1),2),i=r[0],s=r[1],o=$w(Object(a.useState)(null),2),l=o[0],c=o[1],u=Object(a.useCallback)(()=>{s(!0),Wp.sendPasswordReset(t).then(e=>{c(e)}).finally(()=>{s(!1)})},[t]);return n.a.createElement(pe,Yw({name:"UserProfile.PasswordResetForm"},e),n.a.createElement(h.a,{className:"w-100 m-t-10",onClick:u,loading:i},"Send Password Reset Email"),n.a.createElement(Kw,{user:t,passwordLink:l,afterClose:()=>c(null)}))}function Zw(){return(Zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function eS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tS(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function rS(e){var t=e.user,r=eS(Object(a.useState)(!1),2),i=r[0],s=r[1],o=eS(Object(a.useState)(null),2),l=o[0],c=o[1],u=Object(a.useCallback)(()=>{s(!0),Wp.resendInvitation(t).then(e=>{c(e)}).finally(()=>{s(!1)})},[t]);return n.a.createElement(pe,Zw({name:"UserProfile.ResendInvitationForm"},e),n.a.createElement(h.a,{className:"w-100 m-t-10",onClick:u,loading:i},"Resend Invitation"),n.a.createElement(Kw,{user:t,passwordLink:l,afterClose:()=>c(null)}))}function aS(){return(aS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function nS(e){var t=e.user,r=Object(a.useCallback)(()=>{Qw.showModal({user:t})},[t]);return n.a.createElement(pe,aS({name:"UserProfile.PasswordForm"},e),n.a.createElement("h5",null,"Password"),t.id===Y.id&&n.a.createElement(h.a,{className:"w-100 m-t-10",onClick:r,"data-test":"ChangePassword"},"Change Password"),t.id!==Y.id&&Y.isAdmin&&n.a.createElement(n.a.Fragment,null,t.isInvitationPending?n.a.createElement(rS,{user:t}):n.a.createElement(Xw,{user:t})))}function iS(){return(iS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function sS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oS(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function lS(e){var t=e.user,r=e.onChange,i=sS(Object(a.useState)(!1),2),s=i[0],o=i[1],l=Dd(r),c=Object(a.useCallback)(()=>{var e=t.isDisabled?Wp.enableUser:Wp.disableUser;o(!0),e(t).then(e=>{e&&l(Wp.convertUserInfo(e))}).finally(()=>{o(!1)})},[t,l]);if(!Y.isAdmin||t.id===Y.id)return null;var u={type:t.isDisabled?"primary":"danger",children:t.isDisabled?"Enable User":"Disable User"};return n.a.createElement(pe,{name:"UserProfile.ToggleUserForm"},n.a.createElement(h.a,iS({className:"w-100 m-t-10",onClick:c,loading:s},u)))}function cS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return uS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uS(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function dS(e){var t=cS(Object(a.useState)(e.user),2),r=t[0],i=t[1];return Object(a.useEffect)(()=>{i(e.user)},[e.user]),n.a.createElement("div",{className:"col-md-4 col-md-offset-4"},n.a.createElement("img",{alt:"Profile",src:r.profileImageUrl,className:"profile__image",width:"40"}),n.a.createElement("h3",{className:"profile__h3"},r.name),n.a.createElement("hr",null),n.a.createElement(xw,{user:r,onChange:i}),!r.isDisabled&&n.a.createElement(n.a.Fragment,null,n.a.createElement(zw,{user:r,onChange:i}),n.a.createElement("hr",null),n.a.createElement(nS,{user:r})),n.a.createElement("hr",null),n.a.createElement(lS,{user:r,onChange:i}))}function mS(e){var t=e.user,r=Cw(t),a=r.groups,i=r.isLoading;return n.a.createElement("div",{className:"col-md-4 col-md-offset-4 profile__container"},n.a.createElement("img",{alt:"profile",src:t.profileImageUrl,className:"profile__image",width:"40"}),n.a.createElement("h3",{className:"profile__h3"},t.name),n.a.createElement("hr",null),n.a.createElement("dl",{className:"profile__dl"},n.a.createElement("dt",null,"Name:"),n.a.createElement("dd",null,t.name),n.a.createElement("dt",null,"Email:"),n.a.createElement("dd",null,t.email),n.a.createElement("dt",{className:"m-b-5"},"Groups:"),n.a.createElement("dd",null,i?"Loading...":n.a.createElement(ww,{groups:a}))))}function pS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fS(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fS(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function hS(e){var t=e.userId,r=e.onError,i=pS(Object(a.useState)(null),2),s=i[0],o=i[1],l=Dd(r);Object(a.useEffect)(()=>{var e=!1;return Wp.get({id:t||Y.id}).then(t=>{e||o(Wp.convertUserInfo(t))}).catch(t=>{e||l(t)}),()=>{e=!0}},[t,l]);var c=s&&(Y.isAdmin||Y.id===s.id);return n.a.createElement(n.a.Fragment,null,n.a.createElement(hl,{featureName:"invite emails",className:"m-b-20",adminOnly:!0}),n.a.createElement("div",{className:"row"},!s&&n.a.createElement(Ys,{className:""}),s&&n.a.createElement(pe,{name:"UserProfile",user:s},!c&&n.a.createElement(mS,{user:s}),c&&n.a.createElement(dS,{user:s}))))}Kw.propTypes={user:$n.isRequired,passwordLink:se.a.string},Kw.defaultProps={passwordLink:null},Xw.propTypes={user:$n.isRequired},rS.propTypes={user:$n.isRequired},nS.propTypes={user:$n.isRequired},lS.propTypes={user:$n.isRequired,onChange:se.a.func},lS.defaultProps={onChange:()=>{}},dS.propTypes={user:$n.isRequired},mS.propTypes={user:$n.isRequired},hS.propTypes={userId:se.a.string,onError:se.a.func},hS.defaultProps={userId:null,onError:()=>{}};var bS,gS,yS=xb("Users.Account",{title:"Account",path:"users/me",order:7},hS);function vS(e){for(var t=e.target;t&&"A"!==t.tagName;)t=t.parentNode;if(t&&t.hasAttribute("href")&&!t.hasAttribute("download")&&!t.dataset.skipRouter&&!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var r=t.getAttribute("target");Object(c.isString)(r)&&"_blank"===r.toLowerCase()||(e.preventDefault(),bt(t.href))}}function OS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ES(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ES(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ES(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}jn.register("Users.Account",Ga({path:"/users/me",title:"Account",render:e=>n.a.createElement(yS,e)})),jn.register("Users.ViewOrEdit",Ga({path:"/users/:userId",title:"Users",render:e=>n.a.createElement(yS,e)})),Ln.a.setDefaultIndicator(n.a.createElement("span",{role:"status","aria-live":"polite","aria-relevant":"additions removals"},n.a.createElement("i",{className:"fa fa-spinner fa-pulse","aria-hidden":"true"}),n.a.createElement("span",{className:"sr-only"},"Loading..."))),l.a.updateLocale("en",{relativeTime:{future:"%s",past:"%s",s:"just now",m:"a minute ago",mm:"%d minutes ago",h:"an hour ago",hh:"%d hours ago",d:"a day ago",dd:"%d days ago",M:"a month ago",MM:"%d months ago",y:"a year ago",yy:"%d years ago"}}),(bS=r(1680)).keys().forEach(bS),(gS=r(1782)).keys().map(gS).map(e=>e.default).filter(c.isFunction).filter(e=>e.init).map(e=>e());var jS={init(){window.addEventListener("offline",()=>{var e;un.warning("Please check your Internet connection.",null,{key:"connectionNotification",duration:null}),e="connectionNotification",window.addEventListener("online",(function t(){un.close(e),window.removeEventListener("online",t)}))})}};s.a.render(n.a.createElement((function(){var e=OS(Object(a.useState)(null),2),t=e[0],r=e[1],i=OS(Object(a.useState)(null),2),s=i[0],o=i[1];return Object(a.useEffect)(()=>{t&&t.title&&(document.title=t.title)},[t]),Object(a.useEffect)(()=>{function e(e){e.preventDefault(),"Uncaught SyntaxError: Unexpected token '<'"===e.message&&console.error("[Uncaught SyntaxError: Unexpected token '<'] usually means that a fallback html file was returned from server rather than the expected script. Check that the server is properly serving the file ".concat(e.filename,".")),o(e.error)}return document.body.addEventListener("click",vS,!1),window.addEventListener("error",e,!1),()=>{document.body.removeEventListener("click",vS,!1),window.removeEventListener("error",e,!1)}},[]),s?n.a.createElement(ot,{error:s}):n.a.createElement(ht,{routes:jn.items,onRouteChange:r})}),null),document.getElementById("application-root"),()=>{jS.init()})},440:function(e){e.exports=JSON.parse('"dev"')},460:function(e,t,r){"use strict";r.r(t),t.default=r.p+"images/avatar.svg"},720:function(e,t,r){r(1787),r(1783),e.exports=r(1784)},732:function(e,t,r){var a={"./en-au":452,"./en-au.js":452,"./en-ca":453,"./en-ca.js":453,"./en-gb":454,"./en-gb.js":454,"./en-ie":455,"./en-ie.js":455,"./en-il":456,"./en-il.js":456,"./en-in":457,"./en-in.js":457,"./en-nz":458,"./en-nz.js":458,"./en-sg":459,"./en-sg.js":459};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id=732}});
//# sourceMappingURL=app.378d004248148d294025.js.map